ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"foc.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.Measure_R_20Khz_Handler,"ax",%progbits
  18              		.align	1
  19              		.arch armv7e-m
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	Measure_R_20Khz_Handler:
  26              	.LFB184:
  27              		.file 1 "Src/foc.c"
   1:Src/foc.c     **** #include "foc.h"
   2:Src/foc.c     **** #include "tim.h"
   3:Src/foc.c     **** #include "math.h"
   4:Src/foc.c     **** #include "arm_math.h"
   5:Src/foc.c     **** #include "adc.h"
   6:Src/foc.c     **** #include "as5047.h"
   7:Src/foc.c     **** #include "uart_ext.h"
   8:Src/foc.c     **** 
   9:Src/foc.c     **** static void SVPWM(float Target_U, float duty);
  10:Src/foc.c     **** static void Test_Direction();
  11:Src/foc.c     **** static void Measure_R_MS_Handler(float duty);
  12:Src/foc.c     **** static void Measure_R_20Khz_Handler();
  13:Src/foc.c     **** 
  14:Src/foc.c     **** #define MIN(a, b) a < b ? a : b
  15:Src/foc.c     **** 
  16:Src/foc.c     **** uint16_t ADC_Values_Raw[4];
  17:Src/foc.c     **** uint16_t ADC_Values_Raw2[4];
  18:Src/foc.c     **** float Ialpha, Ibeta;
  19:Src/foc.c     **** //#define PI  3.1415926f
  20:Src/foc.c     **** typedef struct
  21:Src/foc.c     **** {
  22:Src/foc.c     ****     uint8_t a;
  23:Src/foc.c     ****     uint8_t b;
  24:Src/foc.c     ****     uint8_t c;
  25:Src/foc.c     ****     float theta;
  26:Src/foc.c     ****     float x;
  27:Src/foc.c     ****     float y;
  28:Src/foc.c     **** } Uvect_Mos;
  29:Src/foc.c     **** 
  30:Src/foc.c     **** typedef struct
  31:Src/foc.c     **** {
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 2


  32:Src/foc.c     ****     float ccra;
  33:Src/foc.c     ****     float ccrb;
  34:Src/foc.c     ****     float ccrc;
  35:Src/foc.c     **** } CCR_Duty;
  36:Src/foc.c     **** 
  37:Src/foc.c     **** typedef struct
  38:Src/foc.c     **** {
  39:Src/foc.c     ****     uint8_t pairs;
  40:Src/foc.c     ****     float R;
  41:Src/foc.c     ****     float L;
  42:Src/foc.c     ****     int8_t direction;
  43:Src/foc.c     ****     // ÁîµÊú∫ÁöÑËøêËΩ¨ÊñπÂêëÔºåÁ∫¶ÂÆöÂú®ÂºÄÁéØÊ®°Âºè‰∏ãÔºåÁîµÊú∫Êåâu4->u6ÊñπÂêëËøêË°åÔºàÁîµËßíÂ∫¶Â¢
  44:Src/foc.c     ****     // Ê≠§ÂèÇÊï∞‰∏éÁîµÊú∫ a b c ‰∏âÁõ∏ÁöÑÁÑäÊé•ÊúâÂÖ≥
  45:Src/foc.c     ****     // Ê≠§ÂèÇÊï∞‰ªÖÂú®ÊúâÊÑüÊ®°Âºè‰∏≠(SENSOR_FOC)ÊúâÁî®
  46:Src/foc.c     **** } Motor_Info;
  47:Src/foc.c     **** 
  48:Src/foc.c     **** enum
  49:Src/foc.c     **** {
  50:Src/foc.c     ****     STOP_MODE,
  51:Src/foc.c     ****     WAIT_MODE,
  52:Src/foc.c     ****     SENSOR_FOC,
  53:Src/foc.c     ****     SENSOR_LESS_FOC,
  54:Src/foc.c     ****     VF_OPENLOOP,
  55:Src/foc.c     ****     MEASURE_R,
  56:Src/foc.c     ****     MEASURE_L,
  57:Src/foc.c     ****     TEST_DIRECTION = 0xF1,
  58:Src/foc.c     ****     TEST_POSITION_OFFSET
  59:Src/foc.c     **** } Board_Mode;
  60:Src/foc.c     **** 
  61:Src/foc.c     **** struct
  62:Src/foc.c     **** {
  63:Src/foc.c     ****     uint32_t time; // unit:ms
  64:Src/foc.c     ****     float last_position;
  65:Src/foc.c     ****     int direction_result;
  66:Src/foc.c     **** } Test_Direction_Info;
  67:Src/foc.c     **** 
  68:Src/foc.c     **** Motor_Info Motor = {7, 0, 0};
  69:Src/foc.c     **** 
  70:Src/foc.c     **** Uvect_Mos U0 = {0, 0, 0, 0};
  71:Src/foc.c     **** Uvect_Mos U4 = {1, 0, 0, 0};
  72:Src/foc.c     **** Uvect_Mos U6 = {1, 1, 0, PI / 3};
  73:Src/foc.c     **** Uvect_Mos U2 = {0, 1, 0, PI / 3 * 2};
  74:Src/foc.c     **** Uvect_Mos U3 = {0, 1, 1, PI};
  75:Src/foc.c     **** Uvect_Mos U1 = {0, 0, 1, PI / 3 * 4};
  76:Src/foc.c     **** Uvect_Mos U5 = {1, 0, 1, PI / 3 * 5};
  77:Src/foc.c     **** Uvect_Mos U7 = {1, 1, 1, 0};
  78:Src/foc.c     **** 
  79:Src/foc.c     **** Uvect_Mos *Uvects[6] = {&U1, &U2, &U3, &U4, &U5, &U6};
  80:Src/foc.c     **** 
  81:Src/foc.c     **** static float theta = 0;
  82:Src/foc.c     **** float RPS = 6; // ËΩ¨ÈÄü
  83:Src/foc.c     **** 
  84:Src/foc.c     **** float Position_Degree;
  85:Src/foc.c     **** 
  86:Src/foc.c     **** float Position_Offset = 215.793457f;
  87:Src/foc.c     **** //float Position_Offset=273.164062f;
  88:Src/foc.c     **** 
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 3


  89:Src/foc.c     **** #define TIM7_FREQ 1000
  90:Src/foc.c     **** #define TIM8_FREQ 20000
  91:Src/foc.c     **** 
  92:Src/foc.c     **** #define DRIVE
  93:Src/foc.c     **** 
  94:Src/foc.c     **** static void UVects_Init()
  95:Src/foc.c     **** {
  96:Src/foc.c     ****     for (int i = 0; i < 6; ++i)
  97:Src/foc.c     ****     {
  98:Src/foc.c     ****         float v_theta = Uvects[i]->theta;
  99:Src/foc.c     ****         Uvects[i]->x = cosf(v_theta);
 100:Src/foc.c     ****         Uvects[i]->y = sinf(v_theta);
 101:Src/foc.c     ****     }
 102:Src/foc.c     **** }
 103:Src/foc.c     **** 
 104:Src/foc.c     **** void Foc_Init(float rps)
 105:Src/foc.c     **** {
 106:Src/foc.c     ****     // rps unit is r/s
 107:Src/foc.c     ****     Board_Mode = VF_OPENLOOP;
 108:Src/foc.c     ****     TIM8->ARR = 168000000 / TIM8_FREQ / 2;
 109:Src/foc.c     **** 
 110:Src/foc.c     ****     TIM8->CCR4 = TIM8->ARR - 2;
 111:Src/foc.c     **** 
 112:Src/foc.c     ****     UVects_Init();
 113:Src/foc.c     **** #ifdef DRIVE
 114:Src/foc.c     ****     HAL_TIM_PWM_Start(&htim8, TIM_CHANNEL_1);
 115:Src/foc.c     ****     HAL_TIM_PWM_Start(&htim8, TIM_CHANNEL_2);
 116:Src/foc.c     ****     HAL_TIM_PWM_Start(&htim8, TIM_CHANNEL_3);
 117:Src/foc.c     **** 
 118:Src/foc.c     ****     HAL_TIMEx_PWMN_Start(&htim8, TIM_CHANNEL_1);
 119:Src/foc.c     ****     HAL_TIMEx_PWMN_Start(&htim8, TIM_CHANNEL_2);
 120:Src/foc.c     ****     HAL_TIMEx_PWMN_Start(&htim8, TIM_CHANNEL_3);
 121:Src/foc.c     **** #endif
 122:Src/foc.c     ****     TIM7->PSC = 1;
 123:Src/foc.c     ****     TIM7->ARR = 42000000 / TIM7_FREQ - 1;
 124:Src/foc.c     **** 
 125:Src/foc.c     ****     HAL_TIM_Base_Start_IT(&htim7);
 126:Src/foc.c     **** 
 127:Src/foc.c     ****     HAL_TIM_Base_Start(&htim8);
 128:Src/foc.c     **** }
 129:Src/foc.c     **** 
 130:Src/foc.c     **** uint8_t get_area(uint32_t now_theta)
 131:Src/foc.c     **** {
 132:Src/foc.c     ****     return now_theta / 60 + 1;
 133:Src/foc.c     **** }
 134:Src/foc.c     **** 
 135:Src/foc.c     **** // Ê†πÊçÆÊâáÂå∫Âè∑ÔºåËé∑ÂèñËØ•ÊâáÂå∫ÁöÑ‰∏§‰∏™ÁîµÂéãÁü¢Èáè
 136:Src/foc.c     **** // area:1-6
 137:Src/foc.c     **** void get_area_u(uint8_t area, Uvect_Mos *u1, Uvect_Mos *u2)
 138:Src/foc.c     **** {
 139:Src/foc.c     ****     switch (area)
 140:Src/foc.c     ****     {
 141:Src/foc.c     ****     case 1:
 142:Src/foc.c     ****         *u1 = U4;
 143:Src/foc.c     ****         *u2 = U6;
 144:Src/foc.c     ****         break;
 145:Src/foc.c     ****     case 2:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 4


 146:Src/foc.c     ****         *u1 = U6;
 147:Src/foc.c     ****         *u2 = U2;
 148:Src/foc.c     ****         break;
 149:Src/foc.c     ****     case 3:
 150:Src/foc.c     ****         *u1 = U2;
 151:Src/foc.c     ****         *u2 = U3;
 152:Src/foc.c     ****         break;
 153:Src/foc.c     ****     case 4:
 154:Src/foc.c     ****         *u1 = U3;
 155:Src/foc.c     ****         *u2 = U1;
 156:Src/foc.c     ****         break;
 157:Src/foc.c     ****     case 5:
 158:Src/foc.c     ****         *u1 = U1;
 159:Src/foc.c     ****         *u2 = U5;
 160:Src/foc.c     ****         break;
 161:Src/foc.c     ****     case 6:
 162:Src/foc.c     ****         *u1 = U5;
 163:Src/foc.c     ****         *u2 = U4;
 164:Src/foc.c     ****         break;
 165:Src/foc.c     ****     default:
 166:Src/foc.c     ****         break;
 167:Src/foc.c     ****     }
 168:Src/foc.c     **** }
 169:Src/foc.c     **** 
 170:Src/foc.c     **** /*
 171:Src/foc.c     ****     Ê†πÊçÆthetaÊù•ËÆ°ÁÆóÁõ∏ÈÇª‰∏§‰∏™Áü¢ÈáèÁöÑ‰ΩúÁî®Êó∂Èó¥ÁöÑÂáΩÊï∞Ôºå
 172:Src/foc.c     ****     Âõ†‰∏∫Áî®Âà∞Èô§Ê≥ïÊ¨°Êï∞Â§ö‰∫Ü‰∏ÄÁÇπÔºåÁõÆÂâçÊöÇÊó∂Â∫üÂºÉ„ÄÇ
 173:Src/foc.c     **** */
 174:Src/foc.c     **** void get_t(float theta, float *t1, float *t2)
 175:Src/foc.c     **** {
 176:Src/foc.c     ****     /*
 177:Src/foc.c     **** /       u2y x               u2x y       \
 178:Src/foc.c     **** | ----------------- - ----------------- |
 179:Src/foc.c     **** | u1x u2y - u2x u1y   u1x u2y - u2x u1y |
 180:Src/foc.c     **** |                                       |
 181:Src/foc.c     **** |       u1x y               u1y x       |
 182:Src/foc.c     **** | ----------------- - ----------------- |
 183:Src/foc.c     **** \ u1x u2y - u2x u1y   u1x u2y - u2x u1y /
 184:Src/foc.c     **** */
 185:Src/foc.c     ****     float temp_t1, temp_t2;
 186:Src/foc.c     ****     float theta_f; // Âçï‰Ωç‰∏∫rad
 187:Src/foc.c     ****     Uvect_Mos u1, u2;
 188:Src/foc.c     ****     float x, y;
 189:Src/foc.c     ****     get_area_u(get_area(theta), &u1, &u2);
 190:Src/foc.c     ****     //theta_f=(float)theta*2.0f*PI/360;
 191:Src/foc.c     ****     arm_sin_cos_f32(theta, &y, &x);
 192:Src/foc.c     ****     x *= 0.86f;
 193:Src/foc.c     ****     y *= 0.86f; // sqrt(3)/2 Ê≤°Èîô
 194:Src/foc.c     ****     //x=0.86f*cosf(theta_f);
 195:Src/foc.c     ****     //y=0.86f*sinf(theta_f);
 196:Src/foc.c     ****     temp_t1 = u2.y * x / (u1.x * u2.y - u2.x * u1.y) - (u2.x * y) / (u1.x * u2.y - u2.x * u1.y);
 197:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 198:Src/foc.c     **** 
 199:Src/foc.c     ****     *t1 = temp_t1;
 200:Src/foc.c     ****     *t2 = temp_t2;
 201:Src/foc.c     **** }
 202:Src/foc.c     **** 
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 5


 203:Src/foc.c     **** CCR_Duty get_ccr_duty(float t1, float t2, Uvect_Mos u1, Uvect_Mos u2)
 204:Src/foc.c     **** {
 205:Src/foc.c     ****     float t0, t3;
 206:Src/foc.c     ****     CCR_Duty result;
 207:Src/foc.c     ****     t0 = (1 - t1 - t2) / 2;
 208:Src/foc.c     ****     t3 = t0;
 209:Src/foc.c     **** 
 210:Src/foc.c     ****     result.ccra = U7.a * t3 + u1.a * t1 + u2.a * t2;
 211:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 212:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 213:Src/foc.c     **** 
 214:Src/foc.c     ****     return result;
 215:Src/foc.c     **** }
 216:Src/foc.c     **** 
 217:Src/foc.c     **** void SVPWM_Step(CCR_Duty duty)
 218:Src/foc.c     **** {
 219:Src/foc.c     ****     TIM8->CCR1 = duty.ccrc * TIM8->ARR;
 220:Src/foc.c     ****     TIM8->CCR2 = duty.ccrb * TIM8->ARR;
 221:Src/foc.c     ****     TIM8->CCR3 = duty.ccra * TIM8->ARR;
 222:Src/foc.c     **** }
 223:Src/foc.c     **** 
 224:Src/foc.c     **** /*
 225:Src/foc.c     ****     Â∞ÜÁîµÂéãÁü¢ÈáèËÆæÁΩÆ‰∏∫U4ÔºåÂπ∂ÊåÅÁª≠‰∏ÄÊÆµÊó∂Èó¥
 226:Src/foc.c     **** */
 227:Src/foc.c     **** void Set_to_U4(uint8_t t)
 228:Src/foc.c     **** {
 229:Src/foc.c     ****     CCR_Duty temp_duty = {0};
 230:Src/foc.c     ****     temp_duty.ccra = U4.a;
 231:Src/foc.c     ****     temp_duty.ccrb = U4.b;
 232:Src/foc.c     ****     temp_duty.ccrc = U4.c;
 233:Src/foc.c     ****     SVPWM_Step(temp_duty);
 234:Src/foc.c     ****     HAL_Delay(t);
 235:Src/foc.c     ****     temp_duty.ccra = U0.a;
 236:Src/foc.c     ****     temp_duty.ccrb = U0.b;
 237:Src/foc.c     ****     temp_duty.ccrc = U0.c;
 238:Src/foc.c     ****     SVPWM_Step(temp_duty);
 239:Src/foc.c     ****     uprintf("position:%f \r\n", Position_Degree);
 240:Src/foc.c     **** }
 241:Src/foc.c     **** 
 242:Src/foc.c     **** extern uint8_t Init_OK;
 243:Src/foc.c     **** void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim)
 244:Src/foc.c     **** {
 245:Src/foc.c     **** 
 246:Src/foc.c     ****     if (htim->Instance == TIM7)
 247:Src/foc.c     ****     {
 248:Src/foc.c     ****         if (!Init_OK)
 249:Src/foc.c     ****         {
 250:Src/foc.c     ****             return;
 251:Src/foc.c     ****         }
 252:Src/foc.c     ****         Theta_Handler();
 253:Src/foc.c     ****     }
 254:Src/foc.c     ****     else if (htim->Instance == TIM8)
 255:Src/foc.c     ****     {
 256:Src/foc.c     ****     }
 257:Src/foc.c     **** }
 258:Src/foc.c     **** 
 259:Src/foc.c     **** void SVPWM_Normal_CalT1T2(float alpha, float beta, uint8_t area, float *t1, float *t2)
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 6


 260:Src/foc.c     **** {
 261:Src/foc.c     ****     float temp = 0;
 262:Src/foc.c     ****     switch (area)
 263:Src/foc.c     ****     {
 264:Src/foc.c     ****     case 1:
 265:Src/foc.c     ****         *t1 = alpha - 0.57735f * beta;
 266:Src/foc.c     ****         *t2 = 1.1547f * beta;
 267:Src/foc.c     ****         break;
 268:Src/foc.c     ****     case 2:
 269:Src/foc.c     ****         *t1 = alpha + 0.57735f * beta;
 270:Src/foc.c     ****         *t2 = 0.57735f * beta - alpha;
 271:Src/foc.c     ****         break;
 272:Src/foc.c     ****     case 3:
 273:Src/foc.c     ****         *t1 = 1.1547f * beta;
 274:Src/foc.c     ****         *t2 = -alpha - 0.57735f * beta;
 275:Src/foc.c     ****         break;
 276:Src/foc.c     ****     case 4:
 277:Src/foc.c     ****         *t1 = 0.57735f * beta - alpha;
 278:Src/foc.c     ****         *t2 = -1.1547f * beta;
 279:Src/foc.c     ****         break;
 280:Src/foc.c     ****     case 5:
 281:Src/foc.c     ****         temp = -0.57735f * beta;
 282:Src/foc.c     ****         *t1 = temp - alpha;
 283:Src/foc.c     ****         *t2 = temp + alpha;
 284:Src/foc.c     ****         break;
 285:Src/foc.c     ****     case 6:
 286:Src/foc.c     ****         *t1 = -1.1547f * beta;
 287:Src/foc.c     ****         *t2 = alpha + 0.57735f * beta;
 288:Src/foc.c     ****         break;
 289:Src/foc.c     ****     }
 290:Src/foc.c     **** }
 291:Src/foc.c     **** 
 292:Src/foc.c     **** void Theta_Handler()
 293:Src/foc.c     **** {
 294:Src/foc.c     **** 
 295:Src/foc.c     ****     Position_Degree = Get_Position_Rad_Dgree(1);
 296:Src/foc.c     ****     switch (Board_Mode)
 297:Src/foc.c     ****     {
 298:Src/foc.c     ****     case SENSOR_FOC:
 299:Src/foc.c     ****         Foc();
 300:Src/foc.c     ****         break;
 301:Src/foc.c     ****     case VF_OPENLOOP:
 302:Src/foc.c     ****         VF_Openloop_Control(1, 1000, 1, 1);
 303:Src/foc.c     ****         break;
 304:Src/foc.c     ****     case TEST_DIRECTION:
 305:Src/foc.c     ****         Test_Direction();
 306:Src/foc.c     ****         break;
 307:Src/foc.c     ****     case STOP_MODE:
 308:Src/foc.c     ****         SVPWM(0, 0);
 309:Src/foc.c     ****         break;
 310:Src/foc.c     ****     case WAIT_MODE:
 311:Src/foc.c     ****         //  nothing to do
 312:Src/foc.c     ****         break;
 313:Src/foc.c     ****     case MEASURE_R:
 314:Src/foc.c     ****         Measure_R_MS_Handler(1);
 315:Src/foc.c     ****         break;
 316:Src/foc.c     ****     default:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 7


 317:Src/foc.c     ****         break;
 318:Src/foc.c     ****     }
 319:Src/foc.c     **** }
 320:Src/foc.c     **** 
 321:Src/foc.c     **** #define ADC_RAW2_CURRENT(raw) raw * 3300.0f / 4096 / 200 / 0.003f
 322:Src/foc.c     **** 
 323:Src/foc.c     **** void Park_Conv(float ia, float ib, float *ialpha, float *ibeta)
 324:Src/foc.c     **** {
 325:Src/foc.c     ****     *ialpha = ia;
 326:Src/foc.c     ****     *ibeta = (sqrtf(3) * ib + sqrtf(3) * (ib + ia)) / 3.0f;
 327:Src/foc.c     **** }
 328:Src/foc.c     **** 
 329:Src/foc.c     **** void HAL_ADC_ConvCpltCallback(ADC_HandleTypeDef *hadc)
 330:Src/foc.c     **** {
 331:Src/foc.c     ****     float ia, ib;
 332:Src/foc.c     **** 
 333:Src/foc.c     ****     if (hadc->Instance == ADC1)
 334:Src/foc.c     ****     {
 335:Src/foc.c     ****     }
 336:Src/foc.c     ****     else if (hadc->Instance == ADC2)
 337:Src/foc.c     ****     {
 338:Src/foc.c     ****         if (Board_Mode == SENSOR_FOC)
 339:Src/foc.c     ****         {
 340:Src/foc.c     ****             ia = ADC_RAW2_CURRENT(ADC_Values_Raw2[0]);
 341:Src/foc.c     ****             ib = ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 342:Src/foc.c     ****             Park_Conv(ia, ib, &Ialpha, &Ibeta);
 343:Src/foc.c     ****         }
 344:Src/foc.c     ****         Measure_R_20Khz_Handler();
 345:Src/foc.c     ****     }
 346:Src/foc.c     **** }
 347:Src/foc.c     **** 
 348:Src/foc.c     **** void Foc()
 349:Src/foc.c     **** {
 350:Src/foc.c     ****     Uvect_Mos u1, u2;
 351:Src/foc.c     ****     float t1, t2;
 352:Src/foc.c     ****     float x, y;
 353:Src/foc.c     **** 
 354:Src/foc.c     ****     float electric_position = (-1 * Position_Degree + 360);
 355:Src/foc.c     ****     float electric_position_offset = (-1 * Position_Offset + 360);
 356:Src/foc.c     ****     //float electric_position=Position_Degree;
 357:Src/foc.c     ****     //float electric_position_offset=Position_Offset;
 358:Src/foc.c     ****     int32_t sub = (int32_t)(electric_position - electric_position_offset);
 359:Src/foc.c     **** 
 360:Src/foc.c     ****     if (sub < 0)
 361:Src/foc.c     ****     {
 362:Src/foc.c     ****         sub += 360;
 363:Src/foc.c     ****     }
 364:Src/foc.c     ****     sub *= Motor.pairs;
 365:Src/foc.c     ****     sub += 90;
 366:Src/foc.c     **** 
 367:Src/foc.c     ****     sub %= 360;
 368:Src/foc.c     **** 
 369:Src/foc.c     ****     SVPWM(sub, 1);
 370:Src/foc.c     **** }
 371:Src/foc.c     **** 
 372:Src/foc.c     **** // Target_U ÊúüÊúõÁîµÂéãÁü¢ÈáèÁöÑËßíÂ∫¶ Âçï‰Ωç¬∞ 0-360
 373:Src/foc.c     **** // duty ÊúüÊúõÂç†Á©∫ÊØî 0-1
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 8


 374:Src/foc.c     **** static void SVPWM(float Target_U, float duty)
 375:Src/foc.c     **** {
 376:Src/foc.c     ****     Uvect_Mos u1, u2;
 377:Src/foc.c     ****     float x, y;
 378:Src/foc.c     ****     float t1, t2;
 379:Src/foc.c     ****     static CCR_Duty CCR_Dutys = {0};
 380:Src/foc.c     **** 
 381:Src/foc.c     ****     uint8_t area = get_area(Target_U);
 382:Src/foc.c     ****     get_area_u(area, &u1, &u2);
 383:Src/foc.c     ****     arm_sin_cos_f32(Target_U, &y, &x);
 384:Src/foc.c     ****     x *= 0.86f * duty;
 385:Src/foc.c     ****     y *= 0.86f * duty; // sqrt(3)/2 Ê≤°Èîô
 386:Src/foc.c     ****     SVPWM_Normal_CalT1T2(x, y, area, &t1, &t2);
 387:Src/foc.c     ****     CCR_Dutys = get_ccr_duty(t1, t2, u1, u2);
 388:Src/foc.c     ****     SVPWM_Step(CCR_Dutys);
 389:Src/foc.c     **** }
 390:Src/foc.c     **** 
 391:Src/foc.c     **** void VF_Openloop_Control(float duty, float freq, int8_t direction, float rps)
 392:Src/foc.c     **** {
 393:Src/foc.c     ****     static float theta = 0;
 394:Src/foc.c     ****     float delta_p = rps * Motor.pairs * 360.0f / freq; // ÊØèÊ¨°Ë∞ÉÁî®Êú¨ÂáΩÊï∞Ë¶ÅÂ¢ûÂä†ÁöÑÂÄº
 395:Src/foc.c     **** 
 396:Src/foc.c     ****     theta += direction * delta_p;
 397:Src/foc.c     ****     if (theta > 360)
 398:Src/foc.c     ****     {
 399:Src/foc.c     ****         theta -= 360;
 400:Src/foc.c     ****     }
 401:Src/foc.c     ****     else if (theta < 0)
 402:Src/foc.c     ****     {
 403:Src/foc.c     ****         theta += 360;
 404:Src/foc.c     ****     }
 405:Src/foc.c     ****     SVPWM(theta, duty);
 406:Src/foc.c     **** }
 407:Src/foc.c     **** 
 408:Src/foc.c     **** static void Test_Direction()
 409:Src/foc.c     **** {
 410:Src/foc.c     ****     Test_Direction_Info.time += 1;
 411:Src/foc.c     **** 
 412:Src/foc.c     ****     if (Position_Degree > Test_Direction_Info.last_position)
 413:Src/foc.c     ****     {
 414:Src/foc.c     ****         Test_Direction_Info.direction_result += 1;
 415:Src/foc.c     ****     }
 416:Src/foc.c     ****     else
 417:Src/foc.c     ****     {
 418:Src/foc.c     ****         Test_Direction_Info.direction_result -= 1;
 419:Src/foc.c     ****     }
 420:Src/foc.c     ****     Test_Direction_Info.last_position = Position_Degree;
 421:Src/foc.c     **** 
 422:Src/foc.c     ****     VF_Openloop_Control(1, 1000, 1, 1);
 423:Src/foc.c     **** 
 424:Src/foc.c     ****     if (Test_Direction_Info.time > 10000)
 425:Src/foc.c     ****     { // run 10s
 426:Src/foc.c     ****         Board_Mode = STOP_MODE;
 427:Src/foc.c     ****         Test_Direction_Info.time = 0;
 428:Src/foc.c     ****         uprintf_polling("direction result:%d\r\n", Test_Direction_Info.direction_result);
 429:Src/foc.c     ****         if (Test_Direction_Info.direction_result > 0)
 430:Src/foc.c     ****         {
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 9


 431:Src/foc.c     ****             uprintf_polling("the direction of the motor is postive!\r\n");
 432:Src/foc.c     ****             Motor.direction = 1;
 433:Src/foc.c     ****         }
 434:Src/foc.c     ****         else
 435:Src/foc.c     ****         {
 436:Src/foc.c     ****             uprintf_polling("the direction of the motor is nagative!\r\n");
 437:Src/foc.c     ****             Motor.direction = -1;
 438:Src/foc.c     ****         }
 439:Src/foc.c     ****         Test_Direction_Info.direction_result = 0;
 440:Src/foc.c     ****     }
 441:Src/foc.c     **** }
 442:Src/foc.c     **** 
 443:Src/foc.c     **** struct
 444:Src/foc.c     **** {
 445:Src/foc.c     ****     uint32_t time; //unit:ms
 446:Src/foc.c     ****     Uvect_Mos *Used_Mos;
 447:Src/foc.c     ****     uint32_t cnt;
 448:Src/foc.c     ****     uint32_t USELESS_CNT;
 449:Src/foc.c     ****     uint32_t CNT_MAX;
 450:Src/foc.c     ****     float current_sum;
 451:Src/foc.c     **** } Measure_R_Info;
 452:Src/foc.c     **** 
 453:Src/foc.c     **** static void Measure_R_MS_Handler(float duty)
 454:Src/foc.c     **** {
 455:Src/foc.c     ****     CCR_Duty temp_duty = {0};
 456:Src/foc.c     ****     static float current1 = 0;
 457:Src/foc.c     ****     static float current2 = 0;
 458:Src/foc.c     ****     float cur_avg = 0;
 459:Src/foc.c     ****     if (Measure_R_Info.time == 0)
 460:Src/foc.c     ****     {
 461:Src/foc.c     ****         Measure_R_Info.Used_Mos = &U5;
 462:Src/foc.c     ****         Measure_R_Info.USELESS_CNT = 2;
 463:Src/foc.c     ****         Measure_R_Info.CNT_MAX = 30;
 464:Src/foc.c     **** 
 465:Src/foc.c     ****         temp_duty.ccra = Measure_R_Info.Used_Mos->a * duty; //011
 466:Src/foc.c     ****         temp_duty.ccrb = Measure_R_Info.Used_Mos->b * duty;
 467:Src/foc.c     ****         temp_duty.ccrc = Measure_R_Info.Used_Mos->c * duty;
 468:Src/foc.c     ****         SVPWM_Step(temp_duty);
 469:Src/foc.c     ****         Measure_R_Info.time = 1;
 470:Src/foc.c     **** 
 471:Src/foc.c     ****         return;
 472:Src/foc.c     ****     }
 473:Src/foc.c     **** 
 474:Src/foc.c     ****     Measure_R_Info.time += 1;
 475:Src/foc.c     **** 
 476:Src/foc.c     ****     // ËøôÈáåÁöÑÁîµÊµÅ‰ªÖÁî®‰∫éÊµãËØïÈááÊ†∑Áõ∏ÊòØÂê¶Ê≠£Á°Æ
 477:Src/foc.c     ****     current1 += ADC_RAW2_CURRENT(ADC_Values_Raw2[0]);
 478:Src/foc.c     ****     current2 += ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 479:Src/foc.c     **** 
 480:Src/foc.c     ****     if (Measure_R_Info.time >= 3)
 481:Src/foc.c     ****     {
 482:Src/foc.c     ****         uprintf_polling("duty:%f current1:%f  current2:%f\r\n", duty, current1, current2);
 483:Src/foc.c     ****         current1 = 0;
 484:Src/foc.c     ****         current2 = 0;
 485:Src/foc.c     ****         Board_Mode = STOP_MODE;
 486:Src/foc.c     ****         Measure_R_Info.time = 0;
 487:Src/foc.c     **** 
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 10


 488:Src/foc.c     ****         if (Measure_R_Info.cnt < Measure_R_Info.CNT_MAX)
 489:Src/foc.c     ****         {
 490:Src/foc.c     ****             uprintf_polling("error! no enough time! %d \r\n", Measure_R_Info.cnt);
 491:Src/foc.c     ****         }
 492:Src/foc.c     ****         else
 493:Src/foc.c     ****         {
 494:Src/foc.c     ****             cur_avg = Measure_R_Info.current_sum / (Measure_R_Info.CNT_MAX - Measure_R_Info.USELESS
 495:Src/foc.c     ****             uprintf_polling("current_avg:%f cnt:%d \r\n", cur_avg, Measure_R_Info.cnt);
 496:Src/foc.c     ****         }
 497:Src/foc.c     ****         Measure_R_Info.current_sum = 0;
 498:Src/foc.c     ****         Measure_R_Info.cnt = 0;
 499:Src/foc.c     ****     }
 500:Src/foc.c     **** }
 501:Src/foc.c     **** 
 502:Src/foc.c     **** static void Measure_R_20Khz_Handler()
 503:Src/foc.c     **** {
  28              		.loc 1 503 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
 504:Src/foc.c     ****     if (Board_Mode != MEASURE_R)
  33              		.loc 1 504 5 view .LVU1
  34              		.loc 1 504 20 is_stmt 0 view .LVU2
  35 0000 2B4B     		ldr	r3, .L6
  36 0002 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  37              		.loc 1 504 8 view .LVU3
  38 0004 052B     		cmp	r3, #5
  39 0006 15D1     		bne	.L1
 505:Src/foc.c     ****     {
 506:Src/foc.c     ****         return;
 507:Src/foc.c     ****     }
 508:Src/foc.c     **** 
 509:Src/foc.c     ****     if (Measure_R_Info.time < 1)
  40              		.loc 1 509 5 is_stmt 1 view .LVU4
  41              		.loc 1 509 23 is_stmt 0 view .LVU5
  42 0008 2A4B     		ldr	r3, .L6+4
  43 000a 1B68     		ldr	r3, [r3]
  44              		.loc 1 509 8 view .LVU6
  45 000c 93B1     		cbz	r3, .L1
 510:Src/foc.c     ****     {
 511:Src/foc.c     ****         return;
 512:Src/foc.c     ****     }
 513:Src/foc.c     ****     Measure_R_Info.cnt++;
  46              		.loc 1 513 5 is_stmt 1 view .LVU7
  47              		.loc 1 513 19 is_stmt 0 view .LVU8
  48 000e 294A     		ldr	r2, .L6+4
  49 0010 9368     		ldr	r3, [r2, #8]
  50              		.loc 1 513 23 view .LVU9
  51 0012 0133     		adds	r3, r3, #1
  52 0014 9360     		str	r3, [r2, #8]
 514:Src/foc.c     **** 
 515:Src/foc.c     ****     // eg:USELESS_CNT=5   CNT_MAX=30
 516:Src/foc.c     ****     // 5,6,7...30
 517:Src/foc.c     ****     // so times is CNT_MAX-USELESS_CNT+1
 518:Src/foc.c     ****     if (Measure_R_Info.cnt >= Measure_R_Info.USELESS_CNT && Measure_R_Info.cnt <= Measure_R_Info.CN
  53              		.loc 1 518 5 is_stmt 1 view .LVU10
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 11


  54              		.loc 1 518 45 is_stmt 0 view .LVU11
  55 0016 D268     		ldr	r2, [r2, #12]
  56              		.loc 1 518 8 view .LVU12
  57 0018 9342     		cmp	r3, r2
  58 001a 0BD3     		bcc	.L1
  59              		.loc 1 518 97 discriminator 1 view .LVU13
  60 001c 254A     		ldr	r2, .L6+4
  61 001e 1269     		ldr	r2, [r2, #16]
  62              		.loc 1 518 58 discriminator 1 view .LVU14
  63 0020 9342     		cmp	r3, r2
  64 0022 07D8     		bhi	.L1
 519:Src/foc.c     ****     {
 520:Src/foc.c     ****         if (Measure_R_Info.Used_Mos == &U3)
  65              		.loc 1 520 9 is_stmt 1 view .LVU15
  66              		.loc 1 520 27 is_stmt 0 view .LVU16
  67 0024 234B     		ldr	r3, .L6+4
  68 0026 5B68     		ldr	r3, [r3, #4]
  69              		.loc 1 520 12 view .LVU17
  70 0028 234A     		ldr	r2, .L6+8
  71 002a 9342     		cmp	r3, r2
  72 002c 03D0     		beq	.L4
 521:Src/foc.c     ****         { //011
 522:Src/foc.c     ****             Measure_R_Info.current_sum += ADC_RAW2_CURRENT(ADC_Values_Raw2[0]);
 523:Src/foc.c     ****         }
 524:Src/foc.c     ****         else if (Measure_R_Info.Used_Mos == &U5)
  73              		.loc 1 524 14 is_stmt 1 view .LVU18
  74              		.loc 1 524 17 is_stmt 0 view .LVU19
  75 002e 234A     		ldr	r2, .L6+12
  76 0030 9342     		cmp	r3, r2
  77 0032 1ED0     		beq	.L5
  78              	.L1:
 525:Src/foc.c     ****         {
 526:Src/foc.c     ****             Measure_R_Info.current_sum += ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 527:Src/foc.c     ****         }
 528:Src/foc.c     ****     }
 529:Src/foc.c     **** }...
  79              		.loc 1 529 1 view .LVU20
  80 0034 7047     		bx	lr
  81              	.L4:
 522:Src/foc.c     ****             Measure_R_Info.current_sum += ADC_RAW2_CURRENT(ADC_Values_Raw2[0]);
  82              		.loc 1 522 13 is_stmt 1 view .LVU21
 522:Src/foc.c     ****             Measure_R_Info.current_sum += ADC_RAW2_CURRENT(ADC_Values_Raw2[0]);
  83              		.loc 1 522 43 is_stmt 0 view .LVU22
  84 0036 224B     		ldr	r3, .L6+16
  85 0038 1B88     		ldrh	r3, [r3]
  86 003a 07EE903A 		vmov	s15, r3	@ int
  87 003e F8EEE77A 		vcvt.f32.s32	s15, s15
  88 0042 9FED207A 		vldr.32	s14, .L6+20
  89 0046 67EE877A 		vmul.f32	s15, s15, s14
  90 004a 9FED1F7A 		vldr.32	s14, .L6+24
  91 004e 67EE877A 		vmul.f32	s15, s15, s14
  92 0052 9FED1E7A 		vldr.32	s14, .L6+28
  93 0056 C7EE876A 		vdiv.f32	s13, s15, s14
  94 005a DFED1D7A 		vldr.32	s15, .L6+32
  95 005e 86EEA77A 		vdiv.f32	s14, s13, s15
 522:Src/foc.c     ****             Measure_R_Info.current_sum += ADC_RAW2_CURRENT(ADC_Values_Raw2[0]);
  96              		.loc 1 522 40 view .LVU23
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 12


  97 0062 144B     		ldr	r3, .L6+4
  98 0064 D3ED057A 		vldr.32	s15, [r3, #20]
  99 0068 77EE877A 		vadd.f32	s15, s15, s14
 100 006c C3ED057A 		vstr.32	s15, [r3, #20]
 101 0070 7047     		bx	lr
 102              	.L5:
 526:Src/foc.c     ****             Measure_R_Info.current_sum += ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 103              		.loc 1 526 13 is_stmt 1 view .LVU24
 526:Src/foc.c     ****             Measure_R_Info.current_sum += ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 104              		.loc 1 526 43 is_stmt 0 view .LVU25
 105 0072 134B     		ldr	r3, .L6+16
 106 0074 5B88     		ldrh	r3, [r3, #2]
 107 0076 07EE903A 		vmov	s15, r3	@ int
 108 007a F8EEE77A 		vcvt.f32.s32	s15, s15
 109 007e 9FED117A 		vldr.32	s14, .L6+20
 110 0082 67EE877A 		vmul.f32	s15, s15, s14
 111 0086 9FED107A 		vldr.32	s14, .L6+24
 112 008a 67EE877A 		vmul.f32	s15, s15, s14
 113 008e 9FED0F7A 		vldr.32	s14, .L6+28
 114 0092 C7EE876A 		vdiv.f32	s13, s15, s14
 115 0096 DFED0E7A 		vldr.32	s15, .L6+32
 116 009a 86EEA77A 		vdiv.f32	s14, s13, s15
 526:Src/foc.c     ****             Measure_R_Info.current_sum += ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 117              		.loc 1 526 40 view .LVU26
 118 009e 054B     		ldr	r3, .L6+4
 119 00a0 D3ED057A 		vldr.32	s15, [r3, #20]
 120 00a4 77EE877A 		vadd.f32	s15, s15, s14
 121 00a8 C3ED057A 		vstr.32	s15, [r3, #20]
 122 00ac C2E7     		b	.L1
 123              	.L7:
 124 00ae 00BF     		.align	2
 125              	.L6:
 126 00b0 00000000 		.word	Board_Mode
 127 00b4 00000000 		.word	Measure_R_Info
 128 00b8 00000000 		.word	.LANCHOR0
 129 00bc 00000000 		.word	.LANCHOR1
 130 00c0 00000000 		.word	ADC_Values_Raw2
 131 00c4 00404E45 		.word	1162756096
 132 00c8 00008039 		.word	964689920
 133 00cc 00004843 		.word	1128792064
 134 00d0 A69B443B 		.word	994352038
 135              		.cfi_endproc
 136              	.LFE184:
 138              		.section	.text.UVects_Init,"ax",%progbits
 139              		.align	1
 140              		.syntax unified
 141              		.thumb
 142              		.thumb_func
 143              		.fpu fpv4-sp-d16
 145              	UVects_Init:
 146              	.LFB166:
  95:Src/foc.c     **** {
 147              		.loc 1 95 1 is_stmt 1 view -0
 148              		.cfi_startproc
 149              		@ args = 0, pretend = 0, frame = 0
 150              		@ frame_needed = 0, uses_anonymous_args = 0
 151 0000 70B5     		push	{r4, r5, r6, lr}
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 13


 152              	.LCFI0:
 153              		.cfi_def_cfa_offset 16
 154              		.cfi_offset 4, -16
 155              		.cfi_offset 5, -12
 156              		.cfi_offset 6, -8
 157              		.cfi_offset 14, -4
 158 0002 2DED028B 		vpush.64	{d8}
 159              	.LCFI1:
 160              		.cfi_def_cfa_offset 24
 161              		.cfi_offset 80, -24
 162              		.cfi_offset 81, -20
  96:Src/foc.c     ****     for (int i = 0; i < 6; ++i)
 163              		.loc 1 96 5 view .LVU28
 164              	.LBB2:
  96:Src/foc.c     ****     for (int i = 0; i < 6; ++i)
 165              		.loc 1 96 10 view .LVU29
 166              	.LVL0:
  96:Src/foc.c     ****     for (int i = 0; i < 6; ++i)
 167              		.loc 1 96 14 is_stmt 0 view .LVU30
 168 0006 0024     		movs	r4, #0
 169              	.LVL1:
 170              	.L9:
  96:Src/foc.c     ****     for (int i = 0; i < 6; ++i)
 171              		.loc 1 96 21 is_stmt 1 discriminator 1 view .LVU31
  96:Src/foc.c     ****     for (int i = 0; i < 6; ++i)
 172              		.loc 1 96 5 is_stmt 0 discriminator 1 view .LVU32
 173 0008 052C     		cmp	r4, #5
 174 000a 14DC     		bgt	.L12
 175              	.LBB3:
  98:Src/foc.c     ****         float v_theta = Uvects[i]->theta;
 176              		.loc 1 98 9 is_stmt 1 discriminator 3 view .LVU33
  98:Src/foc.c     ****         float v_theta = Uvects[i]->theta;
 177              		.loc 1 98 31 is_stmt 0 discriminator 3 view .LVU34
 178 000c 0B4D     		ldr	r5, .L13
 179 000e 55F82460 		ldr	r6, [r5, r4, lsl #2]
  98:Src/foc.c     ****         float v_theta = Uvects[i]->theta;
 180              		.loc 1 98 15 discriminator 3 view .LVU35
 181 0012 96ED018A 		vldr.32	s16, [r6, #4]
 182              	.LVL2:
  99:Src/foc.c     ****         Uvects[i]->x = cosf(v_theta);
 183              		.loc 1 99 9 is_stmt 1 discriminator 3 view .LVU36
  99:Src/foc.c     ****         Uvects[i]->x = cosf(v_theta);
 184              		.loc 1 99 24 is_stmt 0 discriminator 3 view .LVU37
 185 0016 B0EE480A 		vmov.f32	s0, s16
 186 001a FFF7FEFF 		bl	cosf
 187              	.LVL3:
  99:Src/foc.c     ****         Uvects[i]->x = cosf(v_theta);
 188              		.loc 1 99 22 discriminator 3 view .LVU38
 189 001e 86ED020A 		vstr.32	s0, [r6, #8]
 100:Src/foc.c     ****         Uvects[i]->y = sinf(v_theta);
 190              		.loc 1 100 9 is_stmt 1 discriminator 3 view .LVU39
 100:Src/foc.c     ****         Uvects[i]->y = sinf(v_theta);
 191              		.loc 1 100 15 is_stmt 0 discriminator 3 view .LVU40
 192 0022 55F82450 		ldr	r5, [r5, r4, lsl #2]
 100:Src/foc.c     ****         Uvects[i]->y = sinf(v_theta);
 193              		.loc 1 100 24 discriminator 3 view .LVU41
 194 0026 B0EE480A 		vmov.f32	s0, s16
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 14


 195 002a FFF7FEFF 		bl	sinf
 196              	.LVL4:
 100:Src/foc.c     ****         Uvects[i]->y = sinf(v_theta);
 197              		.loc 1 100 22 discriminator 3 view .LVU42
 198 002e 85ED030A 		vstr.32	s0, [r5, #12]
 199              	.LBE3:
  96:Src/foc.c     ****     for (int i = 0; i < 6; ++i)
 200              		.loc 1 96 28 is_stmt 1 discriminator 3 view .LVU43
 201 0032 0134     		adds	r4, r4, #1
 202              	.LVL5:
  96:Src/foc.c     ****     for (int i = 0; i < 6; ++i)
 203              		.loc 1 96 28 is_stmt 0 discriminator 3 view .LVU44
 204 0034 E8E7     		b	.L9
 205              	.LVL6:
 206              	.L12:
  96:Src/foc.c     ****     for (int i = 0; i < 6; ++i)
 207              		.loc 1 96 28 discriminator 3 view .LVU45
 208              	.LBE2:
 102:Src/foc.c     **** }
 209              		.loc 1 102 1 view .LVU46
 210 0036 BDEC028B 		vldm	sp!, {d8}
 211              	.LCFI2:
 212              		.cfi_restore 80
 213              		.cfi_restore 81
 214              		.cfi_def_cfa_offset 16
 215 003a 70BD     		pop	{r4, r5, r6, pc}
 216              	.LVL7:
 217              	.L14:
 102:Src/foc.c     **** }
 218              		.loc 1 102 1 view .LVU47
 219              		.align	2
 220              	.L13:
 221 003c 00000000 		.word	.LANCHOR2
 222              		.cfi_endproc
 223              	.LFE166:
 225              		.section	.text.Foc_Init,"ax",%progbits
 226              		.align	1
 227              		.global	Foc_Init
 228              		.syntax unified
 229              		.thumb
 230              		.thumb_func
 231              		.fpu fpv4-sp-d16
 233              	Foc_Init:
 234              	.LVL8:
 235              	.LFB167:
 105:Src/foc.c     **** {
 236              		.loc 1 105 1 is_stmt 1 view -0
 237              		.cfi_startproc
 238              		@ args = 0, pretend = 0, frame = 0
 239              		@ frame_needed = 0, uses_anonymous_args = 0
 105:Src/foc.c     **** {
 240              		.loc 1 105 1 is_stmt 0 view .LVU49
 241 0000 38B5     		push	{r3, r4, r5, lr}
 242              	.LCFI3:
 243              		.cfi_def_cfa_offset 16
 244              		.cfi_offset 3, -16
 245              		.cfi_offset 4, -12
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 15


 246              		.cfi_offset 5, -8
 247              		.cfi_offset 14, -4
 107:Src/foc.c     ****     Board_Mode = VF_OPENLOOP;
 248              		.loc 1 107 5 is_stmt 1 view .LVU50
 107:Src/foc.c     ****     Board_Mode = VF_OPENLOOP;
 249              		.loc 1 107 16 is_stmt 0 view .LVU51
 250 0002 0425     		movs	r5, #4
 251 0004 184B     		ldr	r3, .L17
 252 0006 1D70     		strb	r5, [r3]
 108:Src/foc.c     ****     TIM8->ARR = 168000000 / TIM8_FREQ / 2;
 253              		.loc 1 108 5 is_stmt 1 view .LVU52
 108:Src/foc.c     ****     TIM8->ARR = 168000000 / TIM8_FREQ / 2;
 254              		.loc 1 108 15 is_stmt 0 view .LVU53
 255 0008 184B     		ldr	r3, .L17+4
 256 000a 41F26802 		movw	r2, #4200
 257 000e DA62     		str	r2, [r3, #44]
 110:Src/foc.c     ****     TIM8->CCR4 = TIM8->ARR - 2;
 258              		.loc 1 110 5 is_stmt 1 view .LVU54
 110:Src/foc.c     ****     TIM8->CCR4 = TIM8->ARR - 2;
 259              		.loc 1 110 22 is_stmt 0 view .LVU55
 260 0010 DA6A     		ldr	r2, [r3, #44]
 110:Src/foc.c     ****     TIM8->CCR4 = TIM8->ARR - 2;
 261              		.loc 1 110 28 view .LVU56
 262 0012 023A     		subs	r2, r2, #2
 110:Src/foc.c     ****     TIM8->CCR4 = TIM8->ARR - 2;
 263              		.loc 1 110 16 view .LVU57
 264 0014 1A64     		str	r2, [r3, #64]
 112:Src/foc.c     ****     UVects_Init();
 265              		.loc 1 112 5 is_stmt 1 view .LVU58
 266 0016 FFF7FEFF 		bl	UVects_Init
 267              	.LVL9:
 114:Src/foc.c     ****     HAL_TIM_PWM_Start(&htim8, TIM_CHANNEL_1);
 268              		.loc 1 114 5 view .LVU59
 269 001a 154C     		ldr	r4, .L17+8
 270 001c 0021     		movs	r1, #0
 271 001e 2046     		mov	r0, r4
 272 0020 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 273              	.LVL10:
 115:Src/foc.c     ****     HAL_TIM_PWM_Start(&htim8, TIM_CHANNEL_2);
 274              		.loc 1 115 5 view .LVU60
 275 0024 2946     		mov	r1, r5
 276 0026 2046     		mov	r0, r4
 277 0028 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 278              	.LVL11:
 116:Src/foc.c     ****     HAL_TIM_PWM_Start(&htim8, TIM_CHANNEL_3);
 279              		.loc 1 116 5 view .LVU61
 280 002c 0821     		movs	r1, #8
 281 002e 2046     		mov	r0, r4
 282 0030 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 283              	.LVL12:
 118:Src/foc.c     ****     HAL_TIMEx_PWMN_Start(&htim8, TIM_CHANNEL_1);
 284              		.loc 1 118 5 view .LVU62
 285 0034 0021     		movs	r1, #0
 286 0036 2046     		mov	r0, r4
 287 0038 FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 288              	.LVL13:
 119:Src/foc.c     ****     HAL_TIMEx_PWMN_Start(&htim8, TIM_CHANNEL_2);
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 16


 289              		.loc 1 119 5 view .LVU63
 290 003c 2946     		mov	r1, r5
 291 003e 2046     		mov	r0, r4
 292 0040 FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 293              	.LVL14:
 120:Src/foc.c     ****     HAL_TIMEx_PWMN_Start(&htim8, TIM_CHANNEL_3);
 294              		.loc 1 120 5 view .LVU64
 295 0044 0821     		movs	r1, #8
 296 0046 2046     		mov	r0, r4
 297 0048 FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 298              	.LVL15:
 122:Src/foc.c     ****     TIM7->PSC = 1;
 299              		.loc 1 122 5 view .LVU65
 122:Src/foc.c     ****     TIM7->PSC = 1;
 300              		.loc 1 122 15 is_stmt 0 view .LVU66
 301 004c 094B     		ldr	r3, .L17+12
 302 004e 0122     		movs	r2, #1
 303 0050 9A62     		str	r2, [r3, #40]
 123:Src/foc.c     ****     TIM7->ARR = 42000000 / TIM7_FREQ - 1;
 304              		.loc 1 123 5 is_stmt 1 view .LVU67
 123:Src/foc.c     ****     TIM7->ARR = 42000000 / TIM7_FREQ - 1;
 305              		.loc 1 123 15 is_stmt 0 view .LVU68
 306 0052 4AF20F42 		movw	r2, #41999
 307 0056 DA62     		str	r2, [r3, #44]
 125:Src/foc.c     ****     HAL_TIM_Base_Start_IT(&htim7);
 308              		.loc 1 125 5 is_stmt 1 view .LVU69
 309 0058 0748     		ldr	r0, .L17+16
 310 005a FFF7FEFF 		bl	HAL_TIM_Base_Start_IT
 311              	.LVL16:
 127:Src/foc.c     ****     HAL_TIM_Base_Start(&htim8);
 312              		.loc 1 127 5 view .LVU70
 313 005e 2046     		mov	r0, r4
 314 0060 FFF7FEFF 		bl	HAL_TIM_Base_Start
 315              	.LVL17:
 128:Src/foc.c     **** }
 316              		.loc 1 128 1 is_stmt 0 view .LVU71
 317 0064 38BD     		pop	{r3, r4, r5, pc}
 318              	.L18:
 319 0066 00BF     		.align	2
 320              	.L17:
 321 0068 00000000 		.word	Board_Mode
 322 006c 00040140 		.word	1073808384
 323 0070 00000000 		.word	htim8
 324 0074 00140040 		.word	1073746944
 325 0078 00000000 		.word	htim7
 326              		.cfi_endproc
 327              	.LFE167:
 329              		.section	.text.get_area,"ax",%progbits
 330              		.align	1
 331              		.global	get_area
 332              		.syntax unified
 333              		.thumb
 334              		.thumb_func
 335              		.fpu fpv4-sp-d16
 337              	get_area:
 338              	.LVL18:
 339              	.LFB168:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 17


 131:Src/foc.c     **** {
 340              		.loc 1 131 1 is_stmt 1 view -0
 341              		.cfi_startproc
 342              		@ args = 0, pretend = 0, frame = 0
 343              		@ frame_needed = 0, uses_anonymous_args = 0
 344              		@ link register save eliminated.
 132:Src/foc.c     ****     return now_theta / 60 + 1;
 345              		.loc 1 132 5 view .LVU73
 132:Src/foc.c     ****     return now_theta / 60 + 1;
 346              		.loc 1 132 22 is_stmt 0 view .LVU74
 347 0000 034B     		ldr	r3, .L20
 348 0002 A3FB0030 		umull	r3, r0, r3, r0
 349              	.LVL19:
 132:Src/foc.c     ****     return now_theta / 60 + 1;
 350              		.loc 1 132 22 view .LVU75
 351 0006 4009     		lsrs	r0, r0, #5
 132:Src/foc.c     ****     return now_theta / 60 + 1;
 352              		.loc 1 132 27 view .LVU76
 353 0008 0130     		adds	r0, r0, #1
 133:Src/foc.c     **** }
 354              		.loc 1 133 1 view .LVU77
 355 000a C0B2     		uxtb	r0, r0
 356 000c 7047     		bx	lr
 357              	.L21:
 358 000e 00BF     		.align	2
 359              	.L20:
 360 0010 89888888 		.word	-2004318071
 361              		.cfi_endproc
 362              	.LFE168:
 364              		.section	.text.get_area_u,"ax",%progbits
 365              		.align	1
 366              		.global	get_area_u
 367              		.syntax unified
 368              		.thumb
 369              		.thumb_func
 370              		.fpu fpv4-sp-d16
 372              	get_area_u:
 373              	.LVL20:
 374              	.LFB169:
 138:Src/foc.c     **** {
 375              		.loc 1 138 1 is_stmt 1 view -0
 376              		.cfi_startproc
 377              		@ args = 0, pretend = 0, frame = 0
 378              		@ frame_needed = 0, uses_anonymous_args = 0
 379              		@ link register save eliminated.
 138:Src/foc.c     **** {
 380              		.loc 1 138 1 is_stmt 0 view .LVU79
 381 0000 30B4     		push	{r4, r5}
 382              	.LCFI4:
 383              		.cfi_def_cfa_offset 8
 384              		.cfi_offset 4, -8
 385              		.cfi_offset 5, -4
 386 0002 0D46     		mov	r5, r1
 387 0004 1446     		mov	r4, r2
 139:Src/foc.c     ****     switch (area)
 388              		.loc 1 139 5 is_stmt 1 view .LVU80
 389 0006 0138     		subs	r0, r0, #1
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 18


 390              	.LVL21:
 139:Src/foc.c     ****     switch (area)
 391              		.loc 1 139 5 is_stmt 0 view .LVU81
 392 0008 0528     		cmp	r0, #5
 393 000a 0CD8     		bhi	.L22
 394 000c DFE800F0 		tbb	[pc, r0]
 395              	.L25:
 396 0010 03       		.byte	(.L30-.L25)/2
 397 0011 0D       		.byte	(.L29-.L25)/2
 398 0012 16       		.byte	(.L28-.L25)/2
 399 0013 1F       		.byte	(.L27-.L25)/2
 400 0014 28       		.byte	(.L26-.L25)/2
 401 0015 31       		.byte	(.L24-.L25)/2
 402              		.p2align 1
 403              	.L30:
 142:Src/foc.c     ****         *u1 = U4;
 404              		.loc 1 142 9 is_stmt 1 view .LVU82
 142:Src/foc.c     ****         *u1 = U4;
 405              		.loc 1 142 13 is_stmt 0 view .LVU83
 406 0016 1B4B     		ldr	r3, .L32
 407 0018 0FCB     		ldm	r3, {r0, r1, r2, r3}
 408              	.LVL22:
 142:Src/foc.c     ****         *u1 = U4;
 409              		.loc 1 142 13 view .LVU84
 410 001a 85E80F00 		stm	r5, {r0, r1, r2, r3}
 143:Src/foc.c     ****         *u2 = U6;
 411              		.loc 1 143 9 is_stmt 1 view .LVU85
 143:Src/foc.c     ****         *u2 = U6;
 412              		.loc 1 143 13 is_stmt 0 view .LVU86
 413 001e 1A4B     		ldr	r3, .L32+4
 414 0020 0FCB     		ldm	r3, {r0, r1, r2, r3}
 415 0022 84E80F00 		stm	r4, {r0, r1, r2, r3}
 144:Src/foc.c     ****         break;
 416              		.loc 1 144 9 is_stmt 1 view .LVU87
 417              	.L22:
 168:Src/foc.c     **** }
 418              		.loc 1 168 1 is_stmt 0 view .LVU88
 419 0026 30BC     		pop	{r4, r5}
 420              	.LCFI5:
 421              		.cfi_remember_state
 422              		.cfi_restore 5
 423              		.cfi_restore 4
 424              		.cfi_def_cfa_offset 0
 425              	.LVL23:
 168:Src/foc.c     **** }
 426              		.loc 1 168 1 view .LVU89
 427 0028 7047     		bx	lr
 428              	.LVL24:
 429              	.L29:
 430              	.LCFI6:
 431              		.cfi_restore_state
 146:Src/foc.c     ****         *u1 = U6;
 432              		.loc 1 146 9 is_stmt 1 view .LVU90
 146:Src/foc.c     ****         *u1 = U6;
 433              		.loc 1 146 13 is_stmt 0 view .LVU91
 434 002a 174B     		ldr	r3, .L32+4
 435 002c 0FCB     		ldm	r3, {r0, r1, r2, r3}
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 19


 436              	.LVL25:
 146:Src/foc.c     ****         *u1 = U6;
 437              		.loc 1 146 13 view .LVU92
 438 002e 85E80F00 		stm	r5, {r0, r1, r2, r3}
 147:Src/foc.c     ****         *u2 = U2;
 439              		.loc 1 147 9 is_stmt 1 view .LVU93
 147:Src/foc.c     ****         *u2 = U2;
 440              		.loc 1 147 13 is_stmt 0 view .LVU94
 441 0032 164B     		ldr	r3, .L32+8
 442 0034 0FCB     		ldm	r3, {r0, r1, r2, r3}
 443 0036 84E80F00 		stm	r4, {r0, r1, r2, r3}
 148:Src/foc.c     ****         break;
 444              		.loc 1 148 9 is_stmt 1 view .LVU95
 445 003a F4E7     		b	.L22
 446              	.LVL26:
 447              	.L28:
 150:Src/foc.c     ****         *u1 = U2;
 448              		.loc 1 150 9 view .LVU96
 150:Src/foc.c     ****         *u1 = U2;
 449              		.loc 1 150 13 is_stmt 0 view .LVU97
 450 003c 134B     		ldr	r3, .L32+8
 451 003e 0FCB     		ldm	r3, {r0, r1, r2, r3}
 452              	.LVL27:
 150:Src/foc.c     ****         *u1 = U2;
 453              		.loc 1 150 13 view .LVU98
 454 0040 85E80F00 		stm	r5, {r0, r1, r2, r3}
 151:Src/foc.c     ****         *u2 = U3;
 455              		.loc 1 151 9 is_stmt 1 view .LVU99
 151:Src/foc.c     ****         *u2 = U3;
 456              		.loc 1 151 13 is_stmt 0 view .LVU100
 457 0044 124B     		ldr	r3, .L32+12
 458 0046 0FCB     		ldm	r3, {r0, r1, r2, r3}
 459 0048 84E80F00 		stm	r4, {r0, r1, r2, r3}
 152:Src/foc.c     ****         break;
 460              		.loc 1 152 9 is_stmt 1 view .LVU101
 461 004c EBE7     		b	.L22
 462              	.LVL28:
 463              	.L27:
 154:Src/foc.c     ****         *u1 = U3;
 464              		.loc 1 154 9 view .LVU102
 154:Src/foc.c     ****         *u1 = U3;
 465              		.loc 1 154 13 is_stmt 0 view .LVU103
 466 004e 104B     		ldr	r3, .L32+12
 467 0050 0FCB     		ldm	r3, {r0, r1, r2, r3}
 468              	.LVL29:
 154:Src/foc.c     ****         *u1 = U3;
 469              		.loc 1 154 13 view .LVU104
 470 0052 85E80F00 		stm	r5, {r0, r1, r2, r3}
 155:Src/foc.c     ****         *u2 = U1;
 471              		.loc 1 155 9 is_stmt 1 view .LVU105
 155:Src/foc.c     ****         *u2 = U1;
 472              		.loc 1 155 13 is_stmt 0 view .LVU106
 473 0056 0F4B     		ldr	r3, .L32+16
 474 0058 0FCB     		ldm	r3, {r0, r1, r2, r3}
 475 005a 84E80F00 		stm	r4, {r0, r1, r2, r3}
 156:Src/foc.c     ****         break;
 476              		.loc 1 156 9 is_stmt 1 view .LVU107
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 20


 477 005e E2E7     		b	.L22
 478              	.LVL30:
 479              	.L26:
 158:Src/foc.c     ****         *u1 = U1;
 480              		.loc 1 158 9 view .LVU108
 158:Src/foc.c     ****         *u1 = U1;
 481              		.loc 1 158 13 is_stmt 0 view .LVU109
 482 0060 0C4B     		ldr	r3, .L32+16
 483 0062 0FCB     		ldm	r3, {r0, r1, r2, r3}
 484              	.LVL31:
 158:Src/foc.c     ****         *u1 = U1;
 485              		.loc 1 158 13 view .LVU110
 486 0064 85E80F00 		stm	r5, {r0, r1, r2, r3}
 159:Src/foc.c     ****         *u2 = U5;
 487              		.loc 1 159 9 is_stmt 1 view .LVU111
 159:Src/foc.c     ****         *u2 = U5;
 488              		.loc 1 159 13 is_stmt 0 view .LVU112
 489 0068 0B4B     		ldr	r3, .L32+20
 490 006a 0FCB     		ldm	r3, {r0, r1, r2, r3}
 491 006c 84E80F00 		stm	r4, {r0, r1, r2, r3}
 160:Src/foc.c     ****         break;
 492              		.loc 1 160 9 is_stmt 1 view .LVU113
 493 0070 D9E7     		b	.L22
 494              	.LVL32:
 495              	.L24:
 162:Src/foc.c     ****         *u1 = U5;
 496              		.loc 1 162 9 view .LVU114
 162:Src/foc.c     ****         *u1 = U5;
 497              		.loc 1 162 13 is_stmt 0 view .LVU115
 498 0072 094B     		ldr	r3, .L32+20
 499 0074 0FCB     		ldm	r3, {r0, r1, r2, r3}
 500              	.LVL33:
 162:Src/foc.c     ****         *u1 = U5;
 501              		.loc 1 162 13 view .LVU116
 502 0076 85E80F00 		stm	r5, {r0, r1, r2, r3}
 163:Src/foc.c     ****         *u2 = U4;
 503              		.loc 1 163 9 is_stmt 1 view .LVU117
 163:Src/foc.c     ****         *u2 = U4;
 504              		.loc 1 163 13 is_stmt 0 view .LVU118
 505 007a 024B     		ldr	r3, .L32
 506 007c 0FCB     		ldm	r3, {r0, r1, r2, r3}
 507 007e 84E80F00 		stm	r4, {r0, r1, r2, r3}
 164:Src/foc.c     ****         break;
 508              		.loc 1 164 9 is_stmt 1 view .LVU119
 168:Src/foc.c     **** }
 509              		.loc 1 168 1 is_stmt 0 view .LVU120
 510 0082 D0E7     		b	.L22
 511              	.L33:
 512              		.align	2
 513              	.L32:
 514 0084 00000000 		.word	.LANCHOR3
 515 0088 00000000 		.word	.LANCHOR4
 516 008c 00000000 		.word	.LANCHOR5
 517 0090 00000000 		.word	.LANCHOR0
 518 0094 00000000 		.word	.LANCHOR6
 519 0098 00000000 		.word	.LANCHOR1
 520              		.cfi_endproc
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 21


 521              	.LFE169:
 523              		.section	.text.get_t,"ax",%progbits
 524              		.align	1
 525              		.global	get_t
 526              		.syntax unified
 527              		.thumb
 528              		.thumb_func
 529              		.fpu fpv4-sp-d16
 531              	get_t:
 532              	.LVL34:
 533              	.LFB170:
 175:Src/foc.c     **** {
 534              		.loc 1 175 1 is_stmt 1 view -0
 535              		.cfi_startproc
 536              		@ args = 0, pretend = 0, frame = 40
 537              		@ frame_needed = 0, uses_anonymous_args = 0
 175:Src/foc.c     **** {
 538              		.loc 1 175 1 is_stmt 0 view .LVU122
 539 0000 30B5     		push	{r4, r5, lr}
 540              	.LCFI7:
 541              		.cfi_def_cfa_offset 12
 542              		.cfi_offset 4, -12
 543              		.cfi_offset 5, -8
 544              		.cfi_offset 14, -4
 545 0002 2DED028B 		vpush.64	{d8}
 546              	.LCFI8:
 547              		.cfi_def_cfa_offset 20
 548              		.cfi_offset 80, -20
 549              		.cfi_offset 81, -16
 550 0006 8BB0     		sub	sp, sp, #44
 551              	.LCFI9:
 552              		.cfi_def_cfa_offset 64
 553 0008 B0EE408A 		vmov.f32	s16, s0
 554 000c 0546     		mov	r5, r0
 555 000e 0C46     		mov	r4, r1
 185:Src/foc.c     ****     float temp_t1, temp_t2;
 556              		.loc 1 185 5 is_stmt 1 view .LVU123
 186:Src/foc.c     ****     float theta_f; // Âçï‰Ωç‰∏∫rad
 557              		.loc 1 186 5 view .LVU124
 187:Src/foc.c     ****     Uvect_Mos u1, u2;
 558              		.loc 1 187 5 view .LVU125
 188:Src/foc.c     ****     float x, y;
 559              		.loc 1 188 5 view .LVU126
 189:Src/foc.c     ****     get_area_u(get_area(theta), &u1, &u2);
 560              		.loc 1 189 5 view .LVU127
 561 0010 FCEEC07A 		vcvt.u32.f32	s15, s0
 562 0014 17EE900A 		vmov	r0, s15	@ int
 563              	.LVL35:
 189:Src/foc.c     ****     get_area_u(get_area(theta), &u1, &u2);
 564              		.loc 1 189 5 is_stmt 0 view .LVU128
 565 0018 FFF7FEFF 		bl	get_area
 566              	.LVL36:
 189:Src/foc.c     ****     get_area_u(get_area(theta), &u1, &u2);
 567              		.loc 1 189 5 view .LVU129
 568 001c 02AA     		add	r2, sp, #8
 569 001e 06A9     		add	r1, sp, #24
 570 0020 FFF7FEFF 		bl	get_area_u
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 22


 571              	.LVL37:
 191:Src/foc.c     ****     arm_sin_cos_f32(theta, &y, &x);
 572              		.loc 1 191 5 is_stmt 1 view .LVU130
 573 0024 01A9     		add	r1, sp, #4
 574 0026 6846     		mov	r0, sp
 575 0028 B0EE480A 		vmov.f32	s0, s16
 576 002c FFF7FEFF 		bl	arm_sin_cos_f32
 577              	.LVL38:
 192:Src/foc.c     ****     x *= 0.86f;
 578              		.loc 1 192 5 view .LVU131
 192:Src/foc.c     ****     x *= 0.86f;
 579              		.loc 1 192 7 is_stmt 0 view .LVU132
 580 0030 DFED197A 		vldr.32	s15, .L36
 581 0034 9DED017A 		vldr.32	s14, [sp, #4]
 582 0038 27EE277A 		vmul.f32	s14, s14, s15
 193:Src/foc.c     ****     y *= 0.86f; // sqrt(3)/2 Ê≤°Èîô
 583              		.loc 1 193 5 is_stmt 1 view .LVU133
 193:Src/foc.c     ****     y *= 0.86f; // sqrt(3)/2 Ê≤°Èîô
 584              		.loc 1 193 7 is_stmt 0 view .LVU134
 585 003c DDED006A 		vldr.32	s13, [sp]
 586 0040 66EEA76A 		vmul.f32	s13, s13, s15
 196:Src/foc.c     ****     temp_t1 = u2.y * x / (u1.x * u2.y - u2.x * u1.y) - (u2.x * y) / (u1.x * u2.y - u2.x * u1.y);
 587              		.loc 1 196 5 is_stmt 1 view .LVU135
 196:Src/foc.c     ****     temp_t1 = u2.y * x / (u1.x * u2.y - u2.x * u1.y) - (u2.x * y) / (u1.x * u2.y - u2.x * u1.y);
 588              		.loc 1 196 17 is_stmt 0 view .LVU136
 589 0044 DDED057A 		vldr.32	s15, [sp, #20]
 196:Src/foc.c     ****     temp_t1 = u2.y * x / (u1.x * u2.y - u2.x * u1.y) - (u2.x * y) / (u1.x * u2.y - u2.x * u1.y);
 590              		.loc 1 196 20 view .LVU137
 591 0048 27EE274A 		vmul.f32	s8, s14, s15
 196:Src/foc.c     ****     temp_t1 = u2.y * x / (u1.x * u2.y - u2.x * u1.y) - (u2.x * y) / (u1.x * u2.y - u2.x * u1.y);
 592              		.loc 1 196 29 view .LVU138
 593 004c DDED084A 		vldr.32	s9, [sp, #32]
 196:Src/foc.c     ****     temp_t1 = u2.y * x / (u1.x * u2.y - u2.x * u1.y) - (u2.x * y) / (u1.x * u2.y - u2.x * u1.y);
 594              		.loc 1 196 32 view .LVU139
 595 0050 67EEA47A 		vmul.f32	s15, s15, s9
 196:Src/foc.c     ****     temp_t1 = u2.y * x / (u1.x * u2.y - u2.x * u1.y) - (u2.x * y) / (u1.x * u2.y - u2.x * u1.y);
 596              		.loc 1 196 43 view .LVU140
 597 0054 9DED046A 		vldr.32	s12, [sp, #16]
 196:Src/foc.c     ****     temp_t1 = u2.y * x / (u1.x * u2.y - u2.x * u1.y) - (u2.x * y) / (u1.x * u2.y - u2.x * u1.y);
 598              		.loc 1 196 50 view .LVU141
 599 0058 9DED095A 		vldr.32	s10, [sp, #36]
 196:Src/foc.c     ****     temp_t1 = u2.y * x / (u1.x * u2.y - u2.x * u1.y) - (u2.x * y) / (u1.x * u2.y - u2.x * u1.y);
 600              		.loc 1 196 46 view .LVU142
 601 005c 66EE055A 		vmul.f32	s11, s12, s10
 196:Src/foc.c     ****     temp_t1 = u2.y * x / (u1.x * u2.y - u2.x * u1.y) - (u2.x * y) / (u1.x * u2.y - u2.x * u1.y);
 602              		.loc 1 196 39 view .LVU143
 603 0060 77EEE57A 		vsub.f32	s15, s15, s11
 196:Src/foc.c     ****     temp_t1 = u2.y * x / (u1.x * u2.y - u2.x * u1.y) - (u2.x * y) / (u1.x * u2.y - u2.x * u1.y);
 604              		.loc 1 196 24 view .LVU144
 605 0064 C4EE275A 		vdiv.f32	s11, s8, s15
 196:Src/foc.c     ****     temp_t1 = u2.y * x / (u1.x * u2.y - u2.x * u1.y) - (u2.x * y) / (u1.x * u2.y - u2.x * u1.y);
 606              		.loc 1 196 62 view .LVU145
 607 0068 26EE866A 		vmul.f32	s12, s13, s12
 196:Src/foc.c     ****     temp_t1 = u2.y * x / (u1.x * u2.y - u2.x * u1.y) - (u2.x * y) / (u1.x * u2.y - u2.x * u1.y);
 608              		.loc 1 196 67 view .LVU146
 609 006c 86EE274A 		vdiv.f32	s8, s12, s15
 196:Src/foc.c     ****     temp_t1 = u2.y * x / (u1.x * u2.y - u2.x * u1.y) - (u2.x * y) / (u1.x * u2.y - u2.x * u1.y);
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 23


 610              		.loc 1 196 13 view .LVU147
 611 0070 75EEC45A 		vsub.f32	s11, s11, s8
 612              	.LVL39:
 197:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 613              		.loc 1 197 5 is_stmt 1 view .LVU148
 197:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 614              		.loc 1 197 20 is_stmt 0 view .LVU149
 615 0074 66EEA46A 		vmul.f32	s13, s13, s9
 197:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 616              		.loc 1 197 24 view .LVU150
 617 0078 86EEA76A 		vdiv.f32	s12, s13, s15
 197:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 618              		.loc 1 197 62 view .LVU151
 619 007c 27EE057A 		vmul.f32	s14, s14, s10
 197:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 620              		.loc 1 197 67 view .LVU152
 621 0080 C7EE276A 		vdiv.f32	s13, s14, s15
 197:Src/foc.c     ****     temp_t2 = u1.x * y / (u1.x * u2.y - u2.x * u1.y) - (u1.y * x) / (u1.x * u2.y - u2.x * u1.y);
 622              		.loc 1 197 13 view .LVU153
 623 0084 76EE667A 		vsub.f32	s15, s12, s13
 624              	.LVL40:
 199:Src/foc.c     ****     *t1 = temp_t1;
 625              		.loc 1 199 5 is_stmt 1 view .LVU154
 199:Src/foc.c     ****     *t1 = temp_t1;
 626              		.loc 1 199 9 is_stmt 0 view .LVU155
 627 0088 C5ED005A 		vstr.32	s11, [r5]
 200:Src/foc.c     ****     *t2 = temp_t2;
 628              		.loc 1 200 5 is_stmt 1 view .LVU156
 200:Src/foc.c     ****     *t2 = temp_t2;
 629              		.loc 1 200 9 is_stmt 0 view .LVU157
 630 008c C4ED007A 		vstr.32	s15, [r4]
 201:Src/foc.c     **** }
 631              		.loc 1 201 1 view .LVU158
 632 0090 0BB0     		add	sp, sp, #44
 633              	.LCFI10:
 634              		.cfi_def_cfa_offset 20
 635              		@ sp needed
 636 0092 BDEC028B 		vldm	sp!, {d8}
 637              	.LCFI11:
 638              		.cfi_restore 80
 639              		.cfi_restore 81
 640              		.cfi_def_cfa_offset 12
 641              	.LVL41:
 201:Src/foc.c     **** }
 642              		.loc 1 201 1 view .LVU159
 643 0096 30BD     		pop	{r4, r5, pc}
 644              	.LVL42:
 645              	.L37:
 201:Src/foc.c     **** }
 646              		.loc 1 201 1 view .LVU160
 647              		.align	2
 648              	.L36:
 649 0098 F6285C3F 		.word	1063004406
 650              		.cfi_endproc
 651              	.LFE170:
 653              		.section	.text.get_ccr_duty,"ax",%progbits
 654              		.align	1
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 24


 655              		.global	get_ccr_duty
 656              		.syntax unified
 657              		.thumb
 658              		.thumb_func
 659              		.fpu fpv4-sp-d16
 661              	get_ccr_duty:
 662              	.LVL43:
 663              	.LFB171:
 204:Src/foc.c     **** {
 664              		.loc 1 204 1 is_stmt 1 view -0
 665              		.cfi_startproc
 666              		@ args = 16, pretend = 0, frame = 56
 667              		@ frame_needed = 0, uses_anonymous_args = 0
 668              		@ link register save eliminated.
 204:Src/foc.c     **** {
 669              		.loc 1 204 1 is_stmt 0 view .LVU162
 670 0000 10B4     		push	{r4}
 671              	.LCFI12:
 672              		.cfi_def_cfa_offset 4
 673              		.cfi_offset 4, -4
 674 0002 8FB0     		sub	sp, sp, #60
 675              	.LCFI13:
 676              		.cfi_def_cfa_offset 64
 677 0004 04AC     		add	r4, sp, #16
 678 0006 84E80F00 		stm	r4, {r0, r1, r2, r3}
 205:Src/foc.c     ****     float t0, t3;
 679              		.loc 1 205 5 is_stmt 1 view .LVU163
 206:Src/foc.c     ****     CCR_Duty result;
 680              		.loc 1 206 5 view .LVU164
 207:Src/foc.c     ****     t0 = (1 - t1 - t2) / 2;
 681              		.loc 1 207 5 view .LVU165
 207:Src/foc.c     ****     t0 = (1 - t1 - t2) / 2;
 682              		.loc 1 207 13 is_stmt 0 view .LVU166
 683 000a F7EE007A 		vmov.f32	s15, #1.0e+0
 684 000e 77EEC07A 		vsub.f32	s15, s15, s0
 207:Src/foc.c     ****     t0 = (1 - t1 - t2) / 2;
 685              		.loc 1 207 18 view .LVU167
 686 0012 77EEE07A 		vsub.f32	s15, s15, s1
 207:Src/foc.c     ****     t0 = (1 - t1 - t2) / 2;
 687              		.loc 1 207 8 view .LVU168
 688 0016 B6EE007A 		vmov.f32	s14, #5.0e-1
 689 001a 27EE877A 		vmul.f32	s14, s15, s14
 690              	.LVL44:
 208:Src/foc.c     ****     t3 = t0;
 691              		.loc 1 208 5 is_stmt 1 view .LVU169
 210:Src/foc.c     ****     result.ccra = U7.a * t3 + u1.a * t1 + u2.a * t2;
 692              		.loc 1 210 5 view .LVU170
 210:Src/foc.c     ****     result.ccra = U7.a * t3 + u1.a * t1 + u2.a * t2;
 693              		.loc 1 210 21 is_stmt 0 view .LVU171
 694 001e 344B     		ldr	r3, .L40
 695 0020 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 696 0022 07EE902A 		vmov	s15, r2	@ int
 210:Src/foc.c     ****     result.ccra = U7.a * t3 + u1.a * t1 + u2.a * t2;
 697              		.loc 1 210 24 view .LVU172
 698 0026 F8EEE77A 		vcvt.f32.s32	s15, s15
 699 002a 67EE877A 		vmul.f32	s15, s15, s14
 210:Src/foc.c     ****     result.ccra = U7.a * t3 + u1.a * t1 + u2.a * t2;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 25


 700              		.loc 1 210 33 view .LVU173
 701 002e 9DF81020 		ldrb	r2, [sp, #16]	@ zero_extendqisi2
 702 0032 06EE902A 		vmov	s13, r2	@ int
 210:Src/foc.c     ****     result.ccra = U7.a * t3 + u1.a * t1 + u2.a * t2;
 703              		.loc 1 210 36 view .LVU174
 704 0036 F8EEE66A 		vcvt.f32.s32	s13, s13
 705 003a 66EE806A 		vmul.f32	s13, s13, s0
 210:Src/foc.c     ****     result.ccra = U7.a * t3 + u1.a * t1 + u2.a * t2;
 706              		.loc 1 210 29 view .LVU175
 707 003e 77EEA67A 		vadd.f32	s15, s15, s13
 210:Src/foc.c     ****     result.ccra = U7.a * t3 + u1.a * t1 + u2.a * t2;
 708              		.loc 1 210 45 view .LVU176
 709 0042 9DF84020 		ldrb	r2, [sp, #64]	@ zero_extendqisi2
 710 0046 06EE902A 		vmov	s13, r2	@ int
 210:Src/foc.c     ****     result.ccra = U7.a * t3 + u1.a * t1 + u2.a * t2;
 711              		.loc 1 210 48 view .LVU177
 712 004a F8EEE66A 		vcvt.f32.s32	s13, s13
 713 004e 66EEA06A 		vmul.f32	s13, s13, s1
 210:Src/foc.c     ****     result.ccra = U7.a * t3 + u1.a * t1 + u2.a * t2;
 714              		.loc 1 210 41 view .LVU178
 715 0052 77EEA67A 		vadd.f32	s15, s15, s13
 210:Src/foc.c     ****     result.ccra = U7.a * t3 + u1.a * t1 + u2.a * t2;
 716              		.loc 1 210 17 view .LVU179
 717 0056 CDED087A 		vstr.32	s15, [sp, #32]
 211:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 718              		.loc 1 211 5 is_stmt 1 view .LVU180
 211:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 719              		.loc 1 211 21 is_stmt 0 view .LVU181
 720 005a 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 721 005c 07EE902A 		vmov	s15, r2	@ int
 211:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 722              		.loc 1 211 24 view .LVU182
 723 0060 F8EEE77A 		vcvt.f32.s32	s15, s15
 724 0064 67EE877A 		vmul.f32	s15, s15, s14
 211:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 725              		.loc 1 211 33 view .LVU183
 726 0068 9DF81120 		ldrb	r2, [sp, #17]	@ zero_extendqisi2
 727 006c 06EE902A 		vmov	s13, r2	@ int
 211:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 728              		.loc 1 211 36 view .LVU184
 729 0070 F8EEE66A 		vcvt.f32.s32	s13, s13
 730 0074 66EE806A 		vmul.f32	s13, s13, s0
 211:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 731              		.loc 1 211 29 view .LVU185
 732 0078 77EEA67A 		vadd.f32	s15, s15, s13
 211:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 733              		.loc 1 211 45 view .LVU186
 734 007c 9DF84120 		ldrb	r2, [sp, #65]	@ zero_extendqisi2
 735 0080 06EE902A 		vmov	s13, r2	@ int
 211:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 736              		.loc 1 211 48 view .LVU187
 737 0084 F8EEE66A 		vcvt.f32.s32	s13, s13
 738 0088 66EEA06A 		vmul.f32	s13, s13, s1
 211:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
 739              		.loc 1 211 41 view .LVU188
 740 008c 77EEA67A 		vadd.f32	s15, s15, s13
 211:Src/foc.c     ****     result.ccrb = U7.b * t3 + u1.b * t1 + u2.b * t2;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 26


 741              		.loc 1 211 17 view .LVU189
 742 0090 CDED097A 		vstr.32	s15, [sp, #36]
 212:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 743              		.loc 1 212 5 is_stmt 1 view .LVU190
 212:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 744              		.loc 1 212 21 is_stmt 0 view .LVU191
 745 0094 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
 746 0096 07EE903A 		vmov	s15, r3	@ int
 212:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 747              		.loc 1 212 24 view .LVU192
 748 009a F8EEE77A 		vcvt.f32.s32	s15, s15
 749 009e 67EE877A 		vmul.f32	s15, s15, s14
 212:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 750              		.loc 1 212 33 view .LVU193
 751 00a2 9DF81230 		ldrb	r3, [sp, #18]	@ zero_extendqisi2
 752 00a6 07EE103A 		vmov	s14, r3	@ int
 753              	.LVL45:
 212:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 754              		.loc 1 212 36 view .LVU194
 755 00aa B8EEC77A 		vcvt.f32.s32	s14, s14
 756 00ae 27EE000A 		vmul.f32	s0, s14, s0
 757              	.LVL46:
 212:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 758              		.loc 1 212 29 view .LVU195
 759 00b2 37EE800A 		vadd.f32	s0, s15, s0
 212:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 760              		.loc 1 212 45 view .LVU196
 761 00b6 9DF84230 		ldrb	r3, [sp, #66]	@ zero_extendqisi2
 762 00ba 07EE903A 		vmov	s15, r3	@ int
 212:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 763              		.loc 1 212 48 view .LVU197
 764 00be F8EEE77A 		vcvt.f32.s32	s15, s15
 765 00c2 67EEA00A 		vmul.f32	s1, s15, s1
 766              	.LVL47:
 212:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 767              		.loc 1 212 41 view .LVU198
 768 00c6 70EE200A 		vadd.f32	s1, s0, s1
 212:Src/foc.c     ****     result.ccrc = U7.c * t3 + u1.c * t1 + u2.c * t2;
 769              		.loc 1 212 17 view .LVU199
 770 00ca CDED0A0A 		vstr.32	s1, [sp, #40]
 214:Src/foc.c     ****     return result;
 771              		.loc 1 214 5 is_stmt 1 view .LVU200
 214:Src/foc.c     ****     return result;
 772              		.loc 1 214 12 is_stmt 0 view .LVU201
 773 00ce 08AB     		add	r3, sp, #32
 774 00d0 93E80700 		ldm	r3, {r0, r1, r2}
 775 00d4 0EAB     		add	r3, sp, #56
 776 00d6 03E90700 		stmdb	r3, {r0, r1, r2}
 215:Src/foc.c     **** }
 777              		.loc 1 215 1 view .LVU202
 778 00da 9DED0B0A 		vldr.32	s0, [sp, #44]
 779 00de DDED0C0A 		vldr.32	s1, [sp, #48]
 780 00e2 9DED0D1A 		vldr.32	s2, [sp, #52]
 781 00e6 0FB0     		add	sp, sp, #60
 782              	.LCFI14:
 783              		.cfi_def_cfa_offset 4
 784              		@ sp needed
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 27


 785 00e8 5DF8044B 		ldr	r4, [sp], #4
 786              	.LCFI15:
 787              		.cfi_restore 4
 788              		.cfi_def_cfa_offset 0
 789 00ec 7047     		bx	lr
 790              	.L41:
 791 00ee 00BF     		.align	2
 792              	.L40:
 793 00f0 00000000 		.word	.LANCHOR7
 794              		.cfi_endproc
 795              	.LFE171:
 797              		.section	.text.SVPWM_Step,"ax",%progbits
 798              		.align	1
 799              		.global	SVPWM_Step
 800              		.syntax unified
 801              		.thumb
 802              		.thumb_func
 803              		.fpu fpv4-sp-d16
 805              	SVPWM_Step:
 806              	.LFB172:
 218:Src/foc.c     **** {
 807              		.loc 1 218 1 is_stmt 1 view -0
 808              		.cfi_startproc
 809              		@ args = 0, pretend = 0, frame = 16
 810              		@ frame_needed = 0, uses_anonymous_args = 0
 811              		@ link register save eliminated.
 812 0000 84B0     		sub	sp, sp, #16
 813              	.LCFI16:
 814              		.cfi_def_cfa_offset 16
 815 0002 8DED010A 		vstr.32	s0, [sp, #4]
 816 0006 CDED020A 		vstr.32	s1, [sp, #8]
 817 000a 8DED031A 		vstr.32	s2, [sp, #12]
 219:Src/foc.c     ****     TIM8->CCR1 = duty.ccrc * TIM8->ARR;
 818              		.loc 1 219 5 view .LVU204
 219:Src/foc.c     ****     TIM8->CCR1 = duty.ccrc * TIM8->ARR;
 819              		.loc 1 219 34 is_stmt 0 view .LVU205
 820 000e 124B     		ldr	r3, .L44
 821 0010 D3ED0B7A 		vldr.32	s15, [r3, #44]	@ int
 219:Src/foc.c     ****     TIM8->CCR1 = duty.ccrc * TIM8->ARR;
 822              		.loc 1 219 28 view .LVU206
 823 0014 F8EE677A 		vcvt.f32.u32	s15, s15
 824 0018 27EE811A 		vmul.f32	s2, s15, s2
 219:Src/foc.c     ****     TIM8->CCR1 = duty.ccrc * TIM8->ARR;
 825              		.loc 1 219 16 view .LVU207
 826 001c BCEEC11A 		vcvt.u32.f32	s2, s2
 827 0020 83ED0D1A 		vstr.32	s2, [r3, #52]	@ int
 220:Src/foc.c     ****     TIM8->CCR2 = duty.ccrb * TIM8->ARR;
 828              		.loc 1 220 5 is_stmt 1 view .LVU208
 220:Src/foc.c     ****     TIM8->CCR2 = duty.ccrb * TIM8->ARR;
 829              		.loc 1 220 34 is_stmt 0 view .LVU209
 830 0024 D3ED0B7A 		vldr.32	s15, [r3, #44]	@ int
 220:Src/foc.c     ****     TIM8->CCR2 = duty.ccrb * TIM8->ARR;
 831              		.loc 1 220 28 view .LVU210
 832 0028 F8EE677A 		vcvt.f32.u32	s15, s15
 833 002c 9DED027A 		vldr.32	s14, [sp, #8]
 834 0030 67EE877A 		vmul.f32	s15, s15, s14
 220:Src/foc.c     ****     TIM8->CCR2 = duty.ccrb * TIM8->ARR;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 28


 835              		.loc 1 220 16 view .LVU211
 836 0034 FCEEE77A 		vcvt.u32.f32	s15, s15
 837 0038 C3ED0E7A 		vstr.32	s15, [r3, #56]	@ int
 221:Src/foc.c     ****     TIM8->CCR3 = duty.ccra * TIM8->ARR;
 838              		.loc 1 221 5 is_stmt 1 view .LVU212
 221:Src/foc.c     ****     TIM8->CCR3 = duty.ccra * TIM8->ARR;
 839              		.loc 1 221 34 is_stmt 0 view .LVU213
 840 003c D3ED0B7A 		vldr.32	s15, [r3, #44]	@ int
 221:Src/foc.c     ****     TIM8->CCR3 = duty.ccra * TIM8->ARR;
 841              		.loc 1 221 28 view .LVU214
 842 0040 F8EE677A 		vcvt.f32.u32	s15, s15
 843 0044 9DED017A 		vldr.32	s14, [sp, #4]
 844 0048 67EE877A 		vmul.f32	s15, s15, s14
 221:Src/foc.c     ****     TIM8->CCR3 = duty.ccra * TIM8->ARR;
 845              		.loc 1 221 16 view .LVU215
 846 004c FCEEE77A 		vcvt.u32.f32	s15, s15
 847 0050 C3ED0F7A 		vstr.32	s15, [r3, #60]	@ int
 222:Src/foc.c     **** }
 848              		.loc 1 222 1 view .LVU216
 849 0054 04B0     		add	sp, sp, #16
 850              	.LCFI17:
 851              		.cfi_def_cfa_offset 0
 852              		@ sp needed
 853 0056 7047     		bx	lr
 854              	.L45:
 855              		.align	2
 856              	.L44:
 857 0058 00040140 		.word	1073808384
 858              		.cfi_endproc
 859              	.LFE172:
 861              		.global	__aeabi_f2d
 862              		.section	.rodata.Measure_R_MS_Handler.str1.4,"aMS",%progbits,1
 863              		.align	2
 864              	.LC0:
 865 0000 64757479 		.ascii	"duty:%f current1:%f  current2:%f\015\012\000"
 865      3A256620 
 865      63757272 
 865      656E7431 
 865      3A256620 
 866 0023 00       		.align	2
 867              	.LC1:
 868 0024 6572726F 		.ascii	"error! no enough time! %d \015\012\000"
 868      7221206E 
 868      6F20656E 
 868      6F756768 
 868      2074696D 
 869 0041 000000   		.align	2
 870              	.LC2:
 871 0044 63757272 		.ascii	"current_avg:%f cnt:%d \015\012\000"
 871      656E745F 
 871      6176673A 
 871      25662063 
 871      6E743A25 
 872              		.section	.text.Measure_R_MS_Handler,"ax",%progbits
 873              		.align	1
 874              		.syntax unified
 875              		.thumb
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 29


 876              		.thumb_func
 877              		.fpu fpv4-sp-d16
 879              	Measure_R_MS_Handler:
 880              	.LVL48:
 881              	.LFB183:
 454:Src/foc.c     **** {
 882              		.loc 1 454 1 is_stmt 1 view -0
 883              		.cfi_startproc
 884              		@ args = 0, pretend = 0, frame = 16
 885              		@ frame_needed = 0, uses_anonymous_args = 0
 454:Src/foc.c     **** {
 886              		.loc 1 454 1 is_stmt 0 view .LVU218
 887 0000 30B5     		push	{r4, r5, lr}
 888              	.LCFI18:
 889              		.cfi_def_cfa_offset 12
 890              		.cfi_offset 4, -12
 891              		.cfi_offset 5, -8
 892              		.cfi_offset 14, -4
 893 0002 2DED028B 		vpush.64	{d8}
 894              	.LCFI19:
 895              		.cfi_def_cfa_offset 20
 896              		.cfi_offset 80, -20
 897              		.cfi_offset 81, -16
 898 0006 89B0     		sub	sp, sp, #36
 899              	.LCFI20:
 900              		.cfi_def_cfa_offset 56
 901 0008 B0EE401A 		vmov.f32	s2, s0
 455:Src/foc.c     ****     CCR_Duty temp_duty = {0};
 902              		.loc 1 455 5 is_stmt 1 view .LVU219
 456:Src/foc.c     ****     static float current1 = 0;
 903              		.loc 1 456 5 view .LVU220
 457:Src/foc.c     ****     static float current2 = 0;
 904              		.loc 1 457 5 view .LVU221
 458:Src/foc.c     ****     float cur_avg = 0;
 905              		.loc 1 458 5 view .LVU222
 906              	.LVL49:
 459:Src/foc.c     ****     if (Measure_R_Info.time == 0)
 907              		.loc 1 459 5 view .LVU223
 459:Src/foc.c     ****     if (Measure_R_Info.time == 0)
 908              		.loc 1 459 23 is_stmt 0 view .LVU224
 909 000c 524B     		ldr	r3, .L55
 910 000e 1B68     		ldr	r3, [r3]
 459:Src/foc.c     ****     if (Measure_R_Info.time == 0)
 911              		.loc 1 459 8 view .LVU225
 912 0010 002B     		cmp	r3, #0
 913 0012 39D0     		beq	.L53
 474:Src/foc.c     ****     Measure_R_Info.time += 1;
 914              		.loc 1 474 5 is_stmt 1 view .LVU226
 474:Src/foc.c     ****     Measure_R_Info.time += 1;
 915              		.loc 1 474 25 is_stmt 0 view .LVU227
 916 0014 0133     		adds	r3, r3, #1
 917 0016 504A     		ldr	r2, .L55
 918 0018 1360     		str	r3, [r2]
 477:Src/foc.c     ****     current1 += ADC_RAW2_CURRENT(ADC_Values_Raw2[0]);
 919              		.loc 1 477 5 is_stmt 1 view .LVU228
 477:Src/foc.c     ****     current1 += ADC_RAW2_CURRENT(ADC_Values_Raw2[0]);
 920              		.loc 1 477 17 is_stmt 0 view .LVU229
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 30


 921 001a 504A     		ldr	r2, .L55+4
 922 001c 1188     		ldrh	r1, [r2]
 923 001e 07EE101A 		vmov	s14, r1	@ int
 924 0022 B8EEC77A 		vcvt.f32.s32	s14, s14
 925 0026 DFED4E5A 		vldr.32	s11, .L55+8
 926 002a 27EE257A 		vmul.f32	s14, s14, s11
 927 002e 9FED4D6A 		vldr.32	s12, .L55+12
 928 0032 27EE067A 		vmul.f32	s14, s14, s12
 929 0036 DFED4C6A 		vldr.32	s13, .L55+16
 930 003a C7EE267A 		vdiv.f32	s15, s14, s13
 931 003e 9FED4B7A 		vldr.32	s14, .L55+20
 932 0042 87EE878A 		vdiv.f32	s16, s15, s14
 477:Src/foc.c     ****     current1 += ADC_RAW2_CURRENT(ADC_Values_Raw2[0]);
 933              		.loc 1 477 14 view .LVU230
 934 0046 4A49     		ldr	r1, .L55+24
 935 0048 D1ED007A 		vldr.32	s15, [r1]
 936 004c 38EE278A 		vadd.f32	s16, s16, s15
 937 0050 81ED008A 		vstr.32	s16, [r1]
 478:Src/foc.c     ****     current2 += ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 938              		.loc 1 478 5 is_stmt 1 view .LVU231
 478:Src/foc.c     ****     current2 += ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 939              		.loc 1 478 17 is_stmt 0 view .LVU232
 940 0054 5288     		ldrh	r2, [r2, #2]
 941 0056 07EE902A 		vmov	s15, r2	@ int
 942 005a F8EEE77A 		vcvt.f32.s32	s15, s15
 943 005e 67EEA57A 		vmul.f32	s15, s15, s11
 944 0062 67EE867A 		vmul.f32	s15, s15, s12
 945 0066 87EEA66A 		vdiv.f32	s12, s15, s13
 946 006a C6EE078A 		vdiv.f32	s17, s12, s14
 478:Src/foc.c     ****     current2 += ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 947              		.loc 1 478 14 view .LVU233
 948 006e 414A     		ldr	r2, .L55+28
 949 0070 D2ED007A 		vldr.32	s15, [r2]
 950 0074 78EEA78A 		vadd.f32	s17, s17, s15
 951 0078 C2ED008A 		vstr.32	s17, [r2]
 480:Src/foc.c     ****     if (Measure_R_Info.time >= 3)
 952              		.loc 1 480 5 is_stmt 1 view .LVU234
 480:Src/foc.c     ****     if (Measure_R_Info.time >= 3)
 953              		.loc 1 480 8 is_stmt 0 view .LVU235
 954 007c 022B     		cmp	r3, #2
 955 007e 24D8     		bhi	.L54
 956              	.LVL50:
 957              	.L46:
 500:Src/foc.c     **** }
 958              		.loc 1 500 1 view .LVU236
 959 0080 09B0     		add	sp, sp, #36
 960              	.LCFI21:
 961              		.cfi_remember_state
 962              		.cfi_def_cfa_offset 20
 963              		@ sp needed
 964 0082 BDEC028B 		vldm	sp!, {d8}
 965              	.LCFI22:
 966              		.cfi_restore 80
 967              		.cfi_restore 81
 968              		.cfi_def_cfa_offset 12
 969 0086 30BD     		pop	{r4, r5, pc}
 970              	.LVL51:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 31


 971              	.L53:
 972              	.LCFI23:
 973              		.cfi_restore_state
 461:Src/foc.c     ****         Measure_R_Info.Used_Mos = &U5;
 974              		.loc 1 461 9 is_stmt 1 view .LVU237
 461:Src/foc.c     ****         Measure_R_Info.Used_Mos = &U5;
 975              		.loc 1 461 33 is_stmt 0 view .LVU238
 976 0088 334C     		ldr	r4, .L55
 977 008a 3B4B     		ldr	r3, .L55+32
 978 008c 6360     		str	r3, [r4, #4]
 462:Src/foc.c     ****         Measure_R_Info.USELESS_CNT = 2;
 979              		.loc 1 462 9 is_stmt 1 view .LVU239
 462:Src/foc.c     ****         Measure_R_Info.USELESS_CNT = 2;
 980              		.loc 1 462 36 is_stmt 0 view .LVU240
 981 008e 0222     		movs	r2, #2
 982 0090 E260     		str	r2, [r4, #12]
 463:Src/foc.c     ****         Measure_R_Info.CNT_MAX = 30;
 983              		.loc 1 463 9 is_stmt 1 view .LVU241
 463:Src/foc.c     ****         Measure_R_Info.CNT_MAX = 30;
 984              		.loc 1 463 32 is_stmt 0 view .LVU242
 985 0092 1E22     		movs	r2, #30
 986 0094 2261     		str	r2, [r4, #16]
 465:Src/foc.c     ****         temp_duty.ccra = Measure_R_Info.Used_Mos->a * duty; //011
 987              		.loc 1 465 9 is_stmt 1 view .LVU243
 465:Src/foc.c     ****         temp_duty.ccra = Measure_R_Info.Used_Mos->a * duty; //011
 988              		.loc 1 465 49 is_stmt 0 view .LVU244
 989 0096 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 990 0098 00EE102A 		vmov	s0, r2	@ int
 991              	.LVL52:
 465:Src/foc.c     ****         temp_duty.ccra = Measure_R_Info.Used_Mos->a * duty; //011
 992              		.loc 1 465 53 view .LVU245
 993 009c B8EEC00A 		vcvt.f32.s32	s0, s0
 466:Src/foc.c     ****         temp_duty.ccrb = Measure_R_Info.Used_Mos->b * duty;
 994              		.loc 1 466 9 is_stmt 1 view .LVU246
 466:Src/foc.c     ****         temp_duty.ccrb = Measure_R_Info.Used_Mos->b * duty;
 995              		.loc 1 466 49 is_stmt 0 view .LVU247
 996 00a0 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 997 00a2 00EE902A 		vmov	s1, r2	@ int
 466:Src/foc.c     ****         temp_duty.ccrb = Measure_R_Info.Used_Mos->b * duty;
 998              		.loc 1 466 53 view .LVU248
 999 00a6 F8EEE00A 		vcvt.f32.s32	s1, s1
 467:Src/foc.c     ****         temp_duty.ccrc = Measure_R_Info.Used_Mos->c * duty;
 1000              		.loc 1 467 9 is_stmt 1 view .LVU249
 467:Src/foc.c     ****         temp_duty.ccrc = Measure_R_Info.Used_Mos->c * duty;
 1001              		.loc 1 467 49 is_stmt 0 view .LVU250
 1002 00aa 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
 1003 00ac 07EE903A 		vmov	s15, r3	@ int
 467:Src/foc.c     ****         temp_duty.ccrc = Measure_R_Info.Used_Mos->c * duty;
 1004              		.loc 1 467 53 view .LVU251
 1005 00b0 F8EEE77A 		vcvt.f32.s32	s15, s15
 468:Src/foc.c     ****         SVPWM_Step(temp_duty);
 1006              		.loc 1 468 9 is_stmt 1 view .LVU252
 1007 00b4 20EE010A 		vmul.f32	s0, s0, s2
 1008 00b8 60EE810A 		vmul.f32	s1, s1, s2
 1009 00bc 27EE811A 		vmul.f32	s2, s15, s2
 1010              	.LVL53:
 468:Src/foc.c     ****         SVPWM_Step(temp_duty);
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 32


 1011              		.loc 1 468 9 is_stmt 0 view .LVU253
 1012 00c0 FFF7FEFF 		bl	SVPWM_Step
 1013              	.LVL54:
 469:Src/foc.c     ****         Measure_R_Info.time = 1;
 1014              		.loc 1 469 9 is_stmt 1 view .LVU254
 469:Src/foc.c     ****         Measure_R_Info.time = 1;
 1015              		.loc 1 469 29 is_stmt 0 view .LVU255
 1016 00c4 0123     		movs	r3, #1
 1017 00c6 2360     		str	r3, [r4]
 471:Src/foc.c     ****         return;
 1018              		.loc 1 471 9 is_stmt 1 view .LVU256
 1019 00c8 DAE7     		b	.L46
 1020              	.LVL55:
 1021              	.L54:
 482:Src/foc.c     ****         uprintf_polling("duty:%f current1:%f  current2:%f\r\n", duty, current1, current2);
 1022              		.loc 1 482 9 view .LVU257
 1023 00ca 10EE100A 		vmov	r0, s0
 1024 00ce FFF7FEFF 		bl	__aeabi_f2d
 1025              	.LVL56:
 482:Src/foc.c     ****         uprintf_polling("duty:%f current1:%f  current2:%f\r\n", duty, current1, current2);
 1026              		.loc 1 482 9 is_stmt 0 view .LVU258
 1027 00d2 0446     		mov	r4, r0
 1028 00d4 0D46     		mov	r5, r1
 1029 00d6 18EE900A 		vmov	r0, s17
 1030 00da FFF7FEFF 		bl	__aeabi_f2d
 1031              	.LVL57:
 1032 00de CDE90201 		strd	r0, [sp, #8]
 1033 00e2 18EE100A 		vmov	r0, s16
 1034 00e6 FFF7FEFF 		bl	__aeabi_f2d
 1035              	.LVL58:
 1036 00ea CDE90001 		strd	r0, [sp]
 1037 00ee 2246     		mov	r2, r4
 1038 00f0 2B46     		mov	r3, r5
 1039 00f2 2248     		ldr	r0, .L55+36
 1040 00f4 FFF7FEFF 		bl	uprintf_polling
 1041              	.LVL59:
 483:Src/foc.c     ****         current1 = 0;
 1042              		.loc 1 483 9 is_stmt 1 view .LVU259
 483:Src/foc.c     ****         current1 = 0;
 1043              		.loc 1 483 18 is_stmt 0 view .LVU260
 1044 00f8 0023     		movs	r3, #0
 1045 00fa 1D4A     		ldr	r2, .L55+24
 1046 00fc 1360     		str	r3, [r2]	@ float
 484:Src/foc.c     ****         current2 = 0;
 1047              		.loc 1 484 9 is_stmt 1 view .LVU261
 484:Src/foc.c     ****         current2 = 0;
 1048              		.loc 1 484 18 is_stmt 0 view .LVU262
 1049 00fe 1D4A     		ldr	r2, .L55+28
 1050 0100 1360     		str	r3, [r2]	@ float
 485:Src/foc.c     ****         Board_Mode = STOP_MODE;
 1051              		.loc 1 485 9 is_stmt 1 view .LVU263
 485:Src/foc.c     ****         Board_Mode = STOP_MODE;
 1052              		.loc 1 485 20 is_stmt 0 view .LVU264
 1053 0102 0022     		movs	r2, #0
 1054 0104 1E4B     		ldr	r3, .L55+40
 1055 0106 1A70     		strb	r2, [r3]
 486:Src/foc.c     ****         Measure_R_Info.time = 0;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 33


 1056              		.loc 1 486 9 is_stmt 1 view .LVU265
 486:Src/foc.c     ****         Measure_R_Info.time = 0;
 1057              		.loc 1 486 29 is_stmt 0 view .LVU266
 1058 0108 134B     		ldr	r3, .L55
 1059 010a 1A60     		str	r2, [r3]
 488:Src/foc.c     ****         if (Measure_R_Info.cnt < Measure_R_Info.CNT_MAX)
 1060              		.loc 1 488 9 is_stmt 1 view .LVU267
 488:Src/foc.c     ****         if (Measure_R_Info.cnt < Measure_R_Info.CNT_MAX)
 1061              		.loc 1 488 27 is_stmt 0 view .LVU268
 1062 010c 9C68     		ldr	r4, [r3, #8]
 488:Src/foc.c     ****         if (Measure_R_Info.cnt < Measure_R_Info.CNT_MAX)
 1063              		.loc 1 488 48 view .LVU269
 1064 010e 1B69     		ldr	r3, [r3, #16]
 488:Src/foc.c     ****         if (Measure_R_Info.cnt < Measure_R_Info.CNT_MAX)
 1065              		.loc 1 488 12 view .LVU270
 1066 0110 9C42     		cmp	r4, r3
 1067 0112 09D2     		bcs	.L50
 490:Src/foc.c     ****             uprintf_polling("error! no enough time! %d \r\n", Measure_R_Info.cnt);
 1068              		.loc 1 490 13 is_stmt 1 view .LVU271
 1069 0114 2146     		mov	r1, r4
 1070 0116 1B48     		ldr	r0, .L55+44
 1071 0118 FFF7FEFF 		bl	uprintf_polling
 1072              	.LVL60:
 1073              	.L51:
 497:Src/foc.c     ****         Measure_R_Info.current_sum = 0;
 1074              		.loc 1 497 9 view .LVU272
 497:Src/foc.c     ****         Measure_R_Info.current_sum = 0;
 1075              		.loc 1 497 36 is_stmt 0 view .LVU273
 1076 011c 0E4B     		ldr	r3, .L55
 1077 011e 0022     		movs	r2, #0
 1078 0120 5A61     		str	r2, [r3, #20]	@ float
 498:Src/foc.c     ****         Measure_R_Info.cnt = 0;
 1079              		.loc 1 498 9 is_stmt 1 view .LVU274
 498:Src/foc.c     ****         Measure_R_Info.cnt = 0;
 1080              		.loc 1 498 28 is_stmt 0 view .LVU275
 1081 0122 0022     		movs	r2, #0
 1082 0124 9A60     		str	r2, [r3, #8]
 1083 0126 ABE7     		b	.L46
 1084              	.LVL61:
 1085              	.L50:
 494:Src/foc.c     ****             cur_avg = Measure_R_Info.current_sum / (Measure_R_Info.CNT_MAX - Measure_R_Info.USELESS
 1086              		.loc 1 494 13 is_stmt 1 view .LVU276
 494:Src/foc.c     ****             cur_avg = Measure_R_Info.current_sum / (Measure_R_Info.CNT_MAX - Measure_R_Info.USELESS
 1087              		.loc 1 494 37 is_stmt 0 view .LVU277
 1088 0128 0B4A     		ldr	r2, .L55
 1089 012a 92ED057A 		vldr.32	s14, [r2, #20]
 494:Src/foc.c     ****             cur_avg = Measure_R_Info.current_sum / (Measure_R_Info.CNT_MAX - Measure_R_Info.USELESS
 1090              		.loc 1 494 92 view .LVU278
 1091 012e D268     		ldr	r2, [r2, #12]
 494:Src/foc.c     ****             cur_avg = Measure_R_Info.current_sum / (Measure_R_Info.CNT_MAX - Measure_R_Info.USELESS
 1092              		.loc 1 494 76 view .LVU279
 1093 0130 9B1A     		subs	r3, r3, r2
 494:Src/foc.c     ****             cur_avg = Measure_R_Info.current_sum / (Measure_R_Info.CNT_MAX - Measure_R_Info.USELESS
 1094              		.loc 1 494 105 view .LVU280
 1095 0132 0133     		adds	r3, r3, #1
 494:Src/foc.c     ****             cur_avg = Measure_R_Info.current_sum / (Measure_R_Info.CNT_MAX - Measure_R_Info.USELESS
 1096              		.loc 1 494 50 view .LVU281
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 34


 1097 0134 07EE903A 		vmov	s15, r3	@ int
 1098 0138 F8EE677A 		vcvt.f32.u32	s15, s15
 1099              	.LVL62:
 495:Src/foc.c     ****             uprintf_polling("current_avg:%f cnt:%d \r\n", cur_avg, Measure_R_Info.cnt);
 1100              		.loc 1 495 13 is_stmt 1 view .LVU282
 1101 013c C7EE277A 		vdiv.f32	s15, s14, s15
 1102              	.LVL63:
 495:Src/foc.c     ****             uprintf_polling("current_avg:%f cnt:%d \r\n", cur_avg, Measure_R_Info.cnt);
 1103              		.loc 1 495 13 is_stmt 0 view .LVU283
 1104 0140 17EE900A 		vmov	r0, s15
 1105 0144 FFF7FEFF 		bl	__aeabi_f2d
 1106              	.LVL64:
 495:Src/foc.c     ****             uprintf_polling("current_avg:%f cnt:%d \r\n", cur_avg, Measure_R_Info.cnt);
 1107              		.loc 1 495 13 view .LVU284
 1108 0148 0246     		mov	r2, r0
 1109 014a 0B46     		mov	r3, r1
 1110 014c 0094     		str	r4, [sp]
 1111 014e 0E48     		ldr	r0, .L55+48
 1112 0150 FFF7FEFF 		bl	uprintf_polling
 1113              	.LVL65:
 1114 0154 E2E7     		b	.L51
 1115              	.L56:
 1116 0156 00BF     		.align	2
 1117              	.L55:
 1118 0158 00000000 		.word	Measure_R_Info
 1119 015c 00000000 		.word	ADC_Values_Raw2
 1120 0160 00404E45 		.word	1162756096
 1121 0164 00008039 		.word	964689920
 1122 0168 00004843 		.word	1128792064
 1123 016c A69B443B 		.word	994352038
 1124 0170 00000000 		.word	.LANCHOR8
 1125 0174 00000000 		.word	.LANCHOR9
 1126 0178 00000000 		.word	.LANCHOR1
 1127 017c 00000000 		.word	.LC0
 1128 0180 00000000 		.word	Board_Mode
 1129 0184 24000000 		.word	.LC1
 1130 0188 44000000 		.word	.LC2
 1131              		.cfi_endproc
 1132              	.LFE183:
 1134              		.section	.rodata.Set_to_U4.str1.4,"aMS",%progbits,1
 1135              		.align	2
 1136              	.LC3:
 1137 0000 706F7369 		.ascii	"position:%f \015\012\000"
 1137      74696F6E 
 1137      3A256620 
 1137      0D0A00
 1138              		.section	.text.Set_to_U4,"ax",%progbits
 1139              		.align	1
 1140              		.global	Set_to_U4
 1141              		.syntax unified
 1142              		.thumb
 1143              		.thumb_func
 1144              		.fpu fpv4-sp-d16
 1146              	Set_to_U4:
 1147              	.LVL66:
 1148              	.LFB173:
 228:Src/foc.c     **** {
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 35


 1149              		.loc 1 228 1 is_stmt 1 view -0
 1150              		.cfi_startproc
 1151              		@ args = 0, pretend = 0, frame = 16
 1152              		@ frame_needed = 0, uses_anonymous_args = 0
 228:Src/foc.c     **** {
 1153              		.loc 1 228 1 is_stmt 0 view .LVU286
 1154 0000 10B5     		push	{r4, lr}
 1155              	.LCFI24:
 1156              		.cfi_def_cfa_offset 8
 1157              		.cfi_offset 4, -8
 1158              		.cfi_offset 14, -4
 1159 0002 84B0     		sub	sp, sp, #16
 1160              	.LCFI25:
 1161              		.cfi_def_cfa_offset 24
 1162 0004 0446     		mov	r4, r0
 229:Src/foc.c     ****     CCR_Duty temp_duty = {0};
 1163              		.loc 1 229 5 is_stmt 1 view .LVU287
 230:Src/foc.c     ****     temp_duty.ccra = U4.a;
 1164              		.loc 1 230 5 view .LVU288
 230:Src/foc.c     ****     temp_duty.ccra = U4.a;
 1165              		.loc 1 230 24 is_stmt 0 view .LVU289
 1166 0006 194B     		ldr	r3, .L59
 1167 0008 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1168 000a 00EE102A 		vmov	s0, r2	@ int
 231:Src/foc.c     ****     temp_duty.ccrb = U4.b;
 1169              		.loc 1 231 5 is_stmt 1 view .LVU290
 231:Src/foc.c     ****     temp_duty.ccrb = U4.b;
 1170              		.loc 1 231 24 is_stmt 0 view .LVU291
 1171 000e 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 1172 0010 00EE902A 		vmov	s1, r2	@ int
 232:Src/foc.c     ****     temp_duty.ccrc = U4.c;
 1173              		.loc 1 232 5 is_stmt 1 view .LVU292
 232:Src/foc.c     ****     temp_duty.ccrc = U4.c;
 1174              		.loc 1 232 24 is_stmt 0 view .LVU293
 1175 0014 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
 1176 0016 01EE103A 		vmov	s2, r3	@ int
 233:Src/foc.c     ****     SVPWM_Step(temp_duty);
 1177              		.loc 1 233 5 is_stmt 1 view .LVU294
 1178 001a B8EE400A 		vcvt.f32.u32	s0, s0
 1179 001e F8EE600A 		vcvt.f32.u32	s1, s1
 1180 0022 B8EE411A 		vcvt.f32.u32	s2, s2
 1181 0026 FFF7FEFF 		bl	SVPWM_Step
 1182              	.LVL67:
 234:Src/foc.c     ****     HAL_Delay(t);
 1183              		.loc 1 234 5 view .LVU295
 1184 002a 2046     		mov	r0, r4
 1185 002c FFF7FEFF 		bl	HAL_Delay
 1186              	.LVL68:
 235:Src/foc.c     ****     temp_duty.ccra = U0.a;
 1187              		.loc 1 235 5 view .LVU296
 235:Src/foc.c     ****     temp_duty.ccra = U0.a;
 1188              		.loc 1 235 24 is_stmt 0 view .LVU297
 1189 0030 0F4B     		ldr	r3, .L59+4
 1190 0032 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1191 0034 00EE102A 		vmov	s0, r2	@ int
 236:Src/foc.c     ****     temp_duty.ccrb = U0.b;
 1192              		.loc 1 236 5 is_stmt 1 view .LVU298
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 36


 236:Src/foc.c     ****     temp_duty.ccrb = U0.b;
 1193              		.loc 1 236 24 is_stmt 0 view .LVU299
 1194 0038 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 1195 003a 00EE902A 		vmov	s1, r2	@ int
 237:Src/foc.c     ****     temp_duty.ccrc = U0.c;
 1196              		.loc 1 237 5 is_stmt 1 view .LVU300
 237:Src/foc.c     ****     temp_duty.ccrc = U0.c;
 1197              		.loc 1 237 24 is_stmt 0 view .LVU301
 1198 003e 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
 1199 0040 01EE103A 		vmov	s2, r3	@ int
 238:Src/foc.c     ****     SVPWM_Step(temp_duty);
 1200              		.loc 1 238 5 is_stmt 1 view .LVU302
 1201 0044 B8EE400A 		vcvt.f32.u32	s0, s0
 1202 0048 F8EE600A 		vcvt.f32.u32	s1, s1
 1203 004c B8EE411A 		vcvt.f32.u32	s2, s2
 1204 0050 FFF7FEFF 		bl	SVPWM_Step
 1205              	.LVL69:
 239:Src/foc.c     ****     uprintf("position:%f \r\n", Position_Degree);
 1206              		.loc 1 239 5 view .LVU303
 1207 0054 074B     		ldr	r3, .L59+8
 1208 0056 1868     		ldr	r0, [r3]	@ float
 1209 0058 FFF7FEFF 		bl	__aeabi_f2d
 1210              	.LVL70:
 1211 005c 0246     		mov	r2, r0
 1212 005e 0B46     		mov	r3, r1
 1213 0060 0548     		ldr	r0, .L59+12
 1214 0062 FFF7FEFF 		bl	uprintf
 1215              	.LVL71:
 240:Src/foc.c     **** }
 1216              		.loc 1 240 1 is_stmt 0 view .LVU304
 1217 0066 04B0     		add	sp, sp, #16
 1218              	.LCFI26:
 1219              		.cfi_def_cfa_offset 8
 1220              		@ sp needed
 1221 0068 10BD     		pop	{r4, pc}
 1222              	.L60:
 1223 006a 00BF     		.align	2
 1224              	.L59:
 1225 006c 00000000 		.word	.LANCHOR3
 1226 0070 00000000 		.word	.LANCHOR10
 1227 0074 00000000 		.word	Position_Degree
 1228 0078 00000000 		.word	.LC3
 1229              		.cfi_endproc
 1230              	.LFE173:
 1232              		.section	.text.SVPWM_Normal_CalT1T2,"ax",%progbits
 1233              		.align	1
 1234              		.global	SVPWM_Normal_CalT1T2
 1235              		.syntax unified
 1236              		.thumb
 1237              		.thumb_func
 1238              		.fpu fpv4-sp-d16
 1240              	SVPWM_Normal_CalT1T2:
 1241              	.LVL72:
 1242              	.LFB175:
 260:Src/foc.c     **** {
 1243              		.loc 1 260 1 is_stmt 1 view -0
 1244              		.cfi_startproc
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 37


 1245              		@ args = 0, pretend = 0, frame = 0
 1246              		@ frame_needed = 0, uses_anonymous_args = 0
 1247              		@ link register save eliminated.
 261:Src/foc.c     ****     float temp = 0;
 1248              		.loc 1 261 5 view .LVU306
 262:Src/foc.c     ****     switch (area)
 1249              		.loc 1 262 5 view .LVU307
 1250 0000 0138     		subs	r0, r0, #1
 1251              	.LVL73:
 262:Src/foc.c     ****     switch (area)
 1252              		.loc 1 262 5 is_stmt 0 view .LVU308
 1253 0002 0528     		cmp	r0, #5
 1254 0004 5BD8     		bhi	.L61
 1255 0006 DFE800F0 		tbb	[pc, r0]
 1256              	.L64:
 1257 000a 03       		.byte	(.L69-.L64)/2
 1258 000b 12       		.byte	(.L68-.L64)/2
 1259 000c 1F       		.byte	(.L67-.L64)/2
 1260 000d 30       		.byte	(.L66-.L64)/2
 1261 000e 3F       		.byte	(.L65-.L64)/2
 1262 000f 4C       		.byte	(.L63-.L64)/2
 1263              		.p2align 1
 1264              	.L69:
 265:Src/foc.c     ****         *t1 = alpha - 0.57735f * beta;
 1265              		.loc 1 265 9 is_stmt 1 view .LVU309
 265:Src/foc.c     ****         *t1 = alpha - 0.57735f * beta;
 1266              		.loc 1 265 32 is_stmt 0 view .LVU310
 1267 0010 DFED2B7A 		vldr.32	s15, .L70
 1268 0014 60EEA77A 		vmul.f32	s15, s1, s15
 265:Src/foc.c     ****         *t1 = alpha - 0.57735f * beta;
 1269              		.loc 1 265 21 view .LVU311
 1270 0018 30EE670A 		vsub.f32	s0, s0, s15
 1271              	.LVL74:
 265:Src/foc.c     ****         *t1 = alpha - 0.57735f * beta;
 1272              		.loc 1 265 13 view .LVU312
 1273 001c 81ED000A 		vstr.32	s0, [r1]
 266:Src/foc.c     ****         *t2 = 1.1547f * beta;
 1274              		.loc 1 266 9 is_stmt 1 view .LVU313
 266:Src/foc.c     ****         *t2 = 1.1547f * beta;
 1275              		.loc 1 266 23 is_stmt 0 view .LVU314
 1276 0020 DFED287A 		vldr.32	s15, .L70+4
 1277 0024 60EEA70A 		vmul.f32	s1, s1, s15
 1278              	.LVL75:
 266:Src/foc.c     ****         *t2 = 1.1547f * beta;
 1279              		.loc 1 266 13 view .LVU315
 1280 0028 C2ED000A 		vstr.32	s1, [r2]
 267:Src/foc.c     ****         break;
 1281              		.loc 1 267 9 is_stmt 1 view .LVU316
 1282 002c 7047     		bx	lr
 1283              	.LVL76:
 1284              	.L68:
 269:Src/foc.c     ****         *t1 = alpha + 0.57735f * beta;
 1285              		.loc 1 269 9 view .LVU317
 269:Src/foc.c     ****         *t1 = alpha + 0.57735f * beta;
 1286              		.loc 1 269 32 is_stmt 0 view .LVU318
 1287 002e DFED247A 		vldr.32	s15, .L70
 1288 0032 60EEA70A 		vmul.f32	s1, s1, s15
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 38


 1289              	.LVL77:
 269:Src/foc.c     ****         *t1 = alpha + 0.57735f * beta;
 1290              		.loc 1 269 21 view .LVU319
 1291 0036 70EE807A 		vadd.f32	s15, s1, s0
 269:Src/foc.c     ****         *t1 = alpha + 0.57735f * beta;
 1292              		.loc 1 269 13 view .LVU320
 1293 003a C1ED007A 		vstr.32	s15, [r1]
 270:Src/foc.c     ****         *t2 = 0.57735f * beta - alpha;
 1294              		.loc 1 270 9 is_stmt 1 view .LVU321
 270:Src/foc.c     ****         *t2 = 0.57735f * beta - alpha;
 1295              		.loc 1 270 31 is_stmt 0 view .LVU322
 1296 003e 70EEC00A 		vsub.f32	s1, s1, s0
 270:Src/foc.c     ****         *t2 = 0.57735f * beta - alpha;
 1297              		.loc 1 270 13 view .LVU323
 1298 0042 C2ED000A 		vstr.32	s1, [r2]
 271:Src/foc.c     ****         break;
 1299              		.loc 1 271 9 is_stmt 1 view .LVU324
 1300 0046 7047     		bx	lr
 1301              	.LVL78:
 1302              	.L67:
 273:Src/foc.c     ****         *t1 = 1.1547f * beta;
 1303              		.loc 1 273 9 view .LVU325
 273:Src/foc.c     ****         *t1 = 1.1547f * beta;
 1304              		.loc 1 273 23 is_stmt 0 view .LVU326
 1305 0048 DFED1E7A 		vldr.32	s15, .L70+4
 1306 004c 60EEA77A 		vmul.f32	s15, s1, s15
 273:Src/foc.c     ****         *t1 = 1.1547f * beta;
 1307              		.loc 1 273 13 view .LVU327
 1308 0050 C1ED007A 		vstr.32	s15, [r1]
 274:Src/foc.c     ****         *t2 = -alpha - 0.57735f * beta;
 1309              		.loc 1 274 9 is_stmt 1 view .LVU328
 274:Src/foc.c     ****         *t2 = -alpha - 0.57735f * beta;
 1310              		.loc 1 274 15 is_stmt 0 view .LVU329
 1311 0054 B1EE400A 		vneg.f32	s0, s0
 1312              	.LVL79:
 274:Src/foc.c     ****         *t2 = -alpha - 0.57735f * beta;
 1313              		.loc 1 274 33 view .LVU330
 1314 0058 DFED197A 		vldr.32	s15, .L70
 1315 005c 60EEA70A 		vmul.f32	s1, s1, s15
 1316              	.LVL80:
 274:Src/foc.c     ****         *t2 = -alpha - 0.57735f * beta;
 1317              		.loc 1 274 22 view .LVU331
 1318 0060 70EE600A 		vsub.f32	s1, s0, s1
 274:Src/foc.c     ****         *t2 = -alpha - 0.57735f * beta;
 1319              		.loc 1 274 13 view .LVU332
 1320 0064 C2ED000A 		vstr.32	s1, [r2]
 275:Src/foc.c     ****         break;
 1321              		.loc 1 275 9 is_stmt 1 view .LVU333
 1322 0068 7047     		bx	lr
 1323              	.LVL81:
 1324              	.L66:
 277:Src/foc.c     ****         *t1 = 0.57735f * beta - alpha;
 1325              		.loc 1 277 9 view .LVU334
 277:Src/foc.c     ****         *t1 = 0.57735f * beta - alpha;
 1326              		.loc 1 277 24 is_stmt 0 view .LVU335
 1327 006a DFED157A 		vldr.32	s15, .L70
 1328 006e 60EEA77A 		vmul.f32	s15, s1, s15
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 39


 277:Src/foc.c     ****         *t1 = 0.57735f * beta - alpha;
 1329              		.loc 1 277 31 view .LVU336
 1330 0072 37EEC00A 		vsub.f32	s0, s15, s0
 1331              	.LVL82:
 277:Src/foc.c     ****         *t1 = 0.57735f * beta - alpha;
 1332              		.loc 1 277 13 view .LVU337
 1333 0076 81ED000A 		vstr.32	s0, [r1]
 278:Src/foc.c     ****         *t2 = -1.1547f * beta;
 1334              		.loc 1 278 9 is_stmt 1 view .LVU338
 278:Src/foc.c     ****         *t2 = -1.1547f * beta;
 1335              		.loc 1 278 24 is_stmt 0 view .LVU339
 1336 007a DFED137A 		vldr.32	s15, .L70+8
 1337 007e 60EEA70A 		vmul.f32	s1, s1, s15
 1338              	.LVL83:
 278:Src/foc.c     ****         *t2 = -1.1547f * beta;
 1339              		.loc 1 278 13 view .LVU340
 1340 0082 C2ED000A 		vstr.32	s1, [r2]
 279:Src/foc.c     ****         break;
 1341              		.loc 1 279 9 is_stmt 1 view .LVU341
 1342 0086 7047     		bx	lr
 1343              	.LVL84:
 1344              	.L65:
 281:Src/foc.c     ****         temp = -0.57735f * beta;
 1345              		.loc 1 281 9 view .LVU342
 281:Src/foc.c     ****         temp = -0.57735f * beta;
 1346              		.loc 1 281 14 is_stmt 0 view .LVU343
 1347 0088 DFED107A 		vldr.32	s15, .L70+12
 1348 008c 60EEA70A 		vmul.f32	s1, s1, s15
 1349              	.LVL85:
 282:Src/foc.c     ****         *t1 = temp - alpha;
 1350              		.loc 1 282 9 is_stmt 1 view .LVU344
 282:Src/foc.c     ****         *t1 = temp - alpha;
 1351              		.loc 1 282 20 is_stmt 0 view .LVU345
 1352 0090 70EEC07A 		vsub.f32	s15, s1, s0
 282:Src/foc.c     ****         *t1 = temp - alpha;
 1353              		.loc 1 282 13 view .LVU346
 1354 0094 C1ED007A 		vstr.32	s15, [r1]
 283:Src/foc.c     ****         *t2 = temp + alpha;
 1355              		.loc 1 283 9 is_stmt 1 view .LVU347
 283:Src/foc.c     ****         *t2 = temp + alpha;
 1356              		.loc 1 283 20 is_stmt 0 view .LVU348
 1357 0098 70EE200A 		vadd.f32	s1, s0, s1
 1358              	.LVL86:
 283:Src/foc.c     ****         *t2 = temp + alpha;
 1359              		.loc 1 283 13 view .LVU349
 1360 009c C2ED000A 		vstr.32	s1, [r2]
 284:Src/foc.c     ****         break;
 1361              		.loc 1 284 9 is_stmt 1 view .LVU350
 1362 00a0 7047     		bx	lr
 1363              	.LVL87:
 1364              	.L63:
 286:Src/foc.c     ****         *t1 = -1.1547f * beta;
 1365              		.loc 1 286 9 view .LVU351
 286:Src/foc.c     ****         *t1 = -1.1547f * beta;
 1366              		.loc 1 286 24 is_stmt 0 view .LVU352
 1367 00a2 DFED097A 		vldr.32	s15, .L70+8
 1368 00a6 60EEA77A 		vmul.f32	s15, s1, s15
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 40


 286:Src/foc.c     ****         *t1 = -1.1547f * beta;
 1369              		.loc 1 286 13 view .LVU353
 1370 00aa C1ED007A 		vstr.32	s15, [r1]
 287:Src/foc.c     ****         *t2 = alpha + 0.57735f * beta;
 1371              		.loc 1 287 9 is_stmt 1 view .LVU354
 287:Src/foc.c     ****         *t2 = alpha + 0.57735f * beta;
 1372              		.loc 1 287 32 is_stmt 0 view .LVU355
 1373 00ae DFED047A 		vldr.32	s15, .L70
 1374 00b2 60EEA77A 		vmul.f32	s15, s1, s15
 287:Src/foc.c     ****         *t2 = alpha + 0.57735f * beta;
 1375              		.loc 1 287 21 view .LVU356
 1376 00b6 77EE800A 		vadd.f32	s1, s15, s0
 1377              	.LVL88:
 287:Src/foc.c     ****         *t2 = alpha + 0.57735f * beta;
 1378              		.loc 1 287 13 view .LVU357
 1379 00ba C2ED000A 		vstr.32	s1, [r2]
 288:Src/foc.c     ****         break;
 1380              		.loc 1 288 9 is_stmt 1 view .LVU358
 1381              	.L61:
 290:Src/foc.c     **** }
 1382              		.loc 1 290 1 is_stmt 0 view .LVU359
 1383 00be 7047     		bx	lr
 1384              	.L71:
 1385              		.align	2
 1386              	.L70:
 1387 00c0 36CD133F 		.word	1058262326
 1388 00c4 36CD933F 		.word	1066650934
 1389 00c8 36CD93BF 		.word	-1080832714
 1390 00cc 36CD13BF 		.word	-1089221322
 1391              		.cfi_endproc
 1392              	.LFE175:
 1394              		.section	.text.SVPWM,"ax",%progbits
 1395              		.align	1
 1396              		.syntax unified
 1397              		.thumb
 1398              		.thumb_func
 1399              		.fpu fpv4-sp-d16
 1401              	SVPWM:
 1402              	.LVL89:
 1403              	.LFB180:
 375:Src/foc.c     **** {
 1404              		.loc 1 375 1 is_stmt 1 view -0
 1405              		.cfi_startproc
 1406              		@ args = 0, pretend = 0, frame = 48
 1407              		@ frame_needed = 0, uses_anonymous_args = 0
 375:Src/foc.c     **** {
 1408              		.loc 1 375 1 is_stmt 0 view .LVU361
 1409 0000 70B5     		push	{r4, r5, r6, lr}
 1410              	.LCFI27:
 1411              		.cfi_def_cfa_offset 16
 1412              		.cfi_offset 4, -16
 1413              		.cfi_offset 5, -12
 1414              		.cfi_offset 6, -8
 1415              		.cfi_offset 14, -4
 1416 0002 2DED028B 		vpush.64	{d8}
 1417              	.LCFI28:
 1418              		.cfi_def_cfa_offset 24
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 41


 1419              		.cfi_offset 80, -24
 1420              		.cfi_offset 81, -20
 1421 0006 90B0     		sub	sp, sp, #64
 1422              	.LCFI29:
 1423              		.cfi_def_cfa_offset 88
 1424 0008 F0EE408A 		vmov.f32	s17, s0
 1425 000c B0EE608A 		vmov.f32	s16, s1
 376:Src/foc.c     ****     Uvect_Mos u1, u2;
 1426              		.loc 1 376 5 is_stmt 1 view .LVU362
 377:Src/foc.c     ****     float x, y;
 1427              		.loc 1 377 5 view .LVU363
 378:Src/foc.c     ****     float t1, t2;
 1428              		.loc 1 378 5 view .LVU364
 379:Src/foc.c     ****     static CCR_Duty CCR_Dutys = {0};
 1429              		.loc 1 379 5 view .LVU365
 381:Src/foc.c     ****     uint8_t area = get_area(Target_U);
 1430              		.loc 1 381 5 view .LVU366
 381:Src/foc.c     ****     uint8_t area = get_area(Target_U);
 1431              		.loc 1 381 20 is_stmt 0 view .LVU367
 1432 0010 FCEEC07A 		vcvt.u32.f32	s15, s0
 1433 0014 17EE900A 		vmov	r0, s15	@ int
 1434 0018 FFF7FEFF 		bl	get_area
 1435              	.LVL90:
 381:Src/foc.c     ****     uint8_t area = get_area(Target_U);
 1436              		.loc 1 381 20 view .LVU368
 1437 001c 0646     		mov	r6, r0
 1438              	.LVL91:
 382:Src/foc.c     ****     get_area_u(area, &u1, &u2);
 1439              		.loc 1 382 5 is_stmt 1 view .LVU369
 1440 001e 08AD     		add	r5, sp, #32
 1441 0020 0CAC     		add	r4, sp, #48
 1442 0022 2A46     		mov	r2, r5
 1443 0024 2146     		mov	r1, r4
 1444 0026 FFF7FEFF 		bl	get_area_u
 1445              	.LVL92:
 383:Src/foc.c     ****     arm_sin_cos_f32(Target_U, &y, &x);
 1446              		.loc 1 383 5 view .LVU370
 1447 002a 07A9     		add	r1, sp, #28
 1448 002c 06A8     		add	r0, sp, #24
 1449 002e B0EE680A 		vmov.f32	s0, s17
 1450 0032 FFF7FEFF 		bl	arm_sin_cos_f32
 1451              	.LVL93:
 384:Src/foc.c     ****     x *= 0.86f * duty;
 1452              		.loc 1 384 5 view .LVU371
 384:Src/foc.c     ****     x *= 0.86f * duty;
 1453              		.loc 1 384 16 is_stmt 0 view .LVU372
 1454 0036 DFED170A 		vldr.32	s1, .L74
 1455 003a 68EE200A 		vmul.f32	s1, s16, s1
 384:Src/foc.c     ****     x *= 0.86f * duty;
 1456              		.loc 1 384 7 view .LVU373
 1457 003e 9DED070A 		vldr.32	s0, [sp, #28]
 1458 0042 20EE800A 		vmul.f32	s0, s1, s0
 1459 0046 8DED070A 		vstr.32	s0, [sp, #28]
 385:Src/foc.c     ****     y *= 0.86f * duty; // sqrt(3)/2 Ê≤°Èîô
 1460              		.loc 1 385 5 is_stmt 1 view .LVU374
 385:Src/foc.c     ****     y *= 0.86f * duty; // sqrt(3)/2 Ê≤°Èîô
 1461              		.loc 1 385 7 is_stmt 0 view .LVU375
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 42


 1462 004a DDED067A 		vldr.32	s15, [sp, #24]
 1463 004e 60EEA70A 		vmul.f32	s1, s1, s15
 1464 0052 CDED060A 		vstr.32	s1, [sp, #24]
 386:Src/foc.c     ****     SVPWM_Normal_CalT1T2(x, y, area, &t1, &t2);
 1465              		.loc 1 386 5 is_stmt 1 view .LVU376
 1466 0056 04AA     		add	r2, sp, #16
 1467 0058 05A9     		add	r1, sp, #20
 1468 005a 3046     		mov	r0, r6
 1469 005c FFF7FEFF 		bl	SVPWM_Normal_CalT1T2
 1470              	.LVL94:
 387:Src/foc.c     ****     CCR_Dutys = get_ccr_duty(t1, t2, u1, u2);
 1471              		.loc 1 387 5 view .LVU377
 387:Src/foc.c     ****     CCR_Dutys = get_ccr_duty(t1, t2, u1, u2);
 1472              		.loc 1 387 17 is_stmt 0 view .LVU378
 1473 0060 95E80F00 		ldm	r5, {r0, r1, r2, r3}
 1474 0064 8DE80F00 		stm	sp, {r0, r1, r2, r3}
 1475 0068 94E80F00 		ldm	r4, {r0, r1, r2, r3}
 1476 006c DDED040A 		vldr.32	s1, [sp, #16]
 1477 0070 9DED050A 		vldr.32	s0, [sp, #20]
 1478 0074 FFF7FEFF 		bl	get_ccr_duty
 1479              	.LVL95:
 1480 0078 074B     		ldr	r3, .L74+4
 1481 007a 83ED000A 		vstr.32	s0, [r3]
 1482 007e C3ED010A 		vstr.32	s1, [r3, #4]
 1483 0082 83ED021A 		vstr.32	s2, [r3, #8]
 388:Src/foc.c     ****     SVPWM_Step(CCR_Dutys);
 1484              		.loc 1 388 5 is_stmt 1 view .LVU379
 1485 0086 FFF7FEFF 		bl	SVPWM_Step
 1486              	.LVL96:
 389:Src/foc.c     **** }
 1487              		.loc 1 389 1 is_stmt 0 view .LVU380
 1488 008a 10B0     		add	sp, sp, #64
 1489              	.LCFI30:
 1490              		.cfi_def_cfa_offset 24
 1491              		@ sp needed
 1492 008c BDEC028B 		vldm	sp!, {d8}
 1493              	.LCFI31:
 1494              		.cfi_restore 80
 1495              		.cfi_restore 81
 1496              		.cfi_def_cfa_offset 16
 1497              	.LVL97:
 389:Src/foc.c     **** }
 1498              		.loc 1 389 1 view .LVU381
 1499 0090 70BD     		pop	{r4, r5, r6, pc}
 1500              	.LVL98:
 1501              	.L75:
 389:Src/foc.c     **** }
 1502              		.loc 1 389 1 view .LVU382
 1503 0092 00BF     		.align	2
 1504              	.L74:
 1505 0094 F6285C3F 		.word	1063004406
 1506 0098 00000000 		.word	.LANCHOR11
 1507              		.cfi_endproc
 1508              	.LFE180:
 1510              		.section	.text.Park_Conv,"ax",%progbits
 1511              		.align	1
 1512              		.global	Park_Conv
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 43


 1513              		.syntax unified
 1514              		.thumb
 1515              		.thumb_func
 1516              		.fpu fpv4-sp-d16
 1518              	Park_Conv:
 1519              	.LVL99:
 1520              	.LFB177:
 324:Src/foc.c     **** {
 1521              		.loc 1 324 1 is_stmt 1 view -0
 1522              		.cfi_startproc
 1523              		@ args = 0, pretend = 0, frame = 0
 1524              		@ frame_needed = 0, uses_anonymous_args = 0
 1525              		@ link register save eliminated.
 325:Src/foc.c     ****     *ialpha = ia;
 1526              		.loc 1 325 5 view .LVU384
 325:Src/foc.c     ****     *ialpha = ia;
 1527              		.loc 1 325 13 is_stmt 0 view .LVU385
 1528 0000 80ED000A 		vstr.32	s0, [r0]
 326:Src/foc.c     ****     *ibeta = (sqrtf(3) * ib + sqrtf(3) * (ib + ia)) / 3.0f;
 1529              		.loc 1 326 5 is_stmt 1 view .LVU386
 326:Src/foc.c     ****     *ibeta = (sqrtf(3) * ib + sqrtf(3) * (ib + ia)) / 3.0f;
 1530              		.loc 1 326 24 is_stmt 0 view .LVU387
 1531 0004 9FED087A 		vldr.32	s14, .L77
 1532 0008 60EE877A 		vmul.f32	s15, s1, s14
 326:Src/foc.c     ****     *ibeta = (sqrtf(3) * ib + sqrtf(3) * (ib + ia)) / 3.0f;
 1533              		.loc 1 326 46 view .LVU388
 1534 000c 30EE200A 		vadd.f32	s0, s0, s1
 1535              	.LVL100:
 326:Src/foc.c     ****     *ibeta = (sqrtf(3) * ib + sqrtf(3) * (ib + ia)) / 3.0f;
 1536              		.loc 1 326 40 view .LVU389
 1537 0010 20EE070A 		vmul.f32	s0, s0, s14
 326:Src/foc.c     ****     *ibeta = (sqrtf(3) * ib + sqrtf(3) * (ib + ia)) / 3.0f;
 1538              		.loc 1 326 29 view .LVU390
 1539 0014 37EE800A 		vadd.f32	s0, s15, s0
 326:Src/foc.c     ****     *ibeta = (sqrtf(3) * ib + sqrtf(3) * (ib + ia)) / 3.0f;
 1540              		.loc 1 326 53 view .LVU391
 1541 0018 B0EE087A 		vmov.f32	s14, #3.0e+0
 1542 001c C0EE077A 		vdiv.f32	s15, s0, s14
 326:Src/foc.c     ****     *ibeta = (sqrtf(3) * ib + sqrtf(3) * (ib + ia)) / 3.0f;
 1543              		.loc 1 326 12 view .LVU392
 1544 0020 C1ED007A 		vstr.32	s15, [r1]
 1545              	.LVL101:
 327:Src/foc.c     **** }
 1546              		.loc 1 327 1 view .LVU393
 1547 0024 7047     		bx	lr
 1548              	.L78:
 1549 0026 00BF     		.align	2
 1550              	.L77:
 1551 0028 D7B3DD3F 		.word	1071494103
 1552              		.cfi_endproc
 1553              	.LFE177:
 1555              		.section	.text.HAL_ADC_ConvCpltCallback,"ax",%progbits
 1556              		.align	1
 1557              		.global	HAL_ADC_ConvCpltCallback
 1558              		.syntax unified
 1559              		.thumb
 1560              		.thumb_func
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 44


 1561              		.fpu fpv4-sp-d16
 1563              	HAL_ADC_ConvCpltCallback:
 1564              	.LVL102:
 1565              	.LFB178:
 330:Src/foc.c     **** {
 1566              		.loc 1 330 1 is_stmt 1 view -0
 1567              		.cfi_startproc
 1568              		@ args = 0, pretend = 0, frame = 0
 1569              		@ frame_needed = 0, uses_anonymous_args = 0
 330:Src/foc.c     **** {
 1570              		.loc 1 330 1 is_stmt 0 view .LVU395
 1571 0000 08B5     		push	{r3, lr}
 1572              	.LCFI32:
 1573              		.cfi_def_cfa_offset 8
 1574              		.cfi_offset 3, -8
 1575              		.cfi_offset 14, -4
 331:Src/foc.c     ****     float ia, ib;
 1576              		.loc 1 331 5 is_stmt 1 view .LVU396
 333:Src/foc.c     ****     if (hadc->Instance == ADC1)
 1577              		.loc 1 333 5 view .LVU397
 333:Src/foc.c     ****     if (hadc->Instance == ADC1)
 1578              		.loc 1 333 13 is_stmt 0 view .LVU398
 1579 0002 0368     		ldr	r3, [r0]
 333:Src/foc.c     ****     if (hadc->Instance == ADC1)
 1580              		.loc 1 333 8 view .LVU399
 1581 0004 1B4A     		ldr	r2, .L85
 1582 0006 9342     		cmp	r3, r2
 1583 0008 03D0     		beq	.L79
 336:Src/foc.c     ****     else if (hadc->Instance == ADC2)
 1584              		.loc 1 336 10 is_stmt 1 view .LVU400
 336:Src/foc.c     ****     else if (hadc->Instance == ADC2)
 1585              		.loc 1 336 13 is_stmt 0 view .LVU401
 1586 000a 02F58072 		add	r2, r2, #256
 1587 000e 9342     		cmp	r3, r2
 1588 0010 00D0     		beq	.L83
 1589              	.LVL103:
 1590              	.L79:
 346:Src/foc.c     **** }
 1591              		.loc 1 346 1 view .LVU402
 1592 0012 08BD     		pop	{r3, pc}
 1593              	.LVL104:
 1594              	.L83:
 338:Src/foc.c     ****         if (Board_Mode == SENSOR_FOC)
 1595              		.loc 1 338 9 is_stmt 1 view .LVU403
 338:Src/foc.c     ****         if (Board_Mode == SENSOR_FOC)
 1596              		.loc 1 338 24 is_stmt 0 view .LVU404
 1597 0014 184B     		ldr	r3, .L85+4
 1598 0016 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 338:Src/foc.c     ****         if (Board_Mode == SENSOR_FOC)
 1599              		.loc 1 338 12 view .LVU405
 1600 0018 022B     		cmp	r3, #2
 1601 001a 02D0     		beq	.L84
 1602              	.LVL105:
 1603              	.L81:
 344:Src/foc.c     ****         Measure_R_20Khz_Handler();
 1604              		.loc 1 344 9 is_stmt 1 view .LVU406
 1605 001c FFF7FEFF 		bl	Measure_R_20Khz_Handler
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 45


 1606              	.LVL106:
 346:Src/foc.c     **** }
 1607              		.loc 1 346 1 is_stmt 0 view .LVU407
 1608 0020 F7E7     		b	.L79
 1609              	.LVL107:
 1610              	.L84:
 340:Src/foc.c     ****             ia = ADC_RAW2_CURRENT(ADC_Values_Raw2[0]);
 1611              		.loc 1 340 13 is_stmt 1 view .LVU408
 340:Src/foc.c     ****             ia = ADC_RAW2_CURRENT(ADC_Values_Raw2[0]);
 1612              		.loc 1 340 18 is_stmt 0 view .LVU409
 1613 0022 164B     		ldr	r3, .L85+8
 1614 0024 1A88     		ldrh	r2, [r3]
 1615 0026 07EE102A 		vmov	s14, r2	@ int
 1616 002a B8EEC77A 		vcvt.f32.s32	s14, s14
 1617 002e DFED145A 		vldr.32	s11, .L85+12
 1618 0032 27EE257A 		vmul.f32	s14, s14, s11
 1619 0036 9FED136A 		vldr.32	s12, .L85+16
 1620 003a 27EE067A 		vmul.f32	s14, s14, s12
 1621 003e DFED126A 		vldr.32	s13, .L85+20
 1622 0042 87EE260A 		vdiv.f32	s0, s14, s13
 340:Src/foc.c     ****             ia = ADC_RAW2_CURRENT(ADC_Values_Raw2[0]);
 1623              		.loc 1 340 16 view .LVU410
 1624 0046 9FED117A 		vldr.32	s14, .L85+24
 1625              	.LVL108:
 341:Src/foc.c     ****             ib = ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 1626              		.loc 1 341 13 is_stmt 1 view .LVU411
 341:Src/foc.c     ****             ib = ADC_RAW2_CURRENT(ADC_Values_Raw2[1]);
 1627              		.loc 1 341 18 is_stmt 0 view .LVU412
 1628 004a 5B88     		ldrh	r3, [r3, #2]
 1629 004c 07EE903A 		vmov	s15, r3	@ int
 1630 0050 F8EEE77A 		vcvt.f32.s32	s15, s15
 1631 0054 67EEA57A 		vmul.f32	s15, s15, s11
 1632 0058 67EE867A 		vmul.f32	s15, s15, s12
 1633 005c C7EEA60A 		vdiv.f32	s1, s15, s13
 1634              	.LVL109:
 342:Src/foc.c     ****             Park_Conv(ia, ib, &Ialpha, &Ibeta);
 1635              		.loc 1 342 13 is_stmt 1 view .LVU413
 1636 0060 0B49     		ldr	r1, .L85+28
 1637 0062 0C48     		ldr	r0, .L85+32
 1638              	.LVL110:
 342:Src/foc.c     ****             Park_Conv(ia, ib, &Ialpha, &Ibeta);
 1639              		.loc 1 342 13 is_stmt 0 view .LVU414
 1640 0064 C0EE870A 		vdiv.f32	s1, s1, s14
 1641              	.LVL111:
 342:Src/foc.c     ****             Park_Conv(ia, ib, &Ialpha, &Ibeta);
 1642              		.loc 1 342 13 view .LVU415
 1643 0068 80EE070A 		vdiv.f32	s0, s0, s14
 1644              	.LVL112:
 342:Src/foc.c     ****             Park_Conv(ia, ib, &Ialpha, &Ibeta);
 1645              		.loc 1 342 13 view .LVU416
 1646 006c FFF7FEFF 		bl	Park_Conv
 1647              	.LVL113:
 342:Src/foc.c     ****             Park_Conv(ia, ib, &Ialpha, &Ibeta);
 1648              		.loc 1 342 13 view .LVU417
 1649 0070 D4E7     		b	.L81
 1650              	.L86:
 1651 0072 00BF     		.align	2
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 46


 1652              	.L85:
 1653 0074 00200140 		.word	1073815552
 1654 0078 00000000 		.word	Board_Mode
 1655 007c 00000000 		.word	ADC_Values_Raw2
 1656 0080 00404E45 		.word	1162756096
 1657 0084 00008039 		.word	964689920
 1658 0088 00004843 		.word	1128792064
 1659 008c A69B443B 		.word	994352038
 1660 0090 00000000 		.word	Ibeta
 1661 0094 00000000 		.word	Ialpha
 1662              		.cfi_endproc
 1663              	.LFE178:
 1665              		.section	.text.Foc,"ax",%progbits
 1666              		.align	1
 1667              		.global	Foc
 1668              		.syntax unified
 1669              		.thumb
 1670              		.thumb_func
 1671              		.fpu fpv4-sp-d16
 1673              	Foc:
 1674              	.LFB179:
 349:Src/foc.c     **** {
 1675              		.loc 1 349 1 is_stmt 1 view -0
 1676              		.cfi_startproc
 1677              		@ args = 0, pretend = 0, frame = 0
 1678              		@ frame_needed = 0, uses_anonymous_args = 0
 1679 0000 08B5     		push	{r3, lr}
 1680              	.LCFI33:
 1681              		.cfi_def_cfa_offset 8
 1682              		.cfi_offset 3, -8
 1683              		.cfi_offset 14, -4
 350:Src/foc.c     ****     Uvect_Mos u1, u2;
 1684              		.loc 1 350 5 view .LVU419
 351:Src/foc.c     ****     float t1, t2;
 1685              		.loc 1 351 5 view .LVU420
 352:Src/foc.c     ****     float x, y;
 1686              		.loc 1 352 5 view .LVU421
 354:Src/foc.c     ****     float electric_position = (-1 * Position_Degree + 360);
 1687              		.loc 1 354 5 view .LVU422
 354:Src/foc.c     ****     float electric_position = (-1 * Position_Degree + 360);
 1688              		.loc 1 354 53 is_stmt 0 view .LVU423
 1689 0002 184B     		ldr	r3, .L91
 1690 0004 D3ED007A 		vldr.32	s15, [r3]
 354:Src/foc.c     ****     float electric_position = (-1 * Position_Degree + 360);
 1691              		.loc 1 354 11 view .LVU424
 1692 0008 9FED177A 		vldr.32	s14, .L91+4
 1693 000c 77EE677A 		vsub.f32	s15, s14, s15
 1694              	.LVL114:
 355:Src/foc.c     ****     float electric_position_offset = (-1 * Position_Offset + 360);
 1695              		.loc 1 355 5 is_stmt 1 view .LVU425
 355:Src/foc.c     ****     float electric_position_offset = (-1 * Position_Offset + 360);
 1696              		.loc 1 355 60 is_stmt 0 view .LVU426
 1697 0010 164B     		ldr	r3, .L91+8
 1698 0012 D3ED006A 		vldr.32	s13, [r3]
 355:Src/foc.c     ****     float electric_position_offset = (-1 * Position_Offset + 360);
 1699              		.loc 1 355 11 view .LVU427
 1700 0016 37EE667A 		vsub.f32	s14, s14, s13
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 47


 1701              	.LVL115:
 358:Src/foc.c     ****     int32_t sub = (int32_t)(electric_position - electric_position_offset);
 1702              		.loc 1 358 5 is_stmt 1 view .LVU428
 358:Src/foc.c     ****     int32_t sub = (int32_t)(electric_position - electric_position_offset);
 1703              		.loc 1 358 47 is_stmt 0 view .LVU429
 1704 001a 77EEC77A 		vsub.f32	s15, s15, s14
 1705              	.LVL116:
 358:Src/foc.c     ****     int32_t sub = (int32_t)(electric_position - electric_position_offset);
 1706              		.loc 1 358 13 view .LVU430
 1707 001e FDEEE77A 		vcvt.s32.f32	s15, s15
 1708 0022 17EE903A 		vmov	r3, s15	@ int
 1709              	.LVL117:
 360:Src/foc.c     ****     if (sub < 0)
 1710              		.loc 1 360 5 is_stmt 1 view .LVU431
 360:Src/foc.c     ****     if (sub < 0)
 1711              		.loc 1 360 8 is_stmt 0 view .LVU432
 1712 0026 002B     		cmp	r3, #0
 1713 0028 18DB     		blt	.L90
 1714              	.L88:
 364:Src/foc.c     ****     sub *= Motor.pairs;
 1715              		.loc 1 364 5 is_stmt 1 view .LVU433
 364:Src/foc.c     ****     sub *= Motor.pairs;
 1716              		.loc 1 364 17 is_stmt 0 view .LVU434
 1717 002a 114A     		ldr	r2, .L91+12
 1718 002c 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 364:Src/foc.c     ****     sub *= Motor.pairs;
 1719              		.loc 1 364 9 view .LVU435
 1720 002e 03FB02F3 		mul	r3, r3, r2
 1721              	.LVL118:
 365:Src/foc.c     ****     sub += 90;
 1722              		.loc 1 365 5 is_stmt 1 view .LVU436
 365:Src/foc.c     ****     sub += 90;
 1723              		.loc 1 365 9 is_stmt 0 view .LVU437
 1724 0032 5A33     		adds	r3, r3, #90
 1725              	.LVL119:
 367:Src/foc.c     ****     sub %= 360;
 1726              		.loc 1 367 5 is_stmt 1 view .LVU438
 367:Src/foc.c     ****     sub %= 360;
 1727              		.loc 1 367 9 is_stmt 0 view .LVU439
 1728 0034 0F4A     		ldr	r2, .L91+16
 1729 0036 82FB0312 		smull	r1, r2, r2, r3
 1730 003a D118     		adds	r1, r2, r3
 1731 003c DA17     		asrs	r2, r3, #31
 1732 003e C2EB2122 		rsb	r2, r2, r1, asr #8
 1733 0042 4FF4B471 		mov	r1, #360
 1734 0046 01FB1232 		mls	r2, r1, r2, r3
 1735              	.LVL120:
 369:Src/foc.c     ****     SVPWM(sub, 1);
 1736              		.loc 1 369 5 is_stmt 1 view .LVU440
 1737 004a F7EE000A 		vmov.f32	s1, #1.0e+0
 1738 004e 07EE902A 		vmov	s15, r2	@ int
 1739 0052 B8EEE70A 		vcvt.f32.s32	s0, s15
 1740 0056 FFF7FEFF 		bl	SVPWM
 1741              	.LVL121:
 370:Src/foc.c     **** }
 1742              		.loc 1 370 1 is_stmt 0 view .LVU441
 1743 005a 08BD     		pop	{r3, pc}
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 48


 1744              	.LVL122:
 1745              	.L90:
 362:Src/foc.c     ****         sub += 360;
 1746              		.loc 1 362 9 is_stmt 1 view .LVU442
 362:Src/foc.c     ****         sub += 360;
 1747              		.loc 1 362 13 is_stmt 0 view .LVU443
 1748 005c 03F5B473 		add	r3, r3, #360
 1749              	.LVL123:
 362:Src/foc.c     ****         sub += 360;
 1750              		.loc 1 362 13 view .LVU444
 1751 0060 E3E7     		b	.L88
 1752              	.L92:
 1753 0062 00BF     		.align	2
 1754              	.L91:
 1755 0064 00000000 		.word	Position_Degree
 1756 0068 0000B443 		.word	1135869952
 1757 006c 00000000 		.word	.LANCHOR12
 1758 0070 00000000 		.word	.LANCHOR13
 1759 0074 B7600BB6 		.word	-1240768329
 1760              		.cfi_endproc
 1761              	.LFE179:
 1763              		.section	.text.VF_Openloop_Control,"ax",%progbits
 1764              		.align	1
 1765              		.global	VF_Openloop_Control
 1766              		.syntax unified
 1767              		.thumb
 1768              		.thumb_func
 1769              		.fpu fpv4-sp-d16
 1771              	VF_Openloop_Control:
 1772              	.LVL124:
 1773              	.LFB181:
 392:Src/foc.c     **** {
 1774              		.loc 1 392 1 is_stmt 1 view -0
 1775              		.cfi_startproc
 1776              		@ args = 0, pretend = 0, frame = 0
 1777              		@ frame_needed = 0, uses_anonymous_args = 0
 392:Src/foc.c     **** {
 1778              		.loc 1 392 1 is_stmt 0 view .LVU446
 1779 0000 08B5     		push	{r3, lr}
 1780              	.LCFI34:
 1781              		.cfi_def_cfa_offset 8
 1782              		.cfi_offset 3, -8
 1783              		.cfi_offset 14, -4
 1784 0002 07EE100A 		vmov	s14, r0	@ int
 393:Src/foc.c     ****     static float theta = 0;
 1785              		.loc 1 393 5 is_stmt 1 view .LVU447
 394:Src/foc.c     ****     float delta_p = rps * Motor.pairs * 360.0f / freq; // ÊØèÊ¨°Ë∞ÉÁî®Êú¨ÂáΩÊï∞Ë¶ÅÂ¢ûÂä†ÁöÑÂÄº
 1786              		.loc 1 394 5 view .LVU448
 394:Src/foc.c     ****     float delta_p = rps * Motor.pairs * 360.0f / freq; // ÊØèÊ¨°Ë∞ÉÁî®Êú¨ÂáΩÊï∞Ë¶ÅÂ¢ûÂä†ÁöÑÂÄº
 1787              		.loc 1 394 32 is_stmt 0 view .LVU449
 1788 0006 1B4B     		ldr	r3, .L102
 1789 0008 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1790 000a 07EE903A 		vmov	s15, r3	@ int
 394:Src/foc.c     ****     float delta_p = rps * Motor.pairs * 360.0f / freq; // ÊØèÊ¨°Ë∞ÉÁî®Êú¨ÂáΩÊï∞Ë¶ÅÂ¢ûÂä†ÁöÑÂÄº
 1791              		.loc 1 394 25 view .LVU450
 1792 000e F8EEE77A 		vcvt.f32.s32	s15, s15
 1793 0012 27EE811A 		vmul.f32	s2, s15, s2
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 49


 1794              	.LVL125:
 394:Src/foc.c     ****     float delta_p = rps * Motor.pairs * 360.0f / freq; // ÊØèÊ¨°Ë∞ÉÁî®Êú¨ÂáΩÊï∞Ë¶ÅÂ¢ûÂä†ÁöÑÂÄº
 1795              		.loc 1 394 39 view .LVU451
 1796 0016 DFED186A 		vldr.32	s13, .L102+4
 1797 001a 21EE261A 		vmul.f32	s2, s2, s13
 394:Src/foc.c     ****     float delta_p = rps * Motor.pairs * 360.0f / freq; // ÊØèÊ¨°Ë∞ÉÁî®Êú¨ÂáΩÊï∞Ë¶ÅÂ¢ûÂä†ÁöÑÂÄº
 1798              		.loc 1 394 11 view .LVU452
 1799 001e 81EE206A 		vdiv.f32	s12, s2, s1
 1800              	.LVL126:
 396:Src/foc.c     ****     theta += direction * delta_p;
 1801              		.loc 1 396 5 is_stmt 1 view .LVU453
 396:Src/foc.c     ****     theta += direction * delta_p;
 1802              		.loc 1 396 24 is_stmt 0 view .LVU454
 1803 0022 F8EEC77A 		vcvt.f32.s32	s15, s14
 1804 0026 67EE867A 		vmul.f32	s15, s15, s12
 396:Src/foc.c     ****     theta += direction * delta_p;
 1805              		.loc 1 396 11 view .LVU455
 1806 002a 144B     		ldr	r3, .L102+8
 1807 002c 93ED007A 		vldr.32	s14, [r3]
 1808 0030 77EE877A 		vadd.f32	s15, s15, s14
 1809 0034 C3ED007A 		vstr.32	s15, [r3]
 397:Src/foc.c     ****     if (theta > 360)
 1810              		.loc 1 397 5 is_stmt 1 view .LVU456
 397:Src/foc.c     ****     if (theta > 360)
 1811              		.loc 1 397 8 is_stmt 0 view .LVU457
 1812 0038 F4EEE67A 		vcmpe.f32	s15, s13
 1813 003c F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1814 0040 0BDD     		ble	.L100
 399:Src/foc.c     ****         theta -= 360;
 1815              		.loc 1 399 9 is_stmt 1 view .LVU458
 399:Src/foc.c     ****         theta -= 360;
 1816              		.loc 1 399 15 is_stmt 0 view .LVU459
 1817 0042 77EEE67A 		vsub.f32	s15, s15, s13
 1818 0046 C3ED007A 		vstr.32	s15, [r3]
 1819              	.L96:
 405:Src/foc.c     ****     SVPWM(theta, duty);
 1820              		.loc 1 405 5 is_stmt 1 view .LVU460
 1821 004a F0EE400A 		vmov.f32	s1, s0
 1822              	.LVL127:
 405:Src/foc.c     ****     SVPWM(theta, duty);
 1823              		.loc 1 405 5 is_stmt 0 view .LVU461
 1824 004e 0B4B     		ldr	r3, .L102+8
 1825 0050 93ED000A 		vldr.32	s0, [r3]
 1826              	.LVL128:
 405:Src/foc.c     ****     SVPWM(theta, duty);
 1827              		.loc 1 405 5 view .LVU462
 1828 0054 FFF7FEFF 		bl	SVPWM
 1829              	.LVL129:
 406:Src/foc.c     **** }
 1830              		.loc 1 406 1 view .LVU463
 1831 0058 08BD     		pop	{r3, pc}
 1832              	.LVL130:
 1833              	.L100:
 401:Src/foc.c     ****     else if (theta < 0)
 1834              		.loc 1 401 10 is_stmt 1 view .LVU464
 401:Src/foc.c     ****     else if (theta < 0)
 1835              		.loc 1 401 13 is_stmt 0 view .LVU465
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 50


 1836 005a F5EEC07A 		vcmpe.f32	s15, #0
 1837 005e F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1838 0062 F2D5     		bpl	.L96
 403:Src/foc.c     ****         theta += 360;
 1839              		.loc 1 403 9 is_stmt 1 view .LVU466
 403:Src/foc.c     ****         theta += 360;
 1840              		.loc 1 403 15 is_stmt 0 view .LVU467
 1841 0064 9FED047A 		vldr.32	s14, .L102+4
 1842 0068 77EE877A 		vadd.f32	s15, s15, s14
 1843 006c 034B     		ldr	r3, .L102+8
 1844 006e C3ED007A 		vstr.32	s15, [r3]
 1845 0072 EAE7     		b	.L96
 1846              	.L103:
 1847              		.align	2
 1848              	.L102:
 1849 0074 00000000 		.word	.LANCHOR13
 1850 0078 0000B443 		.word	1135869952
 1851 007c 00000000 		.word	.LANCHOR14
 1852              		.cfi_endproc
 1853              	.LFE181:
 1855              		.section	.rodata.Test_Direction.str1.4,"aMS",%progbits,1
 1856              		.align	2
 1857              	.LC4:
 1858 0000 64697265 		.ascii	"direction result:%d\015\012\000"
 1858      6374696F 
 1858      6E207265 
 1858      73756C74 
 1858      3A25640D 
 1859 0016 0000     		.align	2
 1860              	.LC5:
 1861 0018 74686520 		.ascii	"the direction of the motor is postive!\015\012\000"
 1861      64697265 
 1861      6374696F 
 1861      6E206F66 
 1861      20746865 
 1862 0041 000000   		.align	2
 1863              	.LC6:
 1864 0044 74686520 		.ascii	"the direction of the motor is nagative!\015\012\000"
 1864      64697265 
 1864      6374696F 
 1864      6E206F66 
 1864      20746865 
 1865              		.section	.text.Test_Direction,"ax",%progbits
 1866              		.align	1
 1867              		.syntax unified
 1868              		.thumb
 1869              		.thumb_func
 1870              		.fpu fpv4-sp-d16
 1872              	Test_Direction:
 1873              	.LFB182:
 409:Src/foc.c     **** {
 1874              		.loc 1 409 1 is_stmt 1 view -0
 1875              		.cfi_startproc
 1876              		@ args = 0, pretend = 0, frame = 0
 1877              		@ frame_needed = 0, uses_anonymous_args = 0
 1878 0000 10B5     		push	{r4, lr}
 1879              	.LCFI35:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 51


 1880              		.cfi_def_cfa_offset 8
 1881              		.cfi_offset 4, -8
 1882              		.cfi_offset 14, -4
 410:Src/foc.c     ****     Test_Direction_Info.time += 1;
 1883              		.loc 1 410 5 view .LVU469
 410:Src/foc.c     ****     Test_Direction_Info.time += 1;
 1884              		.loc 1 410 30 is_stmt 0 view .LVU470
 1885 0002 224B     		ldr	r3, .L115
 1886 0004 1A68     		ldr	r2, [r3]
 1887 0006 0132     		adds	r2, r2, #1
 1888 0008 1A60     		str	r2, [r3]
 412:Src/foc.c     ****     if (Position_Degree > Test_Direction_Info.last_position)
 1889              		.loc 1 412 5 is_stmt 1 view .LVU471
 412:Src/foc.c     ****     if (Position_Degree > Test_Direction_Info.last_position)
 1890              		.loc 1 412 46 is_stmt 0 view .LVU472
 1891 000a 93ED017A 		vldr.32	s14, [r3, #4]
 412:Src/foc.c     ****     if (Position_Degree > Test_Direction_Info.last_position)
 1892              		.loc 1 412 25 view .LVU473
 1893 000e 204B     		ldr	r3, .L115+4
 1894 0010 D3ED007A 		vldr.32	s15, [r3]
 412:Src/foc.c     ****     if (Position_Degree > Test_Direction_Info.last_position)
 1895              		.loc 1 412 8 view .LVU474
 1896 0014 B4EEE77A 		vcmpe.f32	s14, s15
 1897 0018 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1898 001c 15D5     		bpl	.L112
 414:Src/foc.c     ****         Test_Direction_Info.direction_result += 1;
 1899              		.loc 1 414 9 is_stmt 1 view .LVU475
 414:Src/foc.c     ****         Test_Direction_Info.direction_result += 1;
 1900              		.loc 1 414 46 is_stmt 0 view .LVU476
 1901 001e 1B4A     		ldr	r2, .L115
 1902 0020 9368     		ldr	r3, [r2, #8]
 1903 0022 0133     		adds	r3, r3, #1
 1904 0024 9360     		str	r3, [r2, #8]
 1905              	.L107:
 420:Src/foc.c     ****     Test_Direction_Info.last_position = Position_Degree;
 1906              		.loc 1 420 5 is_stmt 1 view .LVU477
 420:Src/foc.c     ****     Test_Direction_Info.last_position = Position_Degree;
 1907              		.loc 1 420 39 is_stmt 0 view .LVU478
 1908 0026 194C     		ldr	r4, .L115
 1909 0028 C4ED017A 		vstr.32	s15, [r4, #4]
 422:Src/foc.c     ****     VF_Openloop_Control(1, 1000, 1, 1);
 1910              		.loc 1 422 5 is_stmt 1 view .LVU479
 1911 002c B7EE001A 		vmov.f32	s2, #1.0e+0
 1912 0030 0120     		movs	r0, #1
 1913 0032 DFED180A 		vldr.32	s1, .L115+8
 1914 0036 B0EE410A 		vmov.f32	s0, s2
 1915 003a FFF7FEFF 		bl	VF_Openloop_Control
 1916              	.LVL131:
 424:Src/foc.c     ****     if (Test_Direction_Info.time > 10000)
 1917              		.loc 1 424 5 view .LVU480
 424:Src/foc.c     ****     if (Test_Direction_Info.time > 10000)
 1918              		.loc 1 424 28 is_stmt 0 view .LVU481
 1919 003e 2268     		ldr	r2, [r4]
 424:Src/foc.c     ****     if (Test_Direction_Info.time > 10000)
 1920              		.loc 1 424 8 view .LVU482
 1921 0040 42F21073 		movw	r3, #10000
 1922 0044 9A42     		cmp	r2, r3
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 52


 1923 0046 05D8     		bhi	.L114
 1924              	.L104:
 441:Src/foc.c     **** }
 1925              		.loc 1 441 1 view .LVU483
 1926 0048 10BD     		pop	{r4, pc}
 1927              	.L112:
 418:Src/foc.c     ****         Test_Direction_Info.direction_result -= 1;
 1928              		.loc 1 418 9 is_stmt 1 view .LVU484
 418:Src/foc.c     ****         Test_Direction_Info.direction_result -= 1;
 1929              		.loc 1 418 46 is_stmt 0 view .LVU485
 1930 004a 104A     		ldr	r2, .L115
 1931 004c 9368     		ldr	r3, [r2, #8]
 1932 004e 013B     		subs	r3, r3, #1
 1933 0050 9360     		str	r3, [r2, #8]
 1934 0052 E8E7     		b	.L107
 1935              	.L114:
 426:Src/foc.c     ****         Board_Mode = STOP_MODE;
 1936              		.loc 1 426 9 is_stmt 1 view .LVU486
 426:Src/foc.c     ****         Board_Mode = STOP_MODE;
 1937              		.loc 1 426 20 is_stmt 0 view .LVU487
 1938 0054 0023     		movs	r3, #0
 1939 0056 104A     		ldr	r2, .L115+12
 1940 0058 1370     		strb	r3, [r2]
 427:Src/foc.c     ****         Test_Direction_Info.time = 0;
 1941              		.loc 1 427 9 is_stmt 1 view .LVU488
 427:Src/foc.c     ****         Test_Direction_Info.time = 0;
 1942              		.loc 1 427 34 is_stmt 0 view .LVU489
 1943 005a 2360     		str	r3, [r4]
 428:Src/foc.c     ****         uprintf_polling("direction result:%d\r\n", Test_Direction_Info.direction_result);
 1944              		.loc 1 428 9 is_stmt 1 view .LVU490
 1945 005c A168     		ldr	r1, [r4, #8]
 1946 005e 0F48     		ldr	r0, .L115+16
 1947 0060 FFF7FEFF 		bl	uprintf_polling
 1948              	.LVL132:
 429:Src/foc.c     ****         if (Test_Direction_Info.direction_result > 0)
 1949              		.loc 1 429 9 view .LVU491
 429:Src/foc.c     ****         if (Test_Direction_Info.direction_result > 0)
 1950              		.loc 1 429 32 is_stmt 0 view .LVU492
 1951 0064 A368     		ldr	r3, [r4, #8]
 429:Src/foc.c     ****         if (Test_Direction_Info.direction_result > 0)
 1952              		.loc 1 429 12 view .LVU493
 1953 0066 002B     		cmp	r3, #0
 1954 0068 09DD     		ble	.L109
 431:Src/foc.c     ****             uprintf_polling("the direction of the motor is postive!\r\n");
 1955              		.loc 1 431 13 is_stmt 1 view .LVU494
 1956 006a 0D48     		ldr	r0, .L115+20
 1957 006c FFF7FEFF 		bl	uprintf_polling
 1958              	.LVL133:
 432:Src/foc.c     ****             Motor.direction = 1;
 1959              		.loc 1 432 13 view .LVU495
 432:Src/foc.c     ****             Motor.direction = 1;
 1960              		.loc 1 432 29 is_stmt 0 view .LVU496
 1961 0070 0C4B     		ldr	r3, .L115+24
 1962 0072 0122     		movs	r2, #1
 1963 0074 1A73     		strb	r2, [r3, #12]
 1964              	.L110:
 439:Src/foc.c     ****         Test_Direction_Info.direction_result = 0;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 53


 1965              		.loc 1 439 9 is_stmt 1 view .LVU497
 439:Src/foc.c     ****         Test_Direction_Info.direction_result = 0;
 1966              		.loc 1 439 46 is_stmt 0 view .LVU498
 1967 0076 054B     		ldr	r3, .L115
 1968 0078 0022     		movs	r2, #0
 1969 007a 9A60     		str	r2, [r3, #8]
 441:Src/foc.c     **** }
 1970              		.loc 1 441 1 view .LVU499
 1971 007c E4E7     		b	.L104
 1972              	.L109:
 436:Src/foc.c     ****             uprintf_polling("the direction of the motor is nagative!\r\n");
 1973              		.loc 1 436 13 is_stmt 1 view .LVU500
 1974 007e 0A48     		ldr	r0, .L115+28
 1975 0080 FFF7FEFF 		bl	uprintf_polling
 1976              	.LVL134:
 437:Src/foc.c     ****             Motor.direction = -1;
 1977              		.loc 1 437 13 view .LVU501
 437:Src/foc.c     ****             Motor.direction = -1;
 1978              		.loc 1 437 29 is_stmt 0 view .LVU502
 1979 0084 074B     		ldr	r3, .L115+24
 1980 0086 FF22     		movs	r2, #255
 1981 0088 1A73     		strb	r2, [r3, #12]
 1982 008a F4E7     		b	.L110
 1983              	.L116:
 1984              		.align	2
 1985              	.L115:
 1986 008c 00000000 		.word	Test_Direction_Info
 1987 0090 00000000 		.word	Position_Degree
 1988 0094 00007A44 		.word	1148846080
 1989 0098 00000000 		.word	Board_Mode
 1990 009c 00000000 		.word	.LC4
 1991 00a0 18000000 		.word	.LC5
 1992 00a4 00000000 		.word	.LANCHOR13
 1993 00a8 44000000 		.word	.LC6
 1994              		.cfi_endproc
 1995              	.LFE182:
 1997              		.section	.text.Theta_Handler,"ax",%progbits
 1998              		.align	1
 1999              		.global	Theta_Handler
 2000              		.syntax unified
 2001              		.thumb
 2002              		.thumb_func
 2003              		.fpu fpv4-sp-d16
 2005              	Theta_Handler:
 2006              	.LFB176:
 293:Src/foc.c     **** {
 2007              		.loc 1 293 1 is_stmt 1 view -0
 2008              		.cfi_startproc
 2009              		@ args = 0, pretend = 0, frame = 0
 2010              		@ frame_needed = 0, uses_anonymous_args = 0
 2011 0000 08B5     		push	{r3, lr}
 2012              	.LCFI36:
 2013              		.cfi_def_cfa_offset 8
 2014              		.cfi_offset 3, -8
 2015              		.cfi_offset 14, -4
 295:Src/foc.c     ****     Position_Degree = Get_Position_Rad_Dgree(1);
 2016              		.loc 1 295 5 view .LVU504
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 54


 295:Src/foc.c     ****     Position_Degree = Get_Position_Rad_Dgree(1);
 2017              		.loc 1 295 23 is_stmt 0 view .LVU505
 2018 0002 0120     		movs	r0, #1
 2019 0004 FFF7FEFF 		bl	Get_Position_Rad_Dgree
 2020              	.LVL135:
 295:Src/foc.c     ****     Position_Degree = Get_Position_Rad_Dgree(1);
 2021              		.loc 1 295 21 view .LVU506
 2022 0008 154B     		ldr	r3, .L127
 2023 000a 83ED000A 		vstr.32	s0, [r3]
 296:Src/foc.c     ****     switch (Board_Mode)
 2024              		.loc 1 296 5 is_stmt 1 view .LVU507
 2025 000e 154B     		ldr	r3, .L127+4
 2026 0010 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2027 0012 052B     		cmp	r3, #5
 2028 0014 06D8     		bhi	.L118
 2029 0016 052B     		cmp	r3, #5
 2030 0018 0BD8     		bhi	.L117
 2031 001a DFE803F0 		tbb	[pc, r3]
 2032              	.L121:
 2033 001e 15       		.byte	(.L124-.L121)/2
 2034 001f 0A       		.byte	(.L117-.L121)/2
 2035 0020 08       		.byte	(.L123-.L121)/2
 2036 0021 0A       		.byte	(.L117-.L121)/2
 2037 0022 0B       		.byte	(.L122-.L121)/2
 2038 0023 1C       		.byte	(.L120-.L121)/2
 2039              		.p2align 1
 2040              	.L118:
 2041 0024 F12B     		cmp	r3, #241
 2042 0026 04D1     		bne	.L117
 305:Src/foc.c     ****         Test_Direction();
 2043              		.loc 1 305 9 view .LVU508
 2044 0028 FFF7FEFF 		bl	Test_Direction
 2045              	.LVL136:
 306:Src/foc.c     ****         break;
 2046              		.loc 1 306 9 view .LVU509
 2047 002c 01E0     		b	.L117
 2048              	.L123:
 299:Src/foc.c     ****         Foc();
 2049              		.loc 1 299 9 view .LVU510
 2050 002e FFF7FEFF 		bl	Foc
 2051              	.LVL137:
 300:Src/foc.c     ****         break;
 2052              		.loc 1 300 9 view .LVU511
 2053              	.L117:
 319:Src/foc.c     **** }
 2054              		.loc 1 319 1 is_stmt 0 view .LVU512
 2055 0032 08BD     		pop	{r3, pc}
 2056              	.L122:
 302:Src/foc.c     ****         VF_Openloop_Control(1, 1000, 1, 1);
 2057              		.loc 1 302 9 is_stmt 1 view .LVU513
 2058 0034 B7EE001A 		vmov.f32	s2, #1.0e+0
 2059 0038 0120     		movs	r0, #1
 2060 003a DFED0B0A 		vldr.32	s1, .L127+8
 2061 003e B0EE410A 		vmov.f32	s0, s2
 2062 0042 FFF7FEFF 		bl	VF_Openloop_Control
 2063              	.LVL138:
 303:Src/foc.c     ****         break;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 55


 2064              		.loc 1 303 9 view .LVU514
 2065 0046 F4E7     		b	.L117
 2066              	.L124:
 308:Src/foc.c     ****         SVPWM(0, 0);
 2067              		.loc 1 308 9 view .LVU515
 2068 0048 9FED080A 		vldr.32	s0, .L127+12
 2069 004c F0EE400A 		vmov.f32	s1, s0
 2070 0050 FFF7FEFF 		bl	SVPWM
 2071              	.LVL139:
 309:Src/foc.c     ****         break;
 2072              		.loc 1 309 9 view .LVU516
 2073 0054 EDE7     		b	.L117
 2074              	.L120:
 314:Src/foc.c     ****         Measure_R_MS_Handler(1);
 2075              		.loc 1 314 9 view .LVU517
 2076 0056 B7EE000A 		vmov.f32	s0, #1.0e+0
 2077 005a FFF7FEFF 		bl	Measure_R_MS_Handler
 2078              	.LVL140:
 315:Src/foc.c     ****         break;
 2079              		.loc 1 315 9 view .LVU518
 319:Src/foc.c     **** }
 2080              		.loc 1 319 1 is_stmt 0 view .LVU519
 2081 005e E8E7     		b	.L117
 2082              	.L128:
 2083              		.align	2
 2084              	.L127:
 2085 0060 00000000 		.word	Position_Degree
 2086 0064 00000000 		.word	Board_Mode
 2087 0068 00007A44 		.word	1148846080
 2088 006c 00000000 		.word	0
 2089              		.cfi_endproc
 2090              	.LFE176:
 2092              		.section	.text.HAL_TIM_PeriodElapsedCallback,"ax",%progbits
 2093              		.align	1
 2094              		.global	HAL_TIM_PeriodElapsedCallback
 2095              		.syntax unified
 2096              		.thumb
 2097              		.thumb_func
 2098              		.fpu fpv4-sp-d16
 2100              	HAL_TIM_PeriodElapsedCallback:
 2101              	.LVL141:
 2102              	.LFB174:
 244:Src/foc.c     **** {
 2103              		.loc 1 244 1 is_stmt 1 view -0
 2104              		.cfi_startproc
 2105              		@ args = 0, pretend = 0, frame = 0
 2106              		@ frame_needed = 0, uses_anonymous_args = 0
 244:Src/foc.c     **** {
 2107              		.loc 1 244 1 is_stmt 0 view .LVU521
 2108 0000 08B5     		push	{r3, lr}
 2109              	.LCFI37:
 2110              		.cfi_def_cfa_offset 8
 2111              		.cfi_offset 3, -8
 2112              		.cfi_offset 14, -4
 246:Src/foc.c     ****     if (htim->Instance == TIM7)
 2113              		.loc 1 246 5 is_stmt 1 view .LVU522
 246:Src/foc.c     ****     if (htim->Instance == TIM7)
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 56


 2114              		.loc 1 246 13 is_stmt 0 view .LVU523
 2115 0002 0268     		ldr	r2, [r0]
 246:Src/foc.c     ****     if (htim->Instance == TIM7)
 2116              		.loc 1 246 8 view .LVU524
 2117 0004 054B     		ldr	r3, .L133
 2118 0006 9A42     		cmp	r2, r3
 2119 0008 00D0     		beq	.L132
 2120              	.LVL142:
 2121              	.L129:
 257:Src/foc.c     **** }
 2122              		.loc 1 257 1 view .LVU525
 2123 000a 08BD     		pop	{r3, pc}
 2124              	.LVL143:
 2125              	.L132:
 248:Src/foc.c     ****         if (!Init_OK)
 2126              		.loc 1 248 9 is_stmt 1 view .LVU526
 248:Src/foc.c     ****         if (!Init_OK)
 2127              		.loc 1 248 13 is_stmt 0 view .LVU527
 2128 000c 044B     		ldr	r3, .L133+4
 2129 000e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 248:Src/foc.c     ****         if (!Init_OK)
 2130              		.loc 1 248 12 view .LVU528
 2131 0010 002B     		cmp	r3, #0
 2132 0012 FAD0     		beq	.L129
 252:Src/foc.c     ****         Theta_Handler();
 2133              		.loc 1 252 9 is_stmt 1 view .LVU529
 2134 0014 FFF7FEFF 		bl	Theta_Handler
 2135              	.LVL144:
 256:Src/foc.c     ****     }
 2136              		.loc 1 256 5 view .LVU530
 2137 0018 F7E7     		b	.L129
 2138              	.L134:
 2139 001a 00BF     		.align	2
 2140              	.L133:
 2141 001c 00140040 		.word	1073746944
 2142 0020 00000000 		.word	Init_OK
 2143              		.cfi_endproc
 2144              	.LFE174:
 2146              		.comm	Measure_R_Info,24,4
 2147              		.global	Position_Offset
 2148              		.comm	Position_Degree,4,4
 2149              		.global	RPS
 2150              		.global	Uvects
 2151              		.global	U7
 2152              		.global	U5
 2153              		.global	U1
 2154              		.global	U3
 2155              		.global	U2
 2156              		.global	U6
 2157              		.global	U4
 2158              		.global	U0
 2159              		.global	Motor
 2160              		.comm	Test_Direction_Info,12,4
 2161              		.comm	Board_Mode,1,1
 2162              		.comm	Ibeta,4,4
 2163              		.comm	Ialpha,4,4
 2164              		.comm	ADC_Values_Raw2,8,4
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 57


 2165              		.comm	ADC_Values_Raw,8,4
 2166              		.section	.bss.CCR_Dutys.12935,"aw",%nobits
 2167              		.align	2
 2168              		.set	.LANCHOR11,. + 0
 2171              	CCR_Dutys.12935:
 2172 0000 00000000 		.space	12
 2172      00000000 
 2172      00000000 
 2173              		.section	.bss.U0,"aw",%nobits
 2174              		.align	2
 2175              		.set	.LANCHOR10,. + 0
 2178              	U0:
 2179 0000 00000000 		.space	16
 2179      00000000 
 2179      00000000 
 2179      00000000 
 2180              		.section	.bss.current1.12959,"aw",%nobits
 2181              		.align	2
 2182              		.set	.LANCHOR8,. + 0
 2185              	current1.12959:
 2186 0000 00000000 		.space	4
 2187              		.section	.bss.current2.12960,"aw",%nobits
 2188              		.align	2
 2189              		.set	.LANCHOR9,. + 0
 2192              	current2.12960:
 2193 0000 00000000 		.space	4
 2194              		.section	.bss.theta.12943,"aw",%nobits
 2195              		.align	2
 2196              		.set	.LANCHOR14,. + 0
 2199              	theta.12943:
 2200 0000 00000000 		.space	4
 2201              		.section	.data.Motor,"aw"
 2202              		.align	2
 2203              		.set	.LANCHOR13,. + 0
 2206              	Motor:
 2207 0000 07       		.byte	7
 2208 0001 000000   		.space	3
 2209 0004 00000000 		.word	0
 2210 0008 00000000 		.word	0
 2211 000c 00000000 		.space	4
 2212              		.section	.data.Position_Offset,"aw"
 2213              		.align	2
 2214              		.set	.LANCHOR12,. + 0
 2217              	Position_Offset:
 2218 0000 20CB5743 		.word	1129827104
 2219              		.section	.data.RPS,"aw"
 2220              		.align	2
 2223              	RPS:
 2224 0000 0000C040 		.word	1086324736
 2225              		.section	.data.U1,"aw"
 2226              		.align	2
 2227              		.set	.LANCHOR6,. + 0
 2230              	U1:
 2231 0000 00       		.byte	0
 2232 0001 00       		.byte	0
 2233 0002 01       		.byte	1
 2234 0003 00       		.space	1
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 58


 2235 0004 920A8640 		.word	1082526354
 2236 0008 00000000 		.space	8
 2236      00000000 
 2237              		.section	.data.U2,"aw"
 2238              		.align	2
 2239              		.set	.LANCHOR5,. + 0
 2242              	U2:
 2243 0000 00       		.byte	0
 2244 0001 01       		.byte	1
 2245 0002 00       		.byte	0
 2246 0003 00       		.space	1
 2247 0004 920A0640 		.word	1074137746
 2248 0008 00000000 		.space	8
 2248      00000000 
 2249              		.section	.data.U3,"aw"
 2250              		.align	2
 2251              		.set	.LANCHOR0,. + 0
 2254              	U3:
 2255 0000 00       		.byte	0
 2256 0001 01       		.byte	1
 2257 0002 01       		.byte	1
 2258 0003 00       		.space	1
 2259 0004 DB0F4940 		.word	1078530011
 2260 0008 00000000 		.space	8
 2260      00000000 
 2261              		.section	.data.U4,"aw"
 2262              		.align	2
 2263              		.set	.LANCHOR3,. + 0
 2266              	U4:
 2267 0000 01       		.byte	1
 2268 0001 00       		.byte	0
 2269 0002 00       		.byte	0
 2270 0003 00       		.space	1
 2271 0004 00000000 		.word	0
 2272 0008 00000000 		.space	8
 2272      00000000 
 2273              		.section	.data.U5,"aw"
 2274              		.align	2
 2275              		.set	.LANCHOR1,. + 0
 2278              	U5:
 2279 0000 01       		.byte	1
 2280 0001 00       		.byte	0
 2281 0002 01       		.byte	1
 2282 0003 00       		.space	1
 2283 0004 368DA740 		.word	1084722486
 2284 0008 00000000 		.space	8
 2284      00000000 
 2285              		.section	.data.U6,"aw"
 2286              		.align	2
 2287              		.set	.LANCHOR4,. + 0
 2290              	U6:
 2291 0000 01       		.byte	1
 2292 0001 01       		.byte	1
 2293 0002 00       		.byte	0
 2294 0003 00       		.space	1
 2295 0004 920A863F 		.word	1065749138
 2296 0008 00000000 		.space	8
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 59


 2296      00000000 
 2297              		.section	.data.U7,"aw"
 2298              		.align	2
 2299              		.set	.LANCHOR7,. + 0
 2302              	U7:
 2303 0000 01       		.byte	1
 2304 0001 01       		.byte	1
 2305 0002 01       		.byte	1
 2306 0003 00       		.space	1
 2307 0004 00000000 		.word	0
 2308 0008 00000000 		.space	8
 2308      00000000 
 2309              		.section	.data.Uvects,"aw"
 2310              		.align	2
 2311              		.set	.LANCHOR2,. + 0
 2314              	Uvects:
 2315 0000 00000000 		.word	U1
 2316 0004 00000000 		.word	U2
 2317 0008 00000000 		.word	U3
 2318 000c 00000000 		.word	U4
 2319 0010 00000000 		.word	U5
 2320 0014 00000000 		.word	U6
 2321              		.text
 2322              	.Letext0:
 2323              		.file 2 "c:\\arm_gcc\\arm-none-eabi\\include\\machine\\_default_types.h"
 2324              		.file 3 "c:\\arm_gcc\\arm-none-eabi\\include\\sys\\_stdint.h"
 2325              		.file 4 "Inc/foc.h"
 2326              		.file 5 "Drivers/CMSIS/Include/core_cm4.h"
 2327              		.file 6 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/system_stm32f4xx.h"
 2328              		.file 7 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f405xx.h"
 2329              		.file 8 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f4xx.h"
 2330              		.file 9 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 2331              		.file 10 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 2332              		.file 11 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_adc.h"
 2333              		.file 12 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim.h"
 2334              		.file 13 "Inc/tim.h"
 2335              		.file 14 "c:\\arm_gcc\\arm-none-eabi\\include\\sys\\lock.h"
 2336              		.file 15 "c:\\arm_gcc\\arm-none-eabi\\include\\sys\\_types.h"
 2337              		.file 16 "c:\\arm_gcc\\lib\\gcc\\arm-none-eabi\\9.2.1\\include\\stddef.h"
 2338              		.file 17 "c:\\arm_gcc\\arm-none-eabi\\include\\sys\\reent.h"
 2339              		.file 18 "c:\\arm_gcc\\arm-none-eabi\\include\\math.h"
 2340              		.file 19 "Inc/adc.h"
 2341              		.file 20 "c:\\arm_gcc\\arm-none-eabi\\include\\stdlib.h"
 2342              		.file 21 "mylib/uart_ext.h"
 2343              		.file 22 "Drivers/CMSIS/Include/arm_math.h"
 2344              		.file 23 "mylib/as5047.h"
 2345              		.file 24 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal.h"
 2346              		.file 25 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim_ex.h"
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 60


DEFINED SYMBOLS
                            *ABS*:00000000 foc.c
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:18     .text.Measure_R_20Khz_Handler:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:25     .text.Measure_R_20Khz_Handler:00000000 Measure_R_20Khz_Handler
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:126    .text.Measure_R_20Khz_Handler:000000b0 $d
                            *COM*:00000001 Board_Mode
                            *COM*:00000018 Measure_R_Info
                            *COM*:00000008 ADC_Values_Raw2
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:139    .text.UVects_Init:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:145    .text.UVects_Init:00000000 UVects_Init
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:221    .text.UVects_Init:0000003c $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:226    .text.Foc_Init:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:233    .text.Foc_Init:00000000 Foc_Init
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:321    .text.Foc_Init:00000068 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:330    .text.get_area:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:337    .text.get_area:00000000 get_area
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:360    .text.get_area:00000010 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:365    .text.get_area_u:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:372    .text.get_area_u:00000000 get_area_u
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:396    .text.get_area_u:00000010 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:402    .text.get_area_u:00000016 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:514    .text.get_area_u:00000084 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:524    .text.get_t:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:531    .text.get_t:00000000 get_t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:649    .text.get_t:00000098 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:654    .text.get_ccr_duty:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:661    .text.get_ccr_duty:00000000 get_ccr_duty
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:793    .text.get_ccr_duty:000000f0 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:798    .text.SVPWM_Step:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:805    .text.SVPWM_Step:00000000 SVPWM_Step
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:857    .text.SVPWM_Step:00000058 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:863    .rodata.Measure_R_MS_Handler.str1.4:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:873    .text.Measure_R_MS_Handler:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:879    .text.Measure_R_MS_Handler:00000000 Measure_R_MS_Handler
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1118   .text.Measure_R_MS_Handler:00000158 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1135   .rodata.Set_to_U4.str1.4:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1139   .text.Set_to_U4:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1146   .text.Set_to_U4:00000000 Set_to_U4
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1225   .text.Set_to_U4:0000006c $d
                            *COM*:00000004 Position_Degree
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1233   .text.SVPWM_Normal_CalT1T2:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1240   .text.SVPWM_Normal_CalT1T2:00000000 SVPWM_Normal_CalT1T2
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1257   .text.SVPWM_Normal_CalT1T2:0000000a $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1263   .text.SVPWM_Normal_CalT1T2:00000010 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1387   .text.SVPWM_Normal_CalT1T2:000000c0 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1395   .text.SVPWM:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1401   .text.SVPWM:00000000 SVPWM
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1505   .text.SVPWM:00000094 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1511   .text.Park_Conv:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1518   .text.Park_Conv:00000000 Park_Conv
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1551   .text.Park_Conv:00000028 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1556   .text.HAL_ADC_ConvCpltCallback:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1563   .text.HAL_ADC_ConvCpltCallback:00000000 HAL_ADC_ConvCpltCallback
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1653   .text.HAL_ADC_ConvCpltCallback:00000074 $d
                            *COM*:00000004 Ibeta
                            *COM*:00000004 Ialpha
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1666   .text.Foc:00000000 $t
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 61


C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1673   .text.Foc:00000000 Foc
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1755   .text.Foc:00000064 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1764   .text.VF_Openloop_Control:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1771   .text.VF_Openloop_Control:00000000 VF_Openloop_Control
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1849   .text.VF_Openloop_Control:00000074 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1856   .rodata.Test_Direction.str1.4:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1866   .text.Test_Direction:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1872   .text.Test_Direction:00000000 Test_Direction
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1986   .text.Test_Direction:0000008c $d
                            *COM*:0000000c Test_Direction_Info
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:1998   .text.Theta_Handler:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2005   .text.Theta_Handler:00000000 Theta_Handler
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2033   .text.Theta_Handler:0000001e $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2039   .text.Theta_Handler:00000024 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2085   .text.Theta_Handler:00000060 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2093   .text.HAL_TIM_PeriodElapsedCallback:00000000 $t
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2100   .text.HAL_TIM_PeriodElapsedCallback:00000000 HAL_TIM_PeriodElapsedCallback
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2141   .text.HAL_TIM_PeriodElapsedCallback:0000001c $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2217   .data.Position_Offset:00000000 Position_Offset
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2223   .data.RPS:00000000 RPS
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2314   .data.Uvects:00000000 Uvects
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2302   .data.U7:00000000 U7
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2278   .data.U5:00000000 U5
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2230   .data.U1:00000000 U1
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2254   .data.U3:00000000 U3
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2242   .data.U2:00000000 U2
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2290   .data.U6:00000000 U6
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2266   .data.U4:00000000 U4
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2178   .bss.U0:00000000 U0
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2206   .data.Motor:00000000 Motor
                            *COM*:00000008 ADC_Values_Raw
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2167   .bss.CCR_Dutys.12935:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2171   .bss.CCR_Dutys.12935:00000000 CCR_Dutys.12935
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2174   .bss.U0:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2181   .bss.current1.12959:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2185   .bss.current1.12959:00000000 current1.12959
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2188   .bss.current2.12960:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2192   .bss.current2.12960:00000000 current2.12960
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2195   .bss.theta.12943:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2199   .bss.theta.12943:00000000 theta.12943
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2202   .data.Motor:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2213   .data.Position_Offset:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2220   .data.RPS:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2226   .data.U1:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2238   .data.U2:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2250   .data.U3:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2262   .data.U4:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2274   .data.U5:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2286   .data.U6:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2298   .data.U7:00000000 $d
C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s:2310   .data.Uvects:00000000 $d

UNDEFINED SYMBOLS
cosf
sinf
HAL_TIM_PWM_Start
HAL_TIMEx_PWMN_Start
ARM GAS  C:\Users\ncer\AppData\Local\Temp\cchaiZaP.s 			page 62


HAL_TIM_Base_Start_IT
HAL_TIM_Base_Start
htim8
htim7
arm_sin_cos_f32
__aeabi_f2d
uprintf_polling
HAL_Delay
uprintf
Get_Position_Rad_Dgree
Init_OK
