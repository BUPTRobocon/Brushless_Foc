ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"music_and_voice.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.Music_Init,"ax",%progbits
  18              		.align	1
  19              		.global	Music_Init
  20              		.arch armv7e-m
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	Music_Init:
  27              	.LVL0:
  28              	.LFB130:
  29              		.file 1 "mylib/music_and_voice.c"
   1:mylib/music_and_voice.c **** #include "music_and_voice.h"
   2:mylib/music_and_voice.c **** #include "foc.h"
   3:mylib/music_and_voice.c **** 
   4:mylib/music_and_voice.c **** extern Uvect_Mos U0,U4,U6;
   5:mylib/music_and_voice.c **** struct
   6:mylib/music_and_voice.c **** {
   7:mylib/music_and_voice.c ****     uint32_t ms_cnt;
   8:mylib/music_and_voice.c ****     uint32_t cnt;
   9:mylib/music_and_voice.c ****     uint32_t TIM_old_ARR;
  10:mylib/music_and_voice.c ****     float time;   // 一个音符持续的时间 range from 0-1
  11:mylib/music_and_voice.c ****     uint8_t stop;
  12:mylib/music_and_voice.c **** 
  13:mylib/music_and_voice.c ****     TIM_HandleTypeDef * USE_TIM;
  14:mylib/music_and_voice.c ****     uint32_t TIM_MAX_FREQ;
  15:mylib/music_and_voice.c ****     uint16_t BEAT_cnt;  // 节拍计数值
  16:mylib/music_and_voice.c ****     float DUTY;
  17:mylib/music_and_voice.c **** } Music_Info;
  18:mylib/music_and_voice.c **** 
  19:mylib/music_and_voice.c **** 
  20:mylib/music_and_voice.c **** typedef enum
  21:mylib/music_and_voice.c **** {
  22:mylib/music_and_voice.c ****     STOP_NOTE = 20000,
  23:mylib/music_and_voice.c ****     DO = 261,
  24:mylib/music_and_voice.c ****     RE = 293,
  25:mylib/music_and_voice.c ****     MI = 329,
  26:mylib/music_and_voice.c ****     FA = 349,
  27:mylib/music_and_voice.c ****     SOL = 392,
  28:mylib/music_and_voice.c ****     LA = 440,
  29:mylib/music_and_voice.c ****     SI = 493
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 2


  30:mylib/music_and_voice.c **** } MUSIC_FREQ;
  31:mylib/music_and_voice.c **** 
  32:mylib/music_and_voice.c **** MUSIC_FREQ Music_Freqs[8] = {STOP_NOTE, DO, RE, MI, FA, SOL, LA, SI};
  33:mylib/music_and_voice.c **** //uint16_t Music_Song[]={0x1803,0x1802,0x1801,0x806,0x1801,0x1802,0x1803,0x1805,0x1803,0x1802,0x180
  34:mylib/music_and_voice.c **** uint16_t Music_Song[] = {0x803, 0x803, 0x803, 0x802, 0x203, 0x802, 0x803, 0x802, 0x802, 0x3406, 0x3
  35:mylib/music_and_voice.c **** /*
  36:mylib/music_and_voice.c **** 3/,3/,3/,2/,3-,2/,3/,2/,2/,-6,-6/,-7/,1,2/,1/,-7
  37:mylib/music_and_voice.c **** */
  38:mylib/music_and_voice.c **** 
  39:mylib/music_and_voice.c **** void Music_Init(TIM_HandleTypeDef * tim,uint8_t beat_cnt_per_minute,float duty){
  30              		.loc 1 39 80 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		@ link register save eliminated.
  40:mylib/music_and_voice.c ****     Music_Info.USE_TIM=tim;
  35              		.loc 1 40 5 view .LVU1
  36              		.loc 1 40 23 is_stmt 0 view .LVU2
  37 0000 0E4B     		ldr	r3, .L4
  38 0002 5861     		str	r0, [r3, #20]
  41:mylib/music_and_voice.c ****     if(tim->Instance!=TIM1 && tim->Instance!=TIM8){
  39              		.loc 1 41 5 is_stmt 1 view .LVU3
  40              		.loc 1 41 11 is_stmt 0 view .LVU4
  41 0004 0368     		ldr	r3, [r0]
  42              		.loc 1 41 7 view .LVU5
  43 0006 0E4A     		ldr	r2, .L4+4
  44 0008 9342     		cmp	r3, r2
  45 000a 0AD0     		beq	.L2
  46              		.loc 1 41 28 discriminator 1 view .LVU6
  47 000c 02F58062 		add	r2, r2, #1024
  48 0010 9342     		cmp	r3, r2
  49 0012 06D0     		beq	.L2
  42:mylib/music_and_voice.c ****         Music_Info.TIM_MAX_FREQ=84000000;
  50              		.loc 1 42 9 is_stmt 1 view .LVU7
  51              		.loc 1 42 32 is_stmt 0 view .LVU8
  52 0014 094B     		ldr	r3, .L4
  53 0016 02F14542 		add	r2, r2, #-989855744
  54 001a 02F53942 		add	r2, r2, #47360
  55 001e 9A61     		str	r2, [r3, #24]
  56 0020 02E0     		b	.L3
  57              	.L2:
  43:mylib/music_and_voice.c ****     }else{
  44:mylib/music_and_voice.c ****         Music_Info.TIM_MAX_FREQ=168000000;
  58              		.loc 1 44 9 is_stmt 1 view .LVU9
  59              		.loc 1 44 32 is_stmt 0 view .LVU10
  60 0022 064B     		ldr	r3, .L4
  61 0024 074A     		ldr	r2, .L4+8
  62 0026 9A61     		str	r2, [r3, #24]
  63              	.L3:
  45:mylib/music_and_voice.c ****     }
  46:mylib/music_and_voice.c ****     Music_Info.BEAT_cnt=1000*60/beat_cnt_per_minute;
  64              		.loc 1 46 5 is_stmt 1 view .LVU11
  65              		.loc 1 46 32 is_stmt 0 view .LVU12
  66 0028 4EF66023 		movw	r3, #60000
  67 002c 93FBF1F1 		sdiv	r1, r3, r1
  68              	.LVL1:
  69              		.loc 1 46 24 view .LVU13
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 3


  70 0030 024B     		ldr	r3, .L4
  71 0032 9983     		strh	r1, [r3, #28]	@ movhi
  47:mylib/music_and_voice.c **** 
  48:mylib/music_and_voice.c ****     Music_Info.DUTY=duty;
  72              		.loc 1 48 5 is_stmt 1 view .LVU14
  73              		.loc 1 48 20 is_stmt 0 view .LVU15
  74 0034 83ED080A 		vstr.32	s0, [r3, #32]
  49:mylib/music_and_voice.c **** 
  50:mylib/music_and_voice.c **** }
  75              		.loc 1 50 1 view .LVU16
  76 0038 7047     		bx	lr
  77              	.L5:
  78 003a 00BF     		.align	2
  79              	.L4:
  80 003c 00000000 		.word	Music_Info
  81 0040 00000140 		.word	1073807360
  82 0044 007A030A 		.word	168000000
  83              		.cfi_endproc
  84              	.LFE130:
  86              		.section	.text.Music_Get_Note,"ax",%progbits
  87              		.align	1
  88              		.global	Music_Get_Note
  89              		.syntax unified
  90              		.thumb
  91              		.thumb_func
  92              		.fpu fpv4-sp-d16
  94              	Music_Get_Note:
  95              	.LVL2:
  96              	.LFB131:
  51:mylib/music_and_voice.c **** 
  52:mylib/music_and_voice.c **** #define HALF_NOTE_K 1.059f
  53:mylib/music_and_voice.c **** float Music_Get_Note(uint16_t num, float *time)
  54:mylib/music_and_voice.c **** {
  97              		.loc 1 54 1 is_stmt 1 view -0
  98              		.cfi_startproc
  99              		@ args = 0, pretend = 0, frame = 0
 100              		@ frame_needed = 0, uses_anonymous_args = 0
 101              		@ link register save eliminated.
 102              		.loc 1 54 1 is_stmt 0 view .LVU18
 103 0000 10B4     		push	{r4}
 104              	.LCFI0:
 105              		.cfi_def_cfa_offset 4
 106              		.cfi_offset 4, -4
  55:mylib/music_and_voice.c ****     uint8_t index = num & 0xFF;
 107              		.loc 1 55 5 is_stmt 1 view .LVU19
 108              		.loc 1 55 13 is_stmt 0 view .LVU20
 109 0002 C2B2     		uxtb	r2, r0
 110              	.LVL3:
  56:mylib/music_and_voice.c ****     MUSIC_FREQ note = Music_Freqs[index];
 111              		.loc 1 56 5 is_stmt 1 view .LVU21
 112              		.loc 1 56 16 is_stmt 0 view .LVU22
 113 0004 264B     		ldr	r3, .L21
 114 0006 33F81220 		ldrh	r2, [r3, r2, lsl #1]
 115              	.LVL4:
  57:mylib/music_and_voice.c **** 
  58:mylib/music_and_voice.c ****     float result = note;
 116              		.loc 1 58 5 is_stmt 1 view .LVU23
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 4


 117              		.loc 1 58 11 is_stmt 0 view .LVU24
 118 000a 07EE902A 		vmov	s15, r2	@ int
 119 000e B8EE670A 		vcvt.f32.u32	s0, s15
 120              	.LVL5:
  59:mylib/music_and_voice.c **** 
  60:mylib/music_and_voice.c ****     uint8_t t = (num & 0xF00) >> 8;
 121              		.loc 1 60 5 is_stmt 1 view .LVU25
 122              		.loc 1 60 13 is_stmt 0 view .LVU26
 123 0012 C0F30323 		ubfx	r3, r0, #8, #4
 124              	.LVL6:
  61:mylib/music_and_voice.c ****     uint8_t octave = (num & 0x3000) >> 12;
 125              		.loc 1 61 5 is_stmt 1 view .LVU27
 126              		.loc 1 61 13 is_stmt 0 view .LVU28
 127 0016 C0F30134 		ubfx	r4, r0, #12, #2
 128              	.LVL7:
  62:mylib/music_and_voice.c ****     uint8_t semitone = (num & 0xC000) >> 14;
 129              		.loc 1 62 5 is_stmt 1 view .LVU29
 130              		.loc 1 62 13 is_stmt 0 view .LVU30
 131 001a 800B     		lsrs	r0, r0, #14
 132              	.LVL8:
  63:mylib/music_and_voice.c ****     switch (t)
 133              		.loc 1 63 5 is_stmt 1 view .LVU31
 134 001c 013B     		subs	r3, r3, #1
 135              	.LVL9:
 136              		.loc 1 63 5 is_stmt 0 view .LVU32
 137 001e 0E2B     		cmp	r3, #14
 138 0020 0CD8     		bhi	.L7
 139 0022 DFE803F0 		tbb	[pc, r3]
 140              	.L9:
 141 0026 08       		.byte	(.L13-.L9)/2
 142 0027 16       		.byte	(.L12-.L9)/2
 143 0028 0B       		.byte	(.L7-.L9)/2
 144 0029 1A       		.byte	(.L11-.L9)/2
 145 002a 0B       		.byte	(.L7-.L9)/2
 146 002b 0B       		.byte	(.L7-.L9)/2
 147 002c 0B       		.byte	(.L7-.L9)/2
 148 002d 1E       		.byte	(.L10-.L9)/2
 149 002e 0B       		.byte	(.L7-.L9)/2
 150 002f 0B       		.byte	(.L7-.L9)/2
 151 0030 0B       		.byte	(.L7-.L9)/2
 152 0031 0B       		.byte	(.L7-.L9)/2
 153 0032 0B       		.byte	(.L7-.L9)/2
 154 0033 0B       		.byte	(.L7-.L9)/2
 155 0034 22       		.byte	(.L8-.L9)/2
 156 0035 00       		.p2align 1
 157              	.L13:
  64:mylib/music_and_voice.c ****     {
  65:mylib/music_and_voice.c ****     case 1:
  66:mylib/music_and_voice.c ****         *time = 4.0f;
 158              		.loc 1 66 9 is_stmt 1 view .LVU33
 159              		.loc 1 66 15 is_stmt 0 view .LVU34
 160 0036 4FF08143 		mov	r3, #1082130432
 161              	.LVL10:
 162              		.loc 1 66 15 view .LVU35
 163 003a 0B60     		str	r3, [r1]	@ float
  67:mylib/music_and_voice.c ****         break;
 164              		.loc 1 67 9 is_stmt 1 view .LVU36
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 5


 165              	.L7:
  68:mylib/music_and_voice.c ****     case 2:
  69:mylib/music_and_voice.c ****         *time = 2.0f;
  70:mylib/music_and_voice.c ****         break;
  71:mylib/music_and_voice.c ****     case 4:
  72:mylib/music_and_voice.c ****         *time = 1.0f;
  73:mylib/music_and_voice.c ****         break;
  74:mylib/music_and_voice.c ****     case 8:
  75:mylib/music_and_voice.c ****         *time = 0.5f;
  76:mylib/music_and_voice.c ****         break;
  77:mylib/music_and_voice.c ****     case 0xF:
  78:mylib/music_and_voice.c ****         *time = 0.25f;
  79:mylib/music_and_voice.c ****         break;
  80:mylib/music_and_voice.c **** 
  81:mylib/music_and_voice.c ****     default:
  82:mylib/music_and_voice.c ****         break;
  83:mylib/music_and_voice.c ****     }
  84:mylib/music_and_voice.c **** 
  85:mylib/music_and_voice.c ****     switch (octave)
 166              		.loc 1 85 5 view .LVU37
 167 003c 012C     		cmp	r4, #1
 168 003e 18D0     		beq	.L14
 169 0040 032C     		cmp	r4, #3
 170 0042 1CD0     		beq	.L15
 171              	.L16:
  86:mylib/music_and_voice.c ****     {
  87:mylib/music_and_voice.c ****     case 1:
  88:mylib/music_and_voice.c ****         result = note * 2;
  89:mylib/music_and_voice.c ****         break;
  90:mylib/music_and_voice.c ****     case 0:
  91:mylib/music_and_voice.c ****         result = note;
  92:mylib/music_and_voice.c ****         break;
  93:mylib/music_and_voice.c ****     case 3:
  94:mylib/music_and_voice.c ****         result = note / 2;
  95:mylib/music_and_voice.c ****         break;
  96:mylib/music_and_voice.c ****     }
  97:mylib/music_and_voice.c **** 
  98:mylib/music_and_voice.c ****     switch (semitone)
 172              		.loc 1 98 5 view .LVU38
 173 0044 0128     		cmp	r0, #1
 174 0046 20D0     		beq	.L17
 175              		.loc 1 98 5 is_stmt 0 view .LVU39
 176 0048 0328     		cmp	r0, #3
 177 004a 23D0     		beq	.L18
 178              	.L6:
  99:mylib/music_and_voice.c ****     {
 100:mylib/music_and_voice.c ****     case 1:
 101:mylib/music_and_voice.c ****         result *= HALF_NOTE_K;
 102:mylib/music_and_voice.c ****         break;
 103:mylib/music_and_voice.c ****     case 0:
 104:mylib/music_and_voice.c ****         break;
 105:mylib/music_and_voice.c ****     case 3:
 106:mylib/music_and_voice.c ****         result /= HALF_NOTE_K;
 107:mylib/music_and_voice.c ****         break;
 108:mylib/music_and_voice.c ****     }
 109:mylib/music_and_voice.c **** 
 110:mylib/music_and_voice.c ****     return result;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 6


 111:mylib/music_and_voice.c **** }
 179              		.loc 1 111 1 view .LVU40
 180 004c 5DF8044B 		ldr	r4, [sp], #4
 181              	.LCFI1:
 182              		.cfi_remember_state
 183              		.cfi_restore 4
 184              		.cfi_def_cfa_offset 0
 185              	.LVL11:
 186              		.loc 1 111 1 view .LVU41
 187 0050 7047     		bx	lr
 188              	.LVL12:
 189              	.L12:
 190              	.LCFI2:
 191              		.cfi_restore_state
  69:mylib/music_and_voice.c ****         break;
 192              		.loc 1 69 9 is_stmt 1 view .LVU42
  69:mylib/music_and_voice.c ****         break;
 193              		.loc 1 69 15 is_stmt 0 view .LVU43
 194 0052 4FF08043 		mov	r3, #1073741824
 195              	.LVL13:
  69:mylib/music_and_voice.c ****         break;
 196              		.loc 1 69 15 view .LVU44
 197 0056 0B60     		str	r3, [r1]	@ float
  70:mylib/music_and_voice.c ****     case 4:
 198              		.loc 1 70 9 is_stmt 1 view .LVU45
 199 0058 F0E7     		b	.L7
 200              	.LVL14:
 201              	.L11:
  72:mylib/music_and_voice.c ****         break;
 202              		.loc 1 72 9 view .LVU46
  72:mylib/music_and_voice.c ****         break;
 203              		.loc 1 72 15 is_stmt 0 view .LVU47
 204 005a 4FF07E53 		mov	r3, #1065353216
 205              	.LVL15:
  72:mylib/music_and_voice.c ****         break;
 206              		.loc 1 72 15 view .LVU48
 207 005e 0B60     		str	r3, [r1]	@ float
  73:mylib/music_and_voice.c ****     case 8:
 208              		.loc 1 73 9 is_stmt 1 view .LVU49
 209 0060 ECE7     		b	.L7
 210              	.LVL16:
 211              	.L10:
  75:mylib/music_and_voice.c ****         break;
 212              		.loc 1 75 9 view .LVU50
  75:mylib/music_and_voice.c ****         break;
 213              		.loc 1 75 15 is_stmt 0 view .LVU51
 214 0062 4FF07C53 		mov	r3, #1056964608
 215              	.LVL17:
  75:mylib/music_and_voice.c ****         break;
 216              		.loc 1 75 15 view .LVU52
 217 0066 0B60     		str	r3, [r1]	@ float
  76:mylib/music_and_voice.c ****     case 0xF:
 218              		.loc 1 76 9 is_stmt 1 view .LVU53
 219 0068 E8E7     		b	.L7
 220              	.LVL18:
 221              	.L8:
  78:mylib/music_and_voice.c ****         break;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 7


 222              		.loc 1 78 9 view .LVU54
  78:mylib/music_and_voice.c ****         break;
 223              		.loc 1 78 15 is_stmt 0 view .LVU55
 224 006a 4FF07A53 		mov	r3, #1048576000
 225              	.LVL19:
  78:mylib/music_and_voice.c ****         break;
 226              		.loc 1 78 15 view .LVU56
 227 006e 0B60     		str	r3, [r1]	@ float
  79:mylib/music_and_voice.c **** 
 228              		.loc 1 79 9 is_stmt 1 view .LVU57
 229 0070 E4E7     		b	.L7
 230              	.L14:
  88:mylib/music_and_voice.c ****         break;
 231              		.loc 1 88 9 view .LVU58
  88:mylib/music_and_voice.c ****         break;
 232              		.loc 1 88 23 is_stmt 0 view .LVU59
 233 0072 5300     		lsls	r3, r2, #1
 234 0074 00EE103A 		vmov	s0, r3	@ int
 235              	.LVL20:
  88:mylib/music_and_voice.c ****         break;
 236              		.loc 1 88 16 view .LVU60
 237 0078 B8EEC00A 		vcvt.f32.s32	s0, s0
 238              	.LVL21:
  89:mylib/music_and_voice.c ****     case 0:
 239              		.loc 1 89 9 is_stmt 1 view .LVU61
 240 007c E2E7     		b	.L16
 241              	.L15:
  94:mylib/music_and_voice.c ****         break;
 242              		.loc 1 94 9 view .LVU62
  94:mylib/music_and_voice.c ****         break;
 243              		.loc 1 94 23 is_stmt 0 view .LVU63
 244 007e 5308     		lsrs	r3, r2, #1
 245 0080 00EE103A 		vmov	s0, r3	@ int
 246              	.LVL22:
  94:mylib/music_and_voice.c ****         break;
 247              		.loc 1 94 16 view .LVU64
 248 0084 B8EEC00A 		vcvt.f32.s32	s0, s0
 249              	.LVL23:
  95:mylib/music_and_voice.c ****     }
 250              		.loc 1 95 9 is_stmt 1 view .LVU65
 251 0088 DCE7     		b	.L16
 252              	.L17:
 101:mylib/music_and_voice.c ****         break;
 253              		.loc 1 101 9 view .LVU66
 101:mylib/music_and_voice.c ****         break;
 254              		.loc 1 101 16 is_stmt 0 view .LVU67
 255 008a DFED067A 		vldr.32	s15, .L21+4
 256 008e 20EE270A 		vmul.f32	s0, s0, s15
 257              	.LVL24:
 102:mylib/music_and_voice.c ****     case 0:
 258              		.loc 1 102 9 is_stmt 1 view .LVU68
 259 0092 DBE7     		b	.L6
 260              	.L18:
 106:mylib/music_and_voice.c ****         break;
 261              		.loc 1 106 9 view .LVU69
 106:mylib/music_and_voice.c ****         break;
 262              		.loc 1 106 16 is_stmt 0 view .LVU70
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 8


 263 0094 DFED037A 		vldr.32	s15, .L21+4
 264 0098 80EE270A 		vdiv.f32	s0, s0, s15
 265              	.LVL25:
 107:mylib/music_and_voice.c ****     }
 266              		.loc 1 107 9 is_stmt 1 view .LVU71
 110:mylib/music_and_voice.c **** }
 267              		.loc 1 110 5 view .LVU72
 110:mylib/music_and_voice.c **** }
 268              		.loc 1 110 12 is_stmt 0 view .LVU73
 269 009c D6E7     		b	.L6
 270              	.L22:
 271 009e 00BF     		.align	2
 272              	.L21:
 273 00a0 00000000 		.word	.LANCHOR0
 274 00a4 508D873F 		.word	1065848144
 275              		.cfi_endproc
 276              	.LFE131:
 278              		.section	.text.Music_Play_Note,"ax",%progbits
 279              		.align	1
 280              		.global	Music_Play_Note
 281              		.syntax unified
 282              		.thumb
 283              		.thumb_func
 284              		.fpu fpv4-sp-d16
 286              	Music_Play_Note:
 287              	.LVL26:
 288              	.LFB132:
 112:mylib/music_and_voice.c **** 
 113:mylib/music_and_voice.c **** void Music_Play_Note(uint16_t freq)
 114:mylib/music_and_voice.c **** {
 289              		.loc 1 114 1 is_stmt 1 view -0
 290              		.cfi_startproc
 291              		@ args = 0, pretend = 0, frame = 0
 292              		@ frame_needed = 0, uses_anonymous_args = 0
 293              		@ link register save eliminated.
 294              		.loc 1 114 1 is_stmt 0 view .LVU75
 295 0000 10B4     		push	{r4}
 296              	.LCFI3:
 297              		.cfi_def_cfa_offset 4
 298              		.cfi_offset 4, -4
 115:mylib/music_and_voice.c ****     freq*=2;
 299              		.loc 1 115 5 is_stmt 1 view .LVU76
 300              		.loc 1 115 9 is_stmt 0 view .LVU77
 301 0002 4300     		lsls	r3, r0, #1
 302 0004 98B2     		uxth	r0, r3
 303              	.LVL27:
 116:mylib/music_and_voice.c ****     Music_Info.USE_TIM->Instance->PSC = 19;
 304              		.loc 1 116 5 is_stmt 1 view .LVU78
 305              		.loc 1 116 15 is_stmt 0 view .LVU79
 306 0006 094B     		ldr	r3, .L25
 307 0008 5A69     		ldr	r2, [r3, #20]
 308              		.loc 1 116 23 view .LVU80
 309 000a 1168     		ldr	r1, [r2]
 310              		.loc 1 116 39 view .LVU81
 311 000c 1324     		movs	r4, #19
 312 000e 8C62     		str	r4, [r1, #40]
 117:mylib/music_and_voice.c ****     Music_Info.USE_TIM->Instance->ARR = Music_Info.TIM_MAX_FREQ/20/ freq - 1;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 9


 313              		.loc 1 117 5 is_stmt 1 view .LVU82
 314              		.loc 1 117 51 is_stmt 0 view .LVU83
 315 0010 9B69     		ldr	r3, [r3, #24]
 316              		.loc 1 117 64 view .LVU84
 317 0012 0749     		ldr	r1, .L25+4
 318 0014 A1FB0313 		umull	r1, r3, r1, r3
 319 0018 1B09     		lsrs	r3, r3, #4
 320              		.loc 1 117 67 view .LVU85
 321 001a B3FBF0F3 		udiv	r3, r3, r0
 322              		.loc 1 117 23 view .LVU86
 323 001e 1268     		ldr	r2, [r2]
 324              		.loc 1 117 74 view .LVU87
 325 0020 013B     		subs	r3, r3, #1
 326              		.loc 1 117 39 view .LVU88
 327 0022 D362     		str	r3, [r2, #44]
 118:mylib/music_and_voice.c **** }
 328              		.loc 1 118 1 view .LVU89
 329 0024 5DF8044B 		ldr	r4, [sp], #4
 330              	.LCFI4:
 331              		.cfi_restore 4
 332              		.cfi_def_cfa_offset 0
 333 0028 7047     		bx	lr
 334              	.L26:
 335 002a 00BF     		.align	2
 336              	.L25:
 337 002c 00000000 		.word	Music_Info
 338 0030 CDCCCCCC 		.word	-858993459
 339              		.cfi_endproc
 340              	.LFE132:
 342              		.section	.text.Muisc_Play_TIM_IRQ_Handler,"ax",%progbits
 343              		.align	1
 344              		.global	Muisc_Play_TIM_IRQ_Handler
 345              		.syntax unified
 346              		.thumb
 347              		.thumb_func
 348              		.fpu fpv4-sp-d16
 350              	Muisc_Play_TIM_IRQ_Handler:
 351              	.LFB133:
 119:mylib/music_and_voice.c **** 
 120:mylib/music_and_voice.c **** 
 121:mylib/music_and_voice.c **** void Muisc_Play_TIM_IRQ_Handler()
 122:mylib/music_and_voice.c **** {
 352              		.loc 1 122 1 is_stmt 1 view -0
 353              		.cfi_startproc
 354              		@ args = 0, pretend = 0, frame = 0
 355              		@ frame_needed = 0, uses_anonymous_args = 0
 356 0000 08B5     		push	{r3, lr}
 357              	.LCFI5:
 358              		.cfi_def_cfa_offset 8
 359              		.cfi_offset 3, -8
 360              		.cfi_offset 14, -4
 123:mylib/music_and_voice.c ****     static uint8_t first_time = 0;
 361              		.loc 1 123 5 view .LVU91
 124:mylib/music_and_voice.c ****     if (Music_Info.stop == 1)
 362              		.loc 1 124 5 view .LVU92
 363              		.loc 1 124 19 is_stmt 0 view .LVU93
 364 0002 124B     		ldr	r3, .L34
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 10


 365 0004 1B7C     		ldrb	r3, [r3, #16]	@ zero_extendqisi2
 366              		.loc 1 124 8 view .LVU94
 367 0006 012B     		cmp	r3, #1
 368 0008 10D0     		beq	.L33
 125:mylib/music_and_voice.c ****     {
 126:mylib/music_and_voice.c ****         Set_Vector(U0, 0);
 127:mylib/music_and_voice.c ****         return;
 128:mylib/music_and_voice.c ****     }
 129:mylib/music_and_voice.c **** 
 130:mylib/music_and_voice.c ****     if (!first_time)
 369              		.loc 1 130 5 is_stmt 1 view .LVU95
 370              		.loc 1 130 9 is_stmt 0 view .LVU96
 371 000a 114B     		ldr	r3, .L34+4
 372 000c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 373              		.loc 1 130 8 view .LVU97
 374 000e A3B9     		cbnz	r3, .L30
 131:mylib/music_and_voice.c ****     {
 132:mylib/music_and_voice.c ****         Set_Vector(U4, Music_Info.DUTY);
 375              		.loc 1 132 9 is_stmt 1 view .LVU98
 376 0010 104B     		ldr	r3, .L34+8
 377 0012 0E4A     		ldr	r2, .L34
 378 0014 92ED080A 		vldr.32	s0, [r2, #32]
 379 0018 0FCB     		ldm	r3, {r0, r1, r2, r3}
 380 001a FFF7FEFF 		bl	Set_Vector
 381              	.LVL28:
 382              	.L31:
 133:mylib/music_and_voice.c ****     }
 134:mylib/music_and_voice.c ****     else
 135:mylib/music_and_voice.c ****     {
 136:mylib/music_and_voice.c ****         Set_Vector(U6, Music_Info.DUTY);
 137:mylib/music_and_voice.c ****     }
 138:mylib/music_and_voice.c ****     first_time = !first_time;
 383              		.loc 1 138 5 view .LVU99
 384              		.loc 1 138 18 is_stmt 0 view .LVU100
 385 001e 0C4A     		ldr	r2, .L34+4
 386 0020 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 387 0022 B3FA83F3 		clz	r3, r3
 388 0026 5B09     		lsrs	r3, r3, #5
 389              		.loc 1 138 16 view .LVU101
 390 0028 1370     		strb	r3, [r2]
 391              	.L27:
 139:mylib/music_and_voice.c **** }
 392              		.loc 1 139 1 view .LVU102
 393 002a 08BD     		pop	{r3, pc}
 394              	.L33:
 126:mylib/music_and_voice.c ****         return;
 395              		.loc 1 126 9 is_stmt 1 view .LVU103
 396 002c 0A4B     		ldr	r3, .L34+12
 397 002e 9FED0B0A 		vldr.32	s0, .L34+16
 398 0032 0FCB     		ldm	r3, {r0, r1, r2, r3}
 399 0034 FFF7FEFF 		bl	Set_Vector
 400              	.LVL29:
 127:mylib/music_and_voice.c ****     }
 401              		.loc 1 127 9 view .LVU104
 402 0038 F7E7     		b	.L27
 403              	.L30:
 136:mylib/music_and_voice.c ****     }
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 11


 404              		.loc 1 136 9 view .LVU105
 405 003a 094B     		ldr	r3, .L34+20
 406 003c 034A     		ldr	r2, .L34
 407 003e 92ED080A 		vldr.32	s0, [r2, #32]
 408 0042 0FCB     		ldm	r3, {r0, r1, r2, r3}
 409 0044 FFF7FEFF 		bl	Set_Vector
 410              	.LVL30:
 411 0048 E9E7     		b	.L31
 412              	.L35:
 413 004a 00BF     		.align	2
 414              	.L34:
 415 004c 00000000 		.word	Music_Info
 416 0050 00000000 		.word	.LANCHOR1
 417 0054 00000000 		.word	U4
 418 0058 00000000 		.word	U0
 419 005c 00000000 		.word	0
 420 0060 00000000 		.word	U6
 421              		.cfi_endproc
 422              	.LFE133:
 424              		.global	__aeabi_ui2d
 425              		.global	__aeabi_i2d
 426              		.global	__aeabi_dmul
 427              		.global	__aeabi_dcmpge
 428              		.section	.text.Music_Play_Beat,"ax",%progbits
 429              		.align	1
 430              		.global	Music_Play_Beat
 431              		.syntax unified
 432              		.thumb
 433              		.thumb_func
 434              		.fpu fpv4-sp-d16
 436              	Music_Play_Beat:
 437              	.LFB134:
 140:mylib/music_and_voice.c **** 
 141:mylib/music_and_voice.c **** 
 142:mylib/music_and_voice.c **** void Music_Play_Beat()
 143:mylib/music_and_voice.c **** { // 节拍处理，暂定一分钟80拍，即750ms一拍
 438              		.loc 1 143 1 view -0
 439              		.cfi_startproc
 440              		@ args = 0, pretend = 0, frame = 0
 441              		@ frame_needed = 0, uses_anonymous_args = 0
 442 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 443              	.LCFI6:
 444              		.cfi_def_cfa_offset 24
 445              		.cfi_offset 3, -24
 446              		.cfi_offset 4, -20
 447              		.cfi_offset 5, -16
 448              		.cfi_offset 6, -12
 449              		.cfi_offset 7, -8
 450              		.cfi_offset 14, -4
 144:mylib/music_and_voice.c ****     static uint16_t next_time = 750;
 451              		.loc 1 144 5 view .LVU107
 145:mylib/music_and_voice.c ****     uint16_t note;
 452              		.loc 1 145 5 view .LVU108
 146:mylib/music_and_voice.c ****     /*
 147:mylib/music_and_voice.c ****     if (Board_Mode != SING_MODE)
 148:mylib/music_and_voice.c ****     {
 149:mylib/music_and_voice.c ****         return;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 12


 150:mylib/music_and_voice.c ****     }
 151:mylib/music_and_voice.c ****     */
 152:mylib/music_and_voice.c ****     Music_Info.ms_cnt++;
 453              		.loc 1 152 5 view .LVU109
 454              		.loc 1 152 15 is_stmt 0 view .LVU110
 455 0002 2B4B     		ldr	r3, .L45+8
 456 0004 1C68     		ldr	r4, [r3]
 457              		.loc 1 152 22 view .LVU111
 458 0006 0134     		adds	r4, r4, #1
 459 0008 1C60     		str	r4, [r3]
 153:mylib/music_and_voice.c **** 
 154:mylib/music_and_voice.c ****     if (Music_Info.ms_cnt >= next_time * 0.85 && Music_Info.ms_cnt < next_time)
 460              		.loc 1 154 5 is_stmt 1 view .LVU112
 461              		.loc 1 154 27 is_stmt 0 view .LVU113
 462 000a 2046     		mov	r0, r4
 463 000c FFF7FEFF 		bl	__aeabi_ui2d
 464              	.LVL31:
 465 0010 0646     		mov	r6, r0
 466 0012 0F46     		mov	r7, r1
 467              		.loc 1 154 40 view .LVU114
 468 0014 274B     		ldr	r3, .L45+12
 469 0016 1D88     		ldrh	r5, [r3]
 470 0018 2846     		mov	r0, r5
 471 001a FFF7FEFF 		bl	__aeabi_i2d
 472              	.LVL32:
 473 001e 22A3     		adr	r3, .L45
 474 0020 D3E90023 		ldrd	r2, [r3]
 475 0024 FFF7FEFF 		bl	__aeabi_dmul
 476              	.LVL33:
 477 0028 0246     		mov	r2, r0
 478 002a 0B46     		mov	r3, r1
 479              		.loc 1 154 8 view .LVU115
 480 002c 3046     		mov	r0, r6
 481 002e 3946     		mov	r1, r7
 482 0030 FFF7FEFF 		bl	__aeabi_dcmpge
 483              	.LVL34:
 484 0034 20B1     		cbz	r0, .L37
 485              		.loc 1 154 47 discriminator 1 view .LVU116
 486 0036 AC42     		cmp	r4, r5
 487 0038 02D2     		bcs	.L37
 155:mylib/music_and_voice.c ****     {
 156:mylib/music_and_voice.c ****         Music_Info.stop = 1;
 488              		.loc 1 156 9 is_stmt 1 view .LVU117
 489              		.loc 1 156 25 is_stmt 0 view .LVU118
 490 003a 1D4B     		ldr	r3, .L45+8
 491 003c 0122     		movs	r2, #1
 492 003e 1A74     		strb	r2, [r3, #16]
 493              	.L37:
 157:mylib/music_and_voice.c ****     }
 158:mylib/music_and_voice.c **** 
 159:mylib/music_and_voice.c ****     if (Music_Info.ms_cnt >= next_time)
 494              		.loc 1 159 5 is_stmt 1 view .LVU119
 495              		.loc 1 159 8 is_stmt 0 view .LVU120
 496 0040 AC42     		cmp	r4, r5
 497 0042 00D2     		bcs	.L43
 498              	.L36:
 160:mylib/music_and_voice.c ****     {                          // 750*1/4
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 13


 161:mylib/music_and_voice.c ****         Music_Info.ms_cnt = 0; // 以下代码1s执行一次
 162:mylib/music_and_voice.c ****         Music_Info.stop = 0;
 163:mylib/music_and_voice.c ****         Music_Info.time = 1.0f;
 164:mylib/music_and_voice.c **** 
 165:mylib/music_and_voice.c ****         uint16_t temp = Music_Song[Music_Info.cnt];
 166:mylib/music_and_voice.c ****         note = (uint16_t)Music_Get_Note(temp, &Music_Info.time);
 167:mylib/music_and_voice.c **** 
 168:mylib/music_and_voice.c ****         Music_Play_Note(note);
 169:mylib/music_and_voice.c ****         next_time = Music_Info.BEAT_cnt * Music_Info.time;
 170:mylib/music_and_voice.c ****         if (Music_Info.cnt == sizeof(Music_Song) / sizeof(uint16_t) - 1)
 171:mylib/music_and_voice.c ****         {
 172:mylib/music_and_voice.c ****             Music_Info.cnt=0;
 173:mylib/music_and_voice.c ****         }
 174:mylib/music_and_voice.c ****         else
 175:mylib/music_and_voice.c ****         {
 176:mylib/music_and_voice.c ****             Music_Info.cnt++;
 177:mylib/music_and_voice.c ****         }
 178:mylib/music_and_voice.c ****     }
 179:mylib/music_and_voice.c **** }
 499              		.loc 1 179 1 view .LVU121
 500 0044 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 501              	.L43:
 502              	.LBB2:
 161:mylib/music_and_voice.c ****         Music_Info.stop = 0;
 503              		.loc 1 161 9 is_stmt 1 view .LVU122
 161:mylib/music_and_voice.c ****         Music_Info.stop = 0;
 504              		.loc 1 161 27 is_stmt 0 view .LVU123
 505 0046 1A4C     		ldr	r4, .L45+8
 506 0048 0023     		movs	r3, #0
 507 004a 2360     		str	r3, [r4]
 162:mylib/music_and_voice.c ****         Music_Info.time = 1.0f;
 508              		.loc 1 162 9 is_stmt 1 view .LVU124
 162:mylib/music_and_voice.c ****         Music_Info.time = 1.0f;
 509              		.loc 1 162 25 is_stmt 0 view .LVU125
 510 004c 2374     		strb	r3, [r4, #16]
 163:mylib/music_and_voice.c **** 
 511              		.loc 1 163 9 is_stmt 1 view .LVU126
 163:mylib/music_and_voice.c **** 
 512              		.loc 1 163 25 is_stmt 0 view .LVU127
 513 004e 4FF07E53 		mov	r3, #1065353216
 514 0052 E360     		str	r3, [r4, #12]	@ float
 165:mylib/music_and_voice.c ****         note = (uint16_t)Music_Get_Note(temp, &Music_Info.time);
 515              		.loc 1 165 9 is_stmt 1 view .LVU128
 165:mylib/music_and_voice.c ****         note = (uint16_t)Music_Get_Note(temp, &Music_Info.time);
 516              		.loc 1 165 46 is_stmt 0 view .LVU129
 517 0054 6268     		ldr	r2, [r4, #4]
 518              	.LVL35:
 166:mylib/music_and_voice.c **** 
 519              		.loc 1 166 9 is_stmt 1 view .LVU130
 166:mylib/music_and_voice.c **** 
 520              		.loc 1 166 26 is_stmt 0 view .LVU131
 521 0056 04F10C01 		add	r1, r4, #12
 522 005a 174B     		ldr	r3, .L45+16
 523 005c 33F81200 		ldrh	r0, [r3, r2, lsl #1]
 524              	.LVL36:
 166:mylib/music_and_voice.c **** 
 525              		.loc 1 166 26 view .LVU132
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 14


 526 0060 FFF7FEFF 		bl	Music_Get_Note
 527              	.LVL37:
 166:mylib/music_and_voice.c **** 
 528              		.loc 1 166 14 view .LVU133
 529 0064 BCEEC00A 		vcvt.u32.f32	s0, s0
 530              	.LVL38:
 168:mylib/music_and_voice.c ****         next_time = Music_Info.BEAT_cnt * Music_Info.time;
 531              		.loc 1 168 9 is_stmt 1 view .LVU134
 532 0068 10EE103A 		vmov	r3, s0	@ int
 533 006c 98B2     		uxth	r0, r3
 534 006e FFF7FEFF 		bl	Music_Play_Note
 535              	.LVL39:
 169:mylib/music_and_voice.c ****         if (Music_Info.cnt == sizeof(Music_Song) / sizeof(uint16_t) - 1)
 536              		.loc 1 169 9 view .LVU135
 169:mylib/music_and_voice.c ****         if (Music_Info.cnt == sizeof(Music_Song) / sizeof(uint16_t) - 1)
 537              		.loc 1 169 31 is_stmt 0 view .LVU136
 538 0072 A38B     		ldrh	r3, [r4, #28]
 539 0074 07EE903A 		vmov	s15, r3	@ int
 169:mylib/music_and_voice.c ****         if (Music_Info.cnt == sizeof(Music_Song) / sizeof(uint16_t) - 1)
 540              		.loc 1 169 53 view .LVU137
 541 0078 94ED037A 		vldr.32	s14, [r4, #12]
 169:mylib/music_and_voice.c ****         if (Music_Info.cnt == sizeof(Music_Song) / sizeof(uint16_t) - 1)
 542              		.loc 1 169 41 view .LVU138
 543 007c F8EEE77A 		vcvt.f32.s32	s15, s15
 544 0080 67EE877A 		vmul.f32	s15, s15, s14
 169:mylib/music_and_voice.c ****         if (Music_Info.cnt == sizeof(Music_Song) / sizeof(uint16_t) - 1)
 545              		.loc 1 169 19 view .LVU139
 546 0084 FCEEE77A 		vcvt.u32.f32	s15, s15
 547 0088 0A4B     		ldr	r3, .L45+12
 548 008a 17EE902A 		vmov	r2, s15	@ int
 549 008e 1A80     		strh	r2, [r3]	@ movhi
 170:mylib/music_and_voice.c ****         {
 550              		.loc 1 170 9 is_stmt 1 view .LVU140
 170:mylib/music_and_voice.c ****         {
 551              		.loc 1 170 23 is_stmt 0 view .LVU141
 552 0090 6368     		ldr	r3, [r4, #4]
 170:mylib/music_and_voice.c ****         {
 553              		.loc 1 170 12 view .LVU142
 554 0092 5E2B     		cmp	r3, #94
 555 0094 03D0     		beq	.L44
 176:mylib/music_and_voice.c ****         }
 556              		.loc 1 176 13 is_stmt 1 view .LVU143
 176:mylib/music_and_voice.c ****         }
 557              		.loc 1 176 27 is_stmt 0 view .LVU144
 558 0096 0133     		adds	r3, r3, #1
 559 0098 054A     		ldr	r2, .L45+8
 560 009a 5360     		str	r3, [r2, #4]
 561              	.LBE2:
 562              		.loc 1 179 1 view .LVU145
 563 009c D2E7     		b	.L36
 564              	.L44:
 565              	.LBB3:
 172:mylib/music_and_voice.c ****         }
 566              		.loc 1 172 13 is_stmt 1 view .LVU146
 172:mylib/music_and_voice.c ****         }
 567              		.loc 1 172 27 is_stmt 0 view .LVU147
 568 009e 0022     		movs	r2, #0
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 15


 569 00a0 6260     		str	r2, [r4, #4]
 570 00a2 CFE7     		b	.L36
 571              	.L46:
 572 00a4 AFF30080 		.align	3
 573              	.L45:
 574 00a8 33333333 		.word	858993459
 575 00ac 3333EB3F 		.word	1072378675
 576 00b0 00000000 		.word	Music_Info
 577 00b4 00000000 		.word	.LANCHOR2
 578 00b8 00000000 		.word	.LANCHOR3
 579              	.LBE3:
 580              		.cfi_endproc
 581              	.LFE134:
 583              		.section	.text.Voice_Init,"ax",%progbits
 584              		.align	1
 585              		.global	Voice_Init
 586              		.syntax unified
 587              		.thumb
 588              		.thumb_func
 589              		.fpu fpv4-sp-d16
 591              	Voice_Init:
 592              	.LVL40:
 593              	.LFB135:
 180:mylib/music_and_voice.c **** 
 181:mylib/music_and_voice.c **** struct
 182:mylib/music_and_voice.c **** {
 183:mylib/music_and_voice.c ****     uint32_t cnt;
 184:mylib/music_and_voice.c ****     TIM_HandleTypeDef * USE_TIM;
 185:mylib/music_and_voice.c ****     uint32_t TIM_MAX_FREQ;
 186:mylib/music_and_voice.c ****     uint16_t Fs;
 187:mylib/music_and_voice.c ****     float voice_duty;
 188:mylib/music_and_voice.c **** } Voice_Info;
 189:mylib/music_and_voice.c **** 
 190:mylib/music_and_voice.c **** void Voice_Init(TIM_HandleTypeDef * tim,uint16_t fs){
 594              		.loc 1 190 53 is_stmt 1 view -0
 595              		.cfi_startproc
 596              		@ args = 0, pretend = 0, frame = 0
 597              		@ frame_needed = 0, uses_anonymous_args = 0
 598              		@ link register save eliminated.
 599              		.loc 1 190 53 is_stmt 0 view .LVU149
 600 0000 10B4     		push	{r4}
 601              	.LCFI7:
 602              		.cfi_def_cfa_offset 4
 603              		.cfi_offset 4, -4
 191:mylib/music_and_voice.c **** 
 192:mylib/music_and_voice.c ****     Voice_Info.USE_TIM=tim;
 604              		.loc 1 192 5 is_stmt 1 view .LVU150
 605              		.loc 1 192 23 is_stmt 0 view .LVU151
 606 0002 104B     		ldr	r3, .L51
 607 0004 5860     		str	r0, [r3, #4]
 193:mylib/music_and_voice.c ****     if(tim->Instance!=TIM1 && tim->Instance!=TIM8){
 608              		.loc 1 193 5 is_stmt 1 view .LVU152
 609              		.loc 1 193 11 is_stmt 0 view .LVU153
 610 0006 0368     		ldr	r3, [r0]
 611              		.loc 1 193 7 view .LVU154
 612 0008 0F4A     		ldr	r2, .L51+4
 613 000a 9342     		cmp	r3, r2
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 16


 614 000c 0AD0     		beq	.L48
 615              		.loc 1 193 28 discriminator 1 view .LVU155
 616 000e 02F58062 		add	r2, r2, #1024
 617 0012 9342     		cmp	r3, r2
 618 0014 06D0     		beq	.L48
 194:mylib/music_and_voice.c ****         Voice_Info.TIM_MAX_FREQ=84000000;
 619              		.loc 1 194 9 is_stmt 1 view .LVU156
 620              		.loc 1 194 32 is_stmt 0 view .LVU157
 621 0016 0B4B     		ldr	r3, .L51
 622 0018 02F14542 		add	r2, r2, #-989855744
 623 001c 02F53942 		add	r2, r2, #47360
 624 0020 9A60     		str	r2, [r3, #8]
 625 0022 02E0     		b	.L49
 626              	.L48:
 195:mylib/music_and_voice.c ****     }else{
 196:mylib/music_and_voice.c ****         Voice_Info.TIM_MAX_FREQ=168000000;
 627              		.loc 1 196 9 is_stmt 1 view .LVU158
 628              		.loc 1 196 32 is_stmt 0 view .LVU159
 629 0024 074B     		ldr	r3, .L51
 630 0026 094A     		ldr	r2, .L51+8
 631 0028 9A60     		str	r2, [r3, #8]
 632              	.L49:
 197:mylib/music_and_voice.c ****     }
 198:mylib/music_and_voice.c ****     Voice_Info.Fs=fs;
 633              		.loc 1 198 5 is_stmt 1 view .LVU160
 634              		.loc 1 198 18 is_stmt 0 view .LVU161
 635 002a 064B     		ldr	r3, .L51
 636 002c 9981     		strh	r1, [r3, #12]	@ movhi
 199:mylib/music_and_voice.c **** 
 200:mylib/music_and_voice.c ****     tim->Instance->PSC=0;
 637              		.loc 1 200 5 is_stmt 1 view .LVU162
 638              		.loc 1 200 8 is_stmt 0 view .LVU163
 639 002e 0268     		ldr	r2, [r0]
 640              		.loc 1 200 23 view .LVU164
 641 0030 0024     		movs	r4, #0
 642 0032 9462     		str	r4, [r2, #40]
 201:mylib/music_and_voice.c ****     tim->Instance->ARR=Voice_Info.TIM_MAX_FREQ/fs;
 643              		.loc 1 201 5 is_stmt 1 view .LVU165
 644              		.loc 1 201 34 is_stmt 0 view .LVU166
 645 0034 9B68     		ldr	r3, [r3, #8]
 646              		.loc 1 201 8 view .LVU167
 647 0036 0268     		ldr	r2, [r0]
 648              		.loc 1 201 47 view .LVU168
 649 0038 B3FBF1F1 		udiv	r1, r3, r1
 650              	.LVL41:
 651              		.loc 1 201 23 view .LVU169
 652 003c D162     		str	r1, [r2, #44]
 202:mylib/music_and_voice.c **** }
 653              		.loc 1 202 1 view .LVU170
 654 003e 5DF8044B 		ldr	r4, [sp], #4
 655              	.LCFI8:
 656              		.cfi_restore 4
 657              		.cfi_def_cfa_offset 0
 658 0042 7047     		bx	lr
 659              	.L52:
 660              		.align	2
 661              	.L51:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 17


 662 0044 00000000 		.word	Voice_Info
 663 0048 00000140 		.word	1073807360
 664 004c 007A030A 		.word	168000000
 665              		.cfi_endproc
 666              	.LFE135:
 668              		.section	.text.Voice_Fshz_Handler,"ax",%progbits
 669              		.align	1
 670              		.global	Voice_Fshz_Handler
 671              		.syntax unified
 672              		.thumb
 673              		.thumb_func
 674              		.fpu fpv4-sp-d16
 676              	Voice_Fshz_Handler:
 677              	.LFB136:
 203:mylib/music_and_voice.c **** 
 204:mylib/music_and_voice.c **** #include "voice.h"
 205:mylib/music_and_voice.c **** 
 206:mylib/music_and_voice.c **** void Voice_Fshz_Handler()
 207:mylib/music_and_voice.c **** {
 678              		.loc 1 207 1 is_stmt 1 view -0
 679              		.cfi_startproc
 680              		@ args = 0, pretend = 0, frame = 0
 681              		@ frame_needed = 0, uses_anonymous_args = 0
 682 0000 08B5     		push	{r3, lr}
 683              	.LCFI9:
 684              		.cfi_def_cfa_offset 8
 685              		.cfi_offset 3, -8
 686              		.cfi_offset 14, -4
 208:mylib/music_and_voice.c ****     Voice_Info.cnt++;
 687              		.loc 1 208 5 view .LVU172
 688              		.loc 1 208 15 is_stmt 0 view .LVU173
 689 0002 184A     		ldr	r2, .L61
 690 0004 1368     		ldr	r3, [r2]
 691              		.loc 1 208 19 view .LVU174
 692 0006 0133     		adds	r3, r3, #1
 693 0008 1360     		str	r3, [r2]
 209:mylib/music_and_voice.c ****     if (Voice_Info.cnt > 14398)
 694              		.loc 1 209 5 is_stmt 1 view .LVU175
 695              		.loc 1 209 8 is_stmt 0 view .LVU176
 696 000a 43F63E02 		movw	r2, #14398
 697 000e 9342     		cmp	r3, r2
 698 0010 02D9     		bls	.L54
 210:mylib/music_and_voice.c ****     {
 211:mylib/music_and_voice.c ****         Voice_Info.cnt = 0;
 699              		.loc 1 211 9 is_stmt 1 view .LVU177
 700              		.loc 1 211 24 is_stmt 0 view .LVU178
 701 0012 144B     		ldr	r3, .L61
 702 0014 0022     		movs	r2, #0
 703 0016 1A60     		str	r2, [r3]
 704              	.L54:
 212:mylib/music_and_voice.c ****     }
 213:mylib/music_and_voice.c ****     Voice_Info.voice_duty = (float)voice[Music_Info.cnt] / 255.0f;
 705              		.loc 1 213 5 is_stmt 1 view .LVU179
 706              		.loc 1 213 52 is_stmt 0 view .LVU180
 707 0018 134B     		ldr	r3, .L61+4
 708 001a 5B68     		ldr	r3, [r3, #4]
 709              		.loc 1 213 41 view .LVU181
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 18


 710 001c 134A     		ldr	r2, .L61+8
 711 001e D35C     		ldrb	r3, [r2, r3]	@ zero_extendqisi2
 712 0020 07EE103A 		vmov	s14, r3	@ int
 713              		.loc 1 213 29 view .LVU182
 714 0024 B8EE477A 		vcvt.f32.u32	s14, s14
 715              		.loc 1 213 58 view .LVU183
 716 0028 DFED116A 		vldr.32	s13, .L61+12
 717 002c C7EE267A 		vdiv.f32	s15, s14, s13
 718              		.loc 1 213 27 view .LVU184
 719 0030 0C4B     		ldr	r3, .L61
 720 0032 C3ED047A 		vstr.32	s15, [r3, #16]
 214:mylib/music_and_voice.c **** 
 215:mylib/music_and_voice.c ****     if(Voice_Info.voice_duty>0.5f){
 721              		.loc 1 215 5 is_stmt 1 view .LVU185
 722              		.loc 1 215 7 is_stmt 0 view .LVU186
 723 0036 B6EE007A 		vmov.f32	s14, #5.0e-1
 724 003a F4EEC77A 		vcmpe.f32	s15, s14
 725 003e F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 726 0042 06DD     		ble	.L59
 216:mylib/music_and_voice.c ****        Set_Vector(U4, Voice_Info.voice_duty-0.5f); 
 727              		.loc 1 216 8 is_stmt 1 view .LVU187
 728 0044 0B4B     		ldr	r3, .L61+16
 729 0046 37EEC70A 		vsub.f32	s0, s15, s14
 730 004a 0FCB     		ldm	r3, {r0, r1, r2, r3}
 731 004c FFF7FEFF 		bl	Set_Vector
 732              	.LVL42:
 733              	.L53:
 217:mylib/music_and_voice.c ****     }else{
 218:mylib/music_and_voice.c ****        Set_Vector(U6, Voice_Info.voice_duty-0.5f);  
 219:mylib/music_and_voice.c ****     }
 220:mylib/music_and_voice.c **** }...
 734              		.loc 1 220 1 is_stmt 0 view .LVU188
 735 0050 08BD     		pop	{r3, pc}
 736              	.L59:
 218:mylib/music_and_voice.c ****        Set_Vector(U6, Voice_Info.voice_duty-0.5f);  
 737              		.loc 1 218 8 is_stmt 1 view .LVU189
 738 0052 094B     		ldr	r3, .L61+20
 739 0054 B6EE000A 		vmov.f32	s0, #5.0e-1
 740 0058 37EEC00A 		vsub.f32	s0, s15, s0
 741 005c 0FCB     		ldm	r3, {r0, r1, r2, r3}
 742 005e FFF7FEFF 		bl	Set_Vector
 743              	.LVL43:
 744              		.loc 1 220 1 is_stmt 0 view .LVU190
 745 0062 F5E7     		b	.L53
 746              	.L62:
 747              		.align	2
 748              	.L61:
 749 0064 00000000 		.word	Voice_Info
 750 0068 00000000 		.word	Music_Info
 751 006c 00000000 		.word	voice
 752 0070 00007F43 		.word	1132396544
 753 0074 00000000 		.word	U4
 754 0078 00000000 		.word	U6
 755              		.cfi_endproc
 756              	.LFE136:
 758              		.comm	Voice_Info,20,4
 759              		.global	Music_Song
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 19


 760              		.global	Music_Freqs
 761              		.comm	Music_Info,36,4
 762              		.section	.bss.first_time.8560,"aw",%nobits
 763              		.set	.LANCHOR1,. + 0
 766              	first_time.8560:
 767 0000 00       		.space	1
 768              		.section	.data.Music_Freqs,"aw"
 769              		.align	2
 770              		.set	.LANCHOR0,. + 0
 773              	Music_Freqs:
 774 0000 204E     		.short	20000
 775 0002 0501     		.short	261
 776 0004 2501     		.short	293
 777 0006 4901     		.short	329
 778 0008 5D01     		.short	349
 779 000a 8801     		.short	392
 780 000c B801     		.short	440
 781 000e ED01     		.short	493
 782              		.section	.data.Music_Song,"aw"
 783              		.align	2
 784              		.set	.LANCHOR3,. + 0
 787              	Music_Song:
 788 0000 0308     		.short	2051
 789 0002 0308     		.short	2051
 790 0004 0308     		.short	2051
 791 0006 0208     		.short	2050
 792 0008 0302     		.short	515
 793 000a 0208     		.short	2050
 794 000c 0308     		.short	2051
 795 000e 0208     		.short	2050
 796 0010 0208     		.short	2050
 797 0012 0634     		.short	13318
 798 0014 0638     		.short	14342
 799 0016 0738     		.short	14343
 800 0018 0104     		.short	1025
 801 001a 0208     		.short	2050
 802 001c 0108     		.short	2049
 803 001e 0734     		.short	13319
 804 0020 0538     		.short	14341
 805 0022 0631     		.short	12550
 806 0024 0308     		.short	2051
 807 0026 0308     		.short	2051
 808 0028 0308     		.short	2051
 809 002a 0208     		.short	2050
 810 002c 0304     		.short	1027
 811 002e 0608     		.short	2054
 812 0030 0508     		.short	2053
 813 0032 0608     		.short	2054
 814 0034 0508     		.short	2053
 815 0036 0508     		.short	2053
 816 0038 0204     		.short	1026
 817 003a 0208     		.short	2050
 818 003c 0308     		.short	2051
 819 003e 0408     		.short	2052
 820 0040 0508     		.short	2053
 821 0042 0408     		.short	2052
 822 0044 0304     		.short	1027
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 20


 823 0046 0208     		.short	2050
 824 0048 0301     		.short	259
 825 004a 0604     		.short	1030
 826 004c 0738     		.short	14343
 827 004e 0638     		.short	14342
 828 0050 0504     		.short	1029
 829 0052 0308     		.short	2051
 830 0054 0501     		.short	261
 831 0056 0308     		.short	2051
 832 0058 0508     		.short	2053
 833 005a 0204     		.short	1026
 834 005c 0608     		.short	2054
 835 005e 0508     		.short	2053
 836 0060 0304     		.short	1027
 837 0062 0208     		.short	2050
 838 0064 0301     		.short	259
 839 0066 0204     		.short	1026
 840 0068 0508     		.short	2053
 841 006a 0604     		.short	1030
 842 006c 0104     		.short	1025
 843 006e 0608     		.short	2054
 844 0070 0608     		.short	2054
 845 0072 0604     		.short	1030
 846 0074 0608     		.short	2054
 847 0076 0708     		.short	2055
 848 0078 0114     		.short	5121
 849 007a 0708     		.short	2055
 850 007c 0608     		.short	2054
 851 007e 0704     		.short	1031
 852 0080 0508     		.short	2053
 853 0082 0301     		.short	259
 854 0084 0604     		.short	1030
 855 0086 0708     		.short	2055
 856 0088 0608     		.short	2054
 857 008a 0504     		.short	1029
 858 008c 0308     		.short	2051
 859 008e 0501     		.short	261
 860 0090 0408     		.short	2052
 861 0092 0508     		.short	2053
 862 0094 0604     		.short	1030
 863 0096 0708     		.short	2055
 864 0098 0608     		.short	2054
 865 009a 0704     		.short	1031
 866 009c 0504     		.short	1029
 867 009e 060F     		.short	3846
 868 00a0 0301     		.short	259
 869 00a2 0204     		.short	1026
 870 00a4 0508     		.short	2053
 871 00a6 0604     		.short	1030
 872 00a8 0104     		.short	1025
 873 00aa 0608     		.short	2054
 874 00ac 0604     		.short	1030
 875 00ae 0608     		.short	2054
 876 00b0 0708     		.short	2055
 877 00b2 0114     		.short	5121
 878 00b4 0708     		.short	2055
 879 00b6 0608     		.short	2054
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 21


 880 00b8 0704     		.short	1031
 881 00ba 0508     		.short	2053
 882 00bc 0601     		.short	262
 883              		.section	.data.next_time.8563,"aw"
 884              		.align	1
 885              		.set	.LANCHOR2,. + 0
 888              	next_time.8563:
 889 0000 EE02     		.short	750
 890              		.text
 891              	.Letext0:
 892              		.file 2 "c:\\arm_gcc\\arm-none-eabi\\include\\machine\\_default_types.h"
 893              		.file 3 "c:\\arm_gcc\\arm-none-eabi\\include\\sys\\_stdint.h"
 894              		.file 4 "Drivers/CMSIS/Include/core_cm4.h"
 895              		.file 5 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/system_stm32f4xx.h"
 896              		.file 6 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f405xx.h"
 897              		.file 7 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 898              		.file 8 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 899              		.file 9 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim.h"
 900              		.file 10 "Inc/tim.h"
 901              		.file 11 "Inc/foc.h"
 902              		.file 12 "Inc/voice.h"
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s 			page 22


DEFINED SYMBOLS
                            *ABS*:00000000 music_and_voice.c
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:18     .text.Music_Init:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:26     .text.Music_Init:00000000 Music_Init
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:80     .text.Music_Init:0000003c $d
                            *COM*:00000024 Music_Info
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:87     .text.Music_Get_Note:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:94     .text.Music_Get_Note:00000000 Music_Get_Note
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:141    .text.Music_Get_Note:00000026 $d
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:273    .text.Music_Get_Note:000000a0 $d
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:279    .text.Music_Play_Note:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:286    .text.Music_Play_Note:00000000 Music_Play_Note
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:337    .text.Music_Play_Note:0000002c $d
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:343    .text.Muisc_Play_TIM_IRQ_Handler:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:350    .text.Muisc_Play_TIM_IRQ_Handler:00000000 Muisc_Play_TIM_IRQ_Handler
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:415    .text.Muisc_Play_TIM_IRQ_Handler:0000004c $d
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:429    .text.Music_Play_Beat:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:436    .text.Music_Play_Beat:00000000 Music_Play_Beat
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:574    .text.Music_Play_Beat:000000a8 $d
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:584    .text.Voice_Init:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:591    .text.Voice_Init:00000000 Voice_Init
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:662    .text.Voice_Init:00000044 $d
                            *COM*:00000014 Voice_Info
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:669    .text.Voice_Fshz_Handler:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:676    .text.Voice_Fshz_Handler:00000000 Voice_Fshz_Handler
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:749    .text.Voice_Fshz_Handler:00000064 $d
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:787    .data.Music_Song:00000000 Music_Song
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:773    .data.Music_Freqs:00000000 Music_Freqs
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:766    .bss.first_time.8560:00000000 first_time.8560
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:767    .bss.first_time.8560:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:769    .data.Music_Freqs:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:783    .data.Music_Song:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:884    .data.next_time.8563:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:888    .data.next_time.8563:00000000 next_time.8563
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:156    .text.Music_Get_Note:00000035 $d
C:\Users\ncer\AppData\Local\Temp\ccBop8Be.s:156    .text.Music_Get_Note:00000036 $t

UNDEFINED SYMBOLS
Set_Vector
U4
U0
U6
__aeabi_ui2d
__aeabi_i2d
__aeabi_dmul
__aeabi_dcmpge
voice
